(function(){/*
 creative
 985203020bbafe65799be6543d0498ad44a5432b
 2023-03-27T08:00:48.813Z */
'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||'function'==typeof Object.defineProperties?Object.defineProperty:function(m,c,a){m!=Array.prototype&&m!=Object.prototype&&(m[c]=a.value)};$jscomp.getGlobal=function(m){return'undefined'!=typeof window&&window===m?m:'undefined'!=typeof global&&null!=global?global:m};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(m,c,a,h){if(c){a=$jscomp.global;m=m.split('.');for(h=0;h<m.length-1;h++){var k=m[h];k in a||(a[k]={});a=a[k]}m=m[m.length-1];h=a[m];c=c(h);c!=h&&null!=c&&$jscomp.defineProperty(a,m,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill('Array.prototype.includes',function(m){return m?m:function(c,a){var h=this;h instanceof String&&(h=String(h));var k=h.length;a=a||0;for(0>a&&(a=Math.max(a+k,0));a<k;a++){var r=h[a];if(r===c||Object.is(r,c))return!0}return!1}},'es7','es3');
$jscomp.owns=function(m,c){return Object.prototype.hasOwnProperty.call(m,c)};$jscomp.polyfill('Object.values',function(m){return m?m:function(c){var a=[],h;for(h in c)$jscomp.owns(c,h)&&a.push(c[h]);return a}},'es8','es3');$jscomp.polyfill('Object.entries',function(m){return m?m:function(c){var a=[],h;for(h in c)$jscomp.owns(c,h)&&a.push([h,c[h]]);return a}},'es8','es3');
(function(m){function c(h){if(a[h])return a[h].exports;var k=a[h]={i:h,l:!1,exports:{}};m[h].call(k.exports,k,k.exports,c);k.l=!0;return k.exports}var a={};c.m=m;c.c=a;c.d=function(a,k,r){c.o(a,k)||Object.defineProperty(a,k,{enumerable:!0,get:r})};c.r=function(a){'undefined'!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:'Module'});Object.defineProperty(a,'__esModule',{value:!0})};c.t=function(a,k){k&1&&(a=c(a));if(k&8||k&4&&'object'===typeof a&&a&&a.__esModule)return a;
var r=Object.create(null);c.r(r);Object.defineProperty(r,'default',{enumerable:!0,value:a});if(k&2&&'string'!=typeof a)for(var f in a)c.d(r,f,function(c){return a[c]}.bind(null,f));return r};c.n=function(a){var k=a&&a.__esModule?function(){return a['default']}:function(){return a};c.d(k,'a',k);return k};c.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};c.p='';return c(c.s=39)})([function(m,c,a){function h(a,b,g,c){g=a===b?a>g&&b<c?Infinity:-Infinity:a>c||g>b?0:Math.min(b,c)-Math.max(a,
g);return Infinity===g?1:-Infinity===g?0:g/(b-a)}a.d(c,'b',function(){return x});a.d(c,'a',function(){return S});a.d(c,'c',function(){return L});const k='performance'in window&&'now'in performance&&'timeOrigin'in performance;class r{constructor(a,b,g,c,f,n,q,l,r,h,y,d,u){q=void 0===q?[]:q;u=void 0===u?(d,g)=>{}:u;this.logger=0;this.visibilityHandlerGroupList=[];this.disabled=this.viewed=this.checkForEmptyTarget=!1;this.viewStart=this.viewedTime=this.visibilityTimeoutId=0;this.isVisible=!1;this.currentTime=
()=>k?performance.timeOrigin+performance.now():Date.now();this.title=a;this.context=b;this.visibilityTarget=g;this.checkForEmptyTarget=c;this.visibilityPercent=f;this.visibilityHandlerGroupList=q;this.visibilityTime=n;this.performOnlyOnce=l;this.callbackVisible=r;this.callbackInvisible=h;this.callbackTrackingStarts=void 0===y?()=>{}:y;this.callbackTrackingEnds=void 0===d?()=>{}:d;this.callbackVisibleUpdate=u}enable(){return!1}disable(){return!1}setVisible(a){a=void 0===a?this.currentTime():a;if(!this.isVisible){try{if(this.checkForEmptyTarget&&
0>=this.visibilityTarget.offsetHeight){this.logger.log(`setVisible() SKIP because of offsetHeight == ${this.visibilityTarget.offsetHeight}`);return}}catch(O){}this.isVisible=!0;this.callbackTrackingStarts.call(this);if(!1===this.viewed){this.viewStart=a;let b=this.viewedTime;0<this.visibilityHandlerGroupList.length?(this.logger.log('setVisible() Determine the viewedTime sum from the group'),b=0,this.visibilityHandlerGroupList.forEach(g=>{this.logger.log(`setVisible() Add viewedTime of '${g.visibilityHandler.viewedTime}' (current: ${b}) from the group member '${g.title}'`);
b+=g.visibilityHandler.viewedTime}),this.logger.log(`setVisible() Use viewedTime of '${b}' from the group`)):this.logger.log(`setVisible() Use viewedTime of '${b}' from myself`);const g=this.visibilityTime-b;0>g?this.logger.log('setVisible() SKIP starting timer because the limit was already reached'):(this.visibilityTimeoutId=this.context.Environment.hostWindow.setTimeout(()=>{this.logger.log(`setVisible() Invoked timer '${this.visibilityTimeoutId}' with timeout of '${g}'`);this.viewed=!0;this.viewedTime+=
this.currentTime()-this.viewStart;this.callbackVisible.call(this)},g),this.logger.log(`setVisible() Started timer '${this.visibilityTimeoutId}' with timeout of '${g}' ms`))}else!0!==this.viewed||this.performOnlyOnce||this.callbackVisible.call(this)}}visibleUpdate(a,b){b=void 0===b?this.currentTime():b;this.isVisible&&this.callbackVisibleUpdate.call(this,a,b)}setInvisible(a){a=void 0===a?this.currentTime():a;if(this.isVisible){this.isVisible=!1;!1===this.viewed&&0!==this.viewStart&&(this.viewedTime+=
a-this.viewStart,this.visibilityTimeoutId&&(this.logger.log(`setInvisible() Clear timer '${this.visibilityTimeoutId}'`),this.context.Environment.hostWindow.clearTimeout(this.visibilityTimeoutId),this.visibilityTimeoutId=0),this.callbackTrackingEnds.call(this),this.callbackInvisible.call(this));!0!==this.viewed||this.performOnlyOnce?!0===this.viewed&&this.performOnlyOnce&&(this.callbackInvisible.call(this),this.disable()):(this.callbackTrackingEnds.call(this),this.callbackInvisible.call(this));var b=
this.viewedTime;0<this.visibilityHandlerGroupList.length?(this.logger.log('setInvisible() Determine the viewedTime sum from the group'),b=0,this.visibilityHandlerGroupList.forEach(g=>{this.logger.log(`setInvisible() Add viewedTime of '${g.visibilityHandler.viewedTime}' (current: ${b}) from the group member '${g.title}'`);b+=g.visibilityHandler.viewedTime}),this.logger.log(`setInvisible() Calculated viewedTime of '${b}' from the group`)):this.logger.log(`setInvisible() Calculated viewedTime of '${b}' from myself`)}}}
class f extends r{constructor(a,b,g,c,f,k,q,n,l,r,h,d,u){q=void 0===q?[]:q;super(a,b,g,c,f,k,q,n,l,r,h,d,u);this.lastVisibilityPercentage=0;this.setInvisible=d=>{d=void 0===d?this.currentTime():d;this.logger.log(`Ad is NOT visible for minimum ${this.visibilityPercent} - detected by scroll handler`,{now:d,viewStart:this.viewStart,percent:this.lastVisibilityPercentage,time:this.viewedTime});super.setInvisible(d)};this.logger=b.newLogger(`VisibilityHandlerScroll[${this.title}]`);this.calculateVisibilityHandler=
()=>{}}enable(){const {visibilityTarget:a}=this;this.logger.log('Enable visibility tracking by using scroll handler',{threshold:this.visibilityPercent,ms:this.visibilityTime});this.trackViewportUpdates(a,this.onVisibility.bind(this));this.onVisibility(this.calculateVisibility(a));return!0}disable(){const {Listener:a}=this.context;if(this.disabled)return!0;this.disabled=!0;this.logger.log('Disable visibility tracking by using scroll handler',{threshold:this.visibilityPercent,ms:this.visibilityTime});
this.context.Environment.hostWindow.clearTimeout(this.visibilityTimeoutId);a.remove('scroll',this.calculateVisibilityHandler);a.remove('resize',this.calculateVisibilityHandler);a.remove('orientationchange',this.calculateVisibilityHandler);return!0}calculateVisibility(a){const {left:b,top:g,right:c,bottom:f,width:k,height:q}=a.getBoundingClientRect(),{innerHeight:n,innerWidth:l}=this.context.Environment.hostWindow;a=h(b,c,0,l);const r=h(g,f,0,n);return{visibilityPercentage:a*r,left:b,top:g,right:c,
bottom:f,width:k,height:q,visibilityX:a,visibilityY:r}}trackViewportUpdates(a,b){const {Listener:g}=this.context;this.calculateVisibilityHandler=()=>{b(this.calculateVisibility(a))};g.add('scroll',this.calculateVisibilityHandler,0,!0);g.add('resize',this.calculateVisibilityHandler,0,!0);g.add('orientationchange',this.calculateVisibilityHandler,0,!0)}onVisibility(a){const b=this.visibilityPercent/100;this.lastVisibilityPercentage<=b&&a.visibilityPercentage>b?this.setVisible():this.lastVisibilityPercentage>
b&&a.visibilityPercentage<=b&&this.setInvisible();super.visibleUpdate(a);this.lastVisibilityPercentage=a.visibilityPercentage}setVisible(a){a=void 0===a?this.currentTime():a;this.logger.log(`Ad is visible for minimum ${this.visibilityPercent} - detected by scroll handler`,{now:a,percent:this.lastVisibilityPercentage,time:this.viewedTime});super.setVisible(a)}}class q extends r{constructor(...a){super(...a);this.onObserved=a=>{a.forEach(g=>{const a=performance.timeOrigin+g.time;0!==g.intersectionRatio&&
g.intersectionRatio>=this.visibilityPercent/100?this.setVisible(a):this.setInvisible(a)})};this.logger=this.context.newLogger(`VisibilityHandlerIntersectionObserver[${this.title}]`)}enable(){if(this.disabled)return!0;const {visibilityTarget:a}=this;this.logger.log('Enable visibility tracking by using IntersectionObserver handler',{threshold:this.visibilityPercent,ms:this.visibilityTime});try{this.intersectionObserver=new IntersectionObserver(this.onObserved,{root:null,threshold:this.visibilityPercent/
100}),this.intersectionObserver.observe(a)}catch(O){return!1}return!0}disable(){if(this.disabled)return!0;this.disabled=!0;this.logger.log('Disable visibility tracking by using IntersectionObserver handler',{threshold:this.visibilityPercent,ms:this.visibilityTime});this.context.Environment.hostWindow.clearTimeout(this.visibilityTimeoutId);try{if(this.intersectionObserver)this.intersectionObserver.disconnect();else return!1}catch(D){return!1}return!0}setVisible(a){a=void 0===a?this.currentTime():a;
this.logger.log(`Ad is visible for minimum ${this.visibilityPercent} - detected by intersectionObserver handler`,{now:a,percent:-1,time:this.viewedTime});super.setVisible(a)}setInvisible(a){a=void 0===a?this.currentTime():a;this.logger.log(`Ad is NOT visible for minimum ${this.visibilityPercent} - detected by intersectionObserver handler`,{now:a,viewStart:this.viewStart,percent:-1,time:this.viewedTime});super.setInvisible(a)}}var n=a(20);class b extends r{constructor(...a){super(...a);this.onObserved=
a=>{a.forEach(a=>{const g=performance.timeOrigin+a.time;0!==a.intersectionRatio&&a.intersectionRatio>=this.visibilityPercent/100?this.setVisible(g):this.setInvisible(g)})};this.logger=this.context.newLogger(`VisibilityHandlerAmpIntersectionObserver[${this.title}]`)}enable(){if(this.disabled)return!0;this.logger.log('enable',{threshold:this.visibilityPercent,ms:this.visibilityTime});try{this.disableObserver=this.context.Environment.hostWindow.context.observeIntersection(this.onObserved)}catch(D){return!1}return!0}disable(){if(this.disabled)return!0;
this.disabled=!0;this.logger.log('disabled',{threshold:this.visibilityPercent,ms:this.visibilityTime});this.context.Environment.hostWindow.clearTimeout(this.visibilityTimeoutId);try{this.disableObserver()}catch(D){return!1}return!0}setVisible(a){a=void 0===a?this.currentTime():a;this.isVisible||this.logger.log('setVisible');super.setVisible(a)}setInvisible(a){a=void 0===a?this.currentTime():a;this.isVisible&&this.logger.log('setInvisible');super.setInvisible(a)}}var C=a(3);class y extends r{constructor(...a){super(...a);
this.onViewableChange=a=>{a?(this.logger.log('Ad is NOT visible - detected by mraid.isViewable()'),this.setVisible()):(this.logger.log('Ad is visible - detected by mraid.isViewable()'),this.setInvisible())};this.logger=this.context.newLogger(`VisibilityHandlerMRAIDIsViewable[${this.title}]`)}enable(){if(this.disabled)return!0;if(!this.context.Environment.isMRAID)return!1;Object(C.g)(this.onViewableChange);const a=Object(C.o)();this.onViewableChange(a);return!0}disable(){if(this.disabled)return!0;
this.disabled=!0;Object(C.r)(this.onViewableChange);return!0}}class A extends r{constructor(...a){super(...a);this.onExposureChange=a=>{0<this.visibilityPercent&&a>=this.visibilityPercent||0>=this.visibilityPercent&&a>this.visibilityPercent?this.setVisible():this.setInvisible()};this.logger=this.context.newLogger(`VisibilityHandlerMRAIDExposureChange[${this.title}]`)}enable(){if(this.disabled)return!0;if(!this.context.Environment.isMRAID)return!1;Object(C.f)(this.onExposureChange);this.onExposureChange(0);
return!0}disable(){if(this.disabled)return!0;this.disabled=!0;Object(C.q)(this.onExposureChange);return!0}}class B extends r{constructor(...a){super(...a);this.logger=this.context.newLogger(`VisibilityHandlerNoop[${this.title}]`)}enable(){return!1}disable(){return!1}}var t=a(2);const l='IntersectionObserver'in window,x={ENABLED:'enabled',DISABLED:'disabled',SKIPPED:'skipped',WAITING:'waiting',STARTED:'started',PAUSED:'paused',FINISHED:'finished'},S={AD_SESSION_ID:'data-yoc-ad-session-id',CONTAINER_TYPE:'data-yoc-container-type',
VIEWABILITY:'data-yoc-tracking-viewability',VIEWABILITY_STATUS:'data-yoc-tracking-viewability-status',VIEWABILITY_TIME:'data-yoc-tracking-viewability-time',VIEWABILITY_GOAL:'data-yoc-tracking-viewability-goal',VIEWABILITY_SUCCESS:'data-yoc-tracking-viewability-success',CLICK:'data-yoc-tracking-click',CLICK_STATUS:'data-yoc-tracking-click-status',CLICK_GOAL:'data-yoc-tracking-click-goal',CLICK_SUCCESS:'data-yoc-tracking-click-success',REFRESH_STATUS:'data-yoc-refresh-status'};class L{constructor(a,
b,g,c,f,k,q,n,l,r,h,d,u,p,K,V){l=void 0===l?[]:l;u=void 0===u?!1:u;p=void 0===p?()=>{}:p;K=void 0===K?()=>{}:K;V=void 0===V?(d,a)=>{}:V;this.visibilityHandlerGroupList=[];this.checkForEmptyTarget=!1;this.visibilityHandler=null;this.title=a;this.context=b;this.adConfig=g;this.logger=b.newLogger('Visibility');this.visibilityTarget=c;this.checkForEmptyTarget=f;this.visibilityPercent=k;this.visibilityTime=q;this.visibilityHandlerType=n;this.visibilityHandlerGroupList=l;this.performOnlyOnce=r;this.callbackVisible=
h;this.callbackInvisible=d;this.callbackTrackingStarts=p;this.callbackTrackingEnds=K;this.callbackVisibleUpdate=V;this.logger.log(`Setup visibility check ${this.title}`,{visibilityTarget:this.visibilityTarget,visibilityPercent:this.visibilityPercent,visibilityTime:this.visibilityTime,visibilityHandlerType:this.visibilityHandlerType,performOnlyOnce:this.performOnlyOnce});u&&(this.init(),this.enable())}init(){const {Environment:a}=this.context;if(Object(C.b)(this.adConfig))this.logger.log('Google Mobile ads SDK is detected: not enabling this tracker'),
this.visibilityHandler=new B(this.title,this.context,this.visibilityTarget,this.checkForEmptyTarget,this.visibilityPercent,this.visibilityTime,this.visibilityHandlerGroupList,this.performOnlyOnce,this.callbackVisible,this.callbackInvisible,this.callbackTrackingStarts,this.callbackTrackingEnds);else switch(this.visibilityHandlerType){case 'auto':a.isMRAID?Object(C.v)()?this.visibilityHandler=new A(this.title,this.context,this.visibilityTarget,this.checkForEmptyTarget,this.visibilityPercent,this.visibilityTime,
this.visibilityHandlerGroupList,this.performOnlyOnce,this.callbackVisible,this.callbackInvisible,this.callbackTrackingStarts,this.callbackTrackingEnds):this.visibilityHandler=new y(this.title,this.context,this.visibilityTarget,this.checkForEmptyTarget,this.visibilityPercent,this.visibilityTime,this.visibilityHandlerGroupList,this.performOnlyOnce,this.callbackVisible,this.callbackInvisible,this.callbackTrackingStarts,this.callbackTrackingEnds):Object(n.c)(a.hostWindow)?this.visibilityHandler=new b(this.title,
this.context,this.visibilityTarget,this.checkForEmptyTarget,this.visibilityPercent,this.visibilityTime,this.visibilityHandlerGroupList,this.performOnlyOnce,this.callbackVisible,this.callbackInvisible,this.callbackTrackingStarts,this.callbackTrackingEnds):this.visibilityHandler=!0===l?new q(this.title,this.context,this.visibilityTarget,this.checkForEmptyTarget,this.visibilityPercent,this.visibilityTime,this.visibilityHandlerGroupList,this.performOnlyOnce,this.callbackVisible,this.callbackInvisible,
this.callbackTrackingStarts,this.callbackTrackingEnds):new f(this.title,this.context,this.visibilityTarget,this.checkForEmptyTarget,this.visibilityPercent,this.visibilityTime,this.visibilityHandlerGroupList,this.performOnlyOnce,this.callbackVisible,this.callbackInvisible,this.callbackTrackingStarts,this.callbackTrackingEnds,this.callbackVisibleUpdate);break;case 'scroll':this.visibilityHandler=new f(this.title,this.context,this.visibilityTarget,this.checkForEmptyTarget,this.visibilityPercent,this.visibilityTime,
this.visibilityHandlerGroupList,this.performOnlyOnce,this.callbackVisible,this.callbackInvisible,this.callbackTrackingStarts,this.callbackTrackingEnds,this.callbackVisibleUpdate);break;case 'intersectionObserver':!0===l?this.visibilityHandler=new q(this.title,this.context,this.visibilityTarget,this.checkForEmptyTarget,this.visibilityPercent,this.visibilityTime,this.visibilityHandlerGroupList,this.performOnlyOnce,this.callbackVisible,this.callbackInvisible,this.callbackTrackingStarts,this.callbackTrackingEnds):
this.logger.error(`${this.title} Can't setup visibility tracking (via intersectionObserver)`);break;default:this.logger.error(`${this.title} Can't setup visibility tracking (unknown or unsupported handler "${this.visibilityHandlerType}")`)}}enable(){switch(this.visibilityHandlerType){case 'auto':if(!0===l){if(!this.visibilityHandler.enable()){if(Object(C.b)(this.adConfig)&&this.title!==t.t){this.logger.log('Google Mobile ads SDK is detected: not re-enabling this tracker');break}this.visibilityHandler=
new f(this.title,this.context,this.visibilityTarget,this.checkForEmptyTarget,this.visibilityPercent,this.visibilityTime,this.visibilityHandlerGroupList,this.performOnlyOnce,this.callbackVisible,this.callbackInvisible,this.callbackTrackingStarts,this.callbackTrackingEnds,this.callbackVisibleUpdate);return this.visibilityHandler.enable()}return!0}return this.visibilityHandler.enable();case 'scroll':return this.visibilityHandler.enable();case 'intersectionObserver':if(!0===l)return this.visibilityHandler.enable();
this.logger.error(`${this.title} Can't enable visibility tracking (via intersectionObserver)`);break;default:this.logger.error(`${this.title} Can't enable visibility tracking (unknown or unsupported handler "${this.visibilityHandlerType}")`)}return!1}disable(){return this.visibilityHandler.disable()}}},function(m,c,a){function h(a){({style:a}=a);a.display='none';a.visibility='hidden'}function k(a){({style:a}=a);a.display='';a.visibility='visible'}function r(a,b){const g=a.hostDocument.createElement('style');
g.append(a.hostDocument.createTextNode(b));a.hostDocument.head.append(g)}function f(a){try{return a.mozHasAudio||!!a.webkitAudioDecodedByteCount||!(!a.audioTracks||!a.audioTracks.length)}catch(w){}return!1}a.d(c,'e',function(){return q});a.d(c,'f',function(){return h});a.d(c,'h',function(){return k});a.d(c,'g',function(){return r});a.d(c,'b',function(){return n});a.d(c,'a',function(){return b});a.d(c,'c',function(){return S});a.d(c,'d',function(){return O});var q=function(a,b){return a.hostDocument.createElement(b)};
class n{constructor(a,b,c,f){c=void 0===c?!0:c;f=void 0===f?!1:f;this.onLoad=()=>{this.logger.log('On load of img tag invoked',this.url);const a=this.state;this.state='loaded';this.context.messageBus.asset.emit({kind:'updated',message:{kind:'updated-state',asset:this,previousState:a}})};this.onError=()=>{this.logger.log('On error of img tag invoked',this.url);const a=this.state;this.state='failed-preload';this.context.messageBus.asset.emit({kind:'updated',message:{kind:'updated-state',asset:this,
previousState:a}})};var {Environment:g}=a;g=q(g,'img');this.context=a;this.logger=a.newLogger('Image');this.state='preloading';this.node=g;this.url=b;this.logger.log(`Creating img tag (${c?'asset':'no asset'})`,this.url);!0===c&&(this.logger.log('Add img tag as new asset',this.url),a.messageBus.asset.emit({kind:'added',message:{kind:'new-asset',asset:this}}),g.addEventListener('load',this.onLoad,!1),g.addEventListener('error',this.onError,!1));f?g.setAttribute('data-src',b):g.src=b}}class b{constructor(a,
b,c){c=void 0===c?!0:c;this.onLoad=()=>{const a=this.state;this.state='loaded';this.context.messageBus.asset.emit({kind:'updated',message:{kind:'updated-state',asset:this,previousState:a}})};this.onError=()=>{const a=this.state;this.state='failed-preload';this.context.messageBus.asset.emit({kind:'updated',message:{kind:'updated-state',asset:this,previousState:a}})};const g=document.createElement('iframe');this.context=a;this.state='preloading';this.node=g;this.url=b;!0===c&&(a.messageBus.asset.emit({kind:'added',
message:{kind:'new-asset',asset:this}}),g.addEventListener('load',this.onLoad,!1),g.addEventListener('error',this.onError,!1));g.src=b}}var C=a(11),y=a(12);m=a(7);var A=a(10),B=a(6),t=a(5),l=a(21),x=a(3);class S extends m.a{constructor(a,b){super();this.state='preloading';this.height=this.width=0;this.previousVideoProgress={currentTime:0,percentage:0};this.loadPromiseReject=this.loadPromiseResolver=0;this.isPlayAgain=this.isEnded=!1;this.muted=!0;this.reportedStats=this.haveStarted=this.haveRestartedOnFirstUnmute=
!1;this.dimensionsListenersForHLS={};this.isWaiting=!1;this.videoScrollDownContainer=document.createElement('div');this.onSourceError=()=>{var a='Video: <source> error: '+this.url;this.context.Environment.isLogMode&&(console.error('debug!'),console.error(a));this.logger.error(a);this.loadPromiseReject(new t.k(t.g));a=this.state;this.state='failed-preload';this.context.messageBus.asset.emit({kind:'updated',message:{kind:'updated-state',asset:this,previousState:a}});this.context.messageBus.event.emit({kind:'close',
interactive:!1})};this.onError=()=>{const {Environment:a}=this.context;let d='Video: error: '+this.url;const {error:g}=this.video;let b=t.f;g?(g.message&&(d+='\n'+g.message),this.logger.error(d),-1!==[3,4].indexOf(g.code)&&(b=t.h)):this.logger.error(d);this.context.messageBus.event.emit({kind:'tracker',event:'video-error',details:{errorCode:b}});this.context.messageBus.event.emit({kind:'close',interactive:!1});(a.isLogMode||a.isDebugMode)&&this.context.troubleshooting.log();a.isMRAID&&Object(x.z)(this.adConfig.mraid,
this.logger)};this.onLoadedMetadata=()=>{this.logger.debug('Video: loaded metadata',{url:this.url,'video-dimensions':`${this.video.videoWidth}\u00d7${this.video.videoHeight}`});const a=this.state;this.state='loaded';this.context.messageBus.asset.emit({kind:'updated',message:{kind:'updated-state',asset:this,previousState:a}});this.reattachVideo();const {videoWidth:d,videoHeight:g,duration:b}=this.video;d||g?this.emit({kind:'actualVideoSizes',width:d,height:g,duration:b,source:'video-slot'}):this.subscribeToVideoEventsToGetVideoSizes();
this.loadPromiseResolver()};this.onLoadedData=()=>{this.logger.debug('Video: loaded data');this.emit({kind:'audioAvailability',hasAudio:f(this.video)})};this.canScrollPlay=!0;this.onCanPlay=()=>{this.adConfig.video.scrollPlay&&(this.canScrollPlay&&this.context.adCore.initScrollVideoAd(this.video),this.canScrollPlay=!1);const {meta:{adSessionId:a}}=this.context.initConfig;try{if('enabled'===this.adConfig.video.background.mode&&0===this.adConfig.video.background.video.top&&0===this.adConfig.video.background.video.left&&
'blurred-video'===this.adConfig.creative.portrait.mode&&0===this.adConfig.creative.portrait.width&&0===this.adConfig.creative.portrait.height){const d=this.context.Environment.getVideoDimensions();this.logger.log('VAST - Enable automatic blurred background',d);['zoom','zoomToSticky'].includes(this.adConfig.display.effect)?(this.adConfig.creative.portrait.width=d.mediaWidth*(this.context.Environment.isDeviceSmartphone?2:3),this.adConfig.creative.portrait.height=d.mediaHeight,this.adConfig.video.background.video.top=
0,this.adConfig.video.background.video.left=(this.adConfig.creative.portrait.width-d.mediaWidth)/2):(['sitebar'].includes(this.adConfig.display.effect)||['fullscreenOverlay'].includes(this.adConfig.display.effect),this.adConfig.creative.portrait.width=d.mediaWidth,this.adConfig.creative.portrait.height=3*d.mediaHeight,this.adConfig.video.background.video.top=d.mediaHeight,this.adConfig.video.background.video.left=0);this.context.adCore.onResize()}else if('enabled'===this.adConfig.video.background.mode&&
0===this.adConfig.video.background.video.top&&0===this.adConfig.video.background.video.left&&'static-image'===this.adConfig.creative.portrait.mode&&0<this.adConfig.creative.portrait.width&&0<this.adConfig.creative.portrait.height&&'string'===typeof this.adConfig.video.background.video.align&&'disabled'!==this.adConfig.video.background.video.align){const d=this.context.Environment.getVideoDimensions();this.logger.log('Enable automatic image background',d);if((['zoom','zoomToSticky'].includes(this.adConfig.display.effect)||
'universal-ad-format'===this.context.initConfig.product.key&&'string'===typeof this.adConfig.universal.effect&&-1<this.adConfig.universal.effect.indexOf('zoom'))&&'center'===this.adConfig.video.background.video.align){this.adConfig.video.background.video.align='disabled';let a=d.mediaHeight/this.adConfig.creative.portrait.height;this.adConfig.creative.portrait.width*=a;this.adConfig.creative.portrait.height*=a;this.context.Environment.updatedCreativeWidth=this.adConfig.creative.portrait.width;this.context.Environment.updatedCreativeHeight=
this.adConfig.creative.portrait.height;this.adConfig.video.background.video.top=0;this.adConfig.video.background.video.left=(this.adConfig.creative.portrait.width-d.mediaWidth)/2}this.context.adCore.updateStyles({updateAdPosition:!0,reset:!1});this.context.adCore.onResize()}if(this.context.Environment.isZoom&&!this.context.adCore.zoomIsInitialized){'undefined'!==typeof this.adConfig.display.features&&'undefined'!==typeof this.adConfig.display.features.overlap&&!0===this.adConfig.display.features.overlap?
this.context.adCore.initZoom(this.context.adCore.adPainter.productContainer):this.context.adCore.initZoom(this.context.adCore.zoomElement);const d=this.context.Environment.getVideoDimensions(),g=this.adConfig.icon.scrollDown.url;let b=this.adConfig.icon.scrollDown.width,c=this.adConfig.icon.scrollDown.height;if(0===b||0===c)b=d.mediaHeight*d.adScaleFactor*.15,c=d.mediaHeight*d.adScaleFactor*.15;let f=(d.mediaWidth*d.adScaleFactor-b)/2;const Q=document.createElement('img');Q.id=`yoc_video_scroll_down_image_${this.context.productTitlePostfix}_${a}`;
Q.src=g;Q.style.cssText=`position: absolute; top: 0px; left: 0px; width: ${b}px; height: ${c}px;`;const I=this.videoScrollDownContainer;I.id=`yoc_video_scroll_down_container_${this.context.productTitlePostfix}_${a}`;I.style.cssText=`user-select: none; position: absolute; left: ${f}px; bottom: 0px; width: ${b}px; height: ${c}px;`;I.className=`bounceInfinite${a}`;I.append(Q);this.wrapper.append(I)}}catch(d){this.logger.error(d)}};this.onPlay=()=>{const {Environment:a}=this.context;this.haveStarted?
this.emit({kind:'resume'}):(this.emit({kind:'start'}),this.haveStarted=!0);const {breakpointTrackingPercentage:d,breakpointTrackingTime:g}=this.options;this.logger.debug('Video: Play',{'tracking-time-breakpoints':g.map(d=>Object(B.a)(a,d)).join(', '),'tracking-percent-breakpoints':d.map(d=>Object(A.a)(a,d)).join(', ')});this.reportedStats||(this.reportedStats=!0,this.reportStats());this.emit({kind:'play'})};this.onPause=()=>{this.emit({kind:'pause'})};this.onResume=()=>{this.emit({kind:'resume'})};
this.onTimeUpdate=()=>{this.emit({kind:'timeUpdate'});this.performVideoTracking(this.currentProgress)};this.onEnded=()=>{this.logger.debug('Video: Ended');this.performVideoTracking(this.currentProgress);this.isEnded=!0;this.hideSubtitles();this.emit({kind:'complete'});const {Environment:a}=this.context;a.isMRAID&&Object(x.w)(this.adConfig.mraid,this.logger)};this.onWaiting=()=>{this.logger.debug('Video: Waiting');this.isWaiting=!0;this.emit({kind:'waiting'})};this.onPlaying=()=>{this.logger.debug('Video: Playing');
this.isWaiting&&this.emit({kind:'resumed-from-waiting'});this.isWaiting=!1};this.addCueChange=()=>{const a=this.track.track.activeCues;let d='';a&&Object.keys(a).forEach(g=>{try{d+=`${d?'<br/>\r\n':''}${a[g].getCueAsHTML().textContent}`}catch(p){this.logger.error(p)}});d=d.replace(/\n/g,'<br/>\r\n');d=d.replace(/\r/g,'');this.divCues.innerHTML=d;this.showSubtitles()};this.showSubtitles=()=>{try{''!==this.divCues.innerHTML.trim()&&this.video.muted?this.divCues.style.visibility='visible':this.divCues.style.visibility=
'hidden'}catch(Z){}};this.hideSubtitles=()=>{try{this.divCues.style.visibility='hidden'}catch(Z){}};const {context:g,adConfig:c,initConfig:k,sourceUrl:n}=a;this.adConfig=c;this.uniqueId='yoc_video_player_'+k.meta.adSessionId;g.messageBus.asset.emit({kind:'added',message:{kind:'new-asset',asset:this}});this.context=g;this.logger=g.newLogger('VideoPlayerMedia');this.url=n;({Environment:a}=this.context);this.options=Object.assign({},y.a,b);this.wrapper=b=q(a,'div');b.style.display='block';b=q(a,'video');
const l=document.createElement('div');this.divCues=l;l.id=`yoc_video_subtitle_content_${this.context.productTitlePostfix}_${k.meta.adSessionId}`;l.style.cssText=`display: inline-block; font-family: arial; line-height: normal; border-radius: 3px; padding: 2px 5px; background-color: ${c.video.subtitles.bgColor}; color: ${c.video.subtitles.textColor}; font-size: ${c.video.subtitles.fontSize};`;const r=document.createElement('div');r.id=`yoc_video_subtitle_container_${this.context.productTitlePostfix}_${k.meta.adSessionId}`;
r.style.cssText='position: absolute; bottom: 5%; text-align: center; font-size: 28pt; width: 100%;';r.appendChild(l);this.wrapper.appendChild(r);this.track=q(a,'track');this.video=b;b.muted=!0;b.preload='auto';'playsInline'in b&&(b.playsInline=!0);b.style.pointerEvents='none';b.style.height='100%';b.style.width='100%';b.id=this.uniqueId;b.addEventListener('loadedmetadata',this.onLoadedMetadata,!1);b.addEventListener('loadeddata',this.onLoadedData,!1);b.addEventListener('error',this.onError,!1);b.addEventListener('canplay',
this.onCanPlay,!1);b.addEventListener('play',this.onPlay,!1);b.addEventListener('playing',this.onPlaying,!1);b.addEventListener('timeupdate',this.onTimeUpdate,!1);b.addEventListener('ended',this.onEnded,!1);b.addEventListener('waiting',this.onWaiting,!1);this.setDimensions({width:this.width,height:this.height,scaleFactor:1});b.style.display='none';this.context.rootContainer.append(b);this.loadPromise=new Promise((a,d)=>{this.loadPromiseResolver=a;this.loadPromiseReject=d});this.videoSource=q(a,'source')}load(){this.videoSource.addEventListener('error',
this.onSourceError,!1);{let {url:a}=this;if(Object(l.a)()&&!/#/.test(a)||this.context.Environment.isMRAID)a+='#t=0.001';this.videoSource.src=a}this.video.append(this.videoSource);return this.loadPromise}setDimensions(a){var {width:g,height:b,scaleFactor:c}=a;this.width=g;this.height=b;a=this.wrapper.style;a.width=''+g+'px';a.height=''+b+'px';a.transform=`scale(${c})`;a.transformOrigin='top left'}performVideoTracking(a){const {options:g,previousVideoProgress:b}=this,{Environment:c}=this.context;g.breakpointTrackingTime.forEach(g=>
{b.currentTime<=g&&g<a.currentTime&&(this.logger.debug('progressTime',{time:Object(B.a)(c,g)}),this.emit({kind:'progressTime',time:g}))});g.breakpointTrackingPercentage.forEach(g=>{const f=g/100;b.percentage<=f&&f<a.percentage&&(this.logger.debug('progressPercentage',{time:Object(A.a)(c,f)}),this.emit({kind:'progressPercentage',percentage:g}))});.25>=b.percentage&&.25<a.percentage?(this.logger.debug('firstQuartile'),this.emit({kind:'firstQuartile'})):.5>=b.percentage&&.5<a.percentage?(this.logger.debug('midpoint'),
this.emit({kind:'midpoint'})):.75>=b.percentage&&.75<a.percentage&&(this.logger.debug('thirdQuartile'),this.emit({kind:'thirdQuartile'}));this.previousVideoProgress=a}appendTo(a){a.append(this.wrapper)}reattachVideo(){const {video:a,wrapper:b}=this;b.append(a);a.style.removeProperty('display')}subscribeToVideoEventsToGetVideoSizes(){const {video:a}=this,b=()=>{const {videoWidth:g,videoHeight:b,duration:c}=a;g&&b&&c&&(this.unsubscribeFromVideoEvents(g,b,c),this.emit({kind:'actualVideoSizes',width:g,
height:b,duration:c,source:'video-slot'}))};for(let g in a)if(/^on/.test(g)&&!/mouse|touch|pointer/.test(g)){const c=g.slice(2);this.dimensionsListenersForHLS[c]=b;a.addEventListener(c,b,!1)}}unsubscribeFromVideoEvents(a,b,c){const {dimensionsListenersForHLS:g,video:f}=this;Object.keys(g).forEach(a=>{f.removeEventListener(a,g[a],!1)})}get currentProgress(){if(0===this.video.readyState)return{currentTime:0,percentage:0};const {duration:a,currentTime:b}=this.video;return{currentTime:this.video.currentTime,
percentage:b/a}}mute(){this.muted=!0;var {video:a}=this;this.logger.debug('mute');a.muted||(a.muted=!0,this.showSubtitles(),this.emit({kind:'mute'}),{Environment:a}=this.context,a.isMRAID&&Object(x.x)(this.adConfig.mraid,this.logger))}unmute(){this.logger.debug('unmute');this.muted=!1;var {video:a}=this;if(!this.haveRestartedOnFirstUnmute){try{this.logger.debug(`unmute - reset video.currentTime from ${a.currentTime} to 0`)}catch(w){}a.currentTime=0}a.muted&&(a.muted=!1,this.hideSubtitles(),this.emit({kind:'unmute'}),
{Environment:a}=this.context,a.isMRAID&&Object(x.y)(this.adConfig.mraid,this.logger));this.haveRestartedOnFirstUnmute=!0}play(){if(this.isEnded&&!this.isPlayAgain)this.logger.debug('play: already ended');else{this.isPlayAgain?this.logger.debug('play again'):this.logger.debug('play');const a=this.video.play();a&&a.then(()=>{}).catch(a=>{this.logger.error(`play: ${a}`);this.context.messageBus.event.emit({kind:'tracker',event:'video-error',details:{errorCode:t.f}});this.context.messageBus.event.emit({kind:'close',
interactive:!1})})}}pause(){this.logger.debug('pause');this.video.pause()}seek(a){const {video:b}=this,{Environment:g}=this.context;if(0<=a&&a<=b.duration)this.logger.debug('seek',{timeOffset:Object(B.a)(g,a)}),'undefined'!==typeof b.fastSeek?b.fastSeek(a):b.currentTime=a;else if(a>=-b.duration){const c=b.duration+a;this.logger.debug('seek',{timeOffset:Object(B.a)(g,a),targetTime:Object(B.a)(g,c)});'undefined'!==typeof b.fastSeek?(b.currentTime=c,b.fastSeek(c)):b.currentTime=c}else this.logger.debug('seek: bad timeOffset',
{timeOffset:Object(B.a)(g,a)})}dispose(){this.logger.debug('dispose');const {video:a,videoSource:b}=this;a.removeEventListener('loadedmetadata',this.onLoadedMetadata,!1);a.removeEventListener('loadeddata',this.onLoadedData,!1);a.removeEventListener('error',this.onError,!1);a.removeEventListener('canplay',this.onCanPlay,!1);a.removeEventListener('play',this.onPlay,!1);a.removeEventListener('playing',this.onPlaying,!1);a.removeEventListener('pause',this.onPause,!1);a.removeEventListener('resume',this.onResume,
!1);a.removeEventListener('timeupdate',this.onTimeUpdate,!1);a.removeEventListener('ended',this.onEnded,!1);a.removeEventListener('waiting',this.onWaiting,!1);b.removeEventListener('error',this.onSourceError,!1);a.pause()}reportStats(){const {video:a}=this;this.context.messageBus.event.emit({kind:'tracker',event:'video-on-play-stats',details:{stats:`${Object(y.b)(a)}x${a.videoWidth}x${a.videoHeight}@${Object(B.a)(this.context.Environment,a.duration)}`}})}addSubtitles(a){const {Environment:b}=this.context;
this.track=q(b,'track');a=new Blob([a],{type:'text/vtt'});this.track.kind='captions';this.track.src=URL.createObjectURL(a);this.track.addEventListener('cuechange',this.addCueChange,!1);this.video.appendChild(this.track);this.track.mode='hidden';this.video.textTracks[0].mode='hidden';this.hideSubtitles()}}class L extends m.a{constructor(a,b,c,f,k,q,n,l,r){super();this.loadPromiseReject=this.loadPromiseResolver=0;this.adHasBeenLoaded=!1;this.lastVolume=this.lastCurrentTime=this.adRemainingDurationTimeoutPollId=
0;this.videoCompleted=this.adStopInvoked=this.isEnded=this.disposed=this.haveStarted=!1;this.onVPAIDLoaded=()=>{this.logger.debug('onVPAIDLoaded');var a=this.vpaidIframe.contentWindow;if(a&&a.getVPAIDAd){const d=a.getVPAIDAd();if(this.checkVPAIDInterface(d)){this.ad=d;this.logger.debug('subscribing VPAID event handlers');Object.keys(this.callbacks).forEach(a=>{d.subscribe(this.callbacks[a],a)});a=d.handshakeVersion('2.0');this.logger.debug('handshakeVersion',{result:a});a={AdParameters:this.adParameters};
const b={slot:this.slot,videoSlot:this.videoSlot,videoSlotCanAutoPlay:!1};this.logger.debug('initAd',{width:this.width,height:this.height,viewMode:'normal',desiredBitrate:500,creativeData:JSON.stringify(a,null,2)});this.timeoutCallTimerId=window.setTimeout(this.timeoutCall.bind(this,'initAd'),this.adConfig.video.VPAIDCallTimeout);d.initAd(this.width,this.height,'normal',500,a,b)}}};this.onVPAIDLoadError=()=>{this.loadPromiseReject(Error(`unable to load vpaid: ${this.vpaidUrl}`))};this.onAdStarted=
()=>{this.timeoutCallTimerId&&(window.clearTimeout(this.timeoutCallTimerId),delete this.timeoutCallTimerId);if(!this.disposed){this.haveStarted=!0;var a=this.ad.getAdWidth(),b=this.ad.getAdHeight();this.tryToUseVideoDimensionsFromTheVideoInsideSlot();this.logger.debug('onStartAd',{width:a,height:b});this.dumpDebugInfo();var g=()=>{this.adRemainingDurationTimeoutPollId=window.setTimeout(g,250);this.onTimeUpdate()};g();this.emit({kind:'AdStarted'})}};this.onAdStopped=()=>{if(!this.adStopInvoked)this.onAdVideoComplete();
this.disposed||(this.logger.debug('onStopAd'),window.clearTimeout(this.adRemainingDurationTimeoutPollId))};this.onAdSkipped=()=>{this.disposed||(this.logger.debug('onSkipAd'),this.emit({kind:'AdSkipped'}))};this.onAdLoaded=()=>{this.timeoutCallTimerId&&(window.clearTimeout(this.timeoutCallTimerId),delete this.timeoutCallTimerId);this.disposed||(this.logger.debug('onAdLoaded'),this.context.messageBus.event.emit({kind:'tracker',event:'vpaid-init'}),this.adHasBeenLoaded=!0,this.lastVolume=this.ad.getAdVolume(),
this.dumpDebugInfo(),this.loadPromiseResolver())};this.onAdLinearChange=()=>{this.disposed||this.logger.debug('onAdLinearChange')};this.onAdSizeChange=()=>{if(!this.disposed){var a=this.ad.getAdWidth(),b=this.ad.getAdHeight();this.logger.debug('onAdSizeChange',{width:a,height:b})}};this.onAdExpandedChange=()=>{this.disposed||this.logger.debug('onAdExpandedChange')};this.onAdSkippableStateChange=()=>{this.disposed||this.logger.debug('onAdSkippableStateChange')};this.onAdDurationChange=()=>{if(!this.disposed){var a=
this.ad.getAdDuration();this.logger.debug('onAdDurationChange',{duration:Object(B.a)(this.context.Environment,a)})}};this.onAdRemainingTimeChange=()=>{this.disposed||this.logger.debug('onAdRemainingTimeChange')};this.onAdVolumeChange=()=>{if(!this.disposed){var a=this.ad.getAdVolume(),{lastVolume:b}=this,{Environment:g}=this.context;this.logger.debug('onAdVolumeChange',{last:Object(A.a)(g,b),current:Object(A.a)(g,a)});0===a&&0<b?this.emit({kind:'AdVolumeChange',muted:!0}):this.emit({kind:'AdVolumeChange',
muted:!1});this.lastVolume=a}};this.onAdImpression=()=>{this.disposed||(this.logger.debug('onAdImpression'),this.emit({kind:'AdImpression'}))};this.onAdClickThru=(a,b,g)=>{this.disposed||(this.logger.debug('onAdClickThru',{url:a,id:b,playerHandles:g}),b={kind:'AdClickThru',playerHandles:g},a&&(b.url=a),this.emit(b))};this.onAdInteraction=()=>{this.disposed||this.logger.debug('onAdInteraction')};this.onAdVideoStart=()=>{if(!this.disposed){this.logger.log('onAdVideoStart');var a=this.ad.getAdWidth(),
b=this.ad.getAdHeight();this.tryToUseVideoDimensionsFromTheVideoInsideSlot();this.callbackWithMediaFileDimensions(a,b);this.dumpDebugInfo();this.emit({kind:'AdVideoStart'})}};this.onAdVideoFirstQuartile=()=>{this.disposed||(this.logger.debug('onAdVideoFirstQuartile'),this.emit({kind:'AdVideoFirstQuartile'}))};this.onAdVideoMidpoint=()=>{this.disposed||(this.logger.debug('onAdVideoMidpoint'),this.emit({kind:'AdVideoMidpoint'}))};this.onAdVideoThirdQuartile=()=>{this.disposed||(this.logger.debug('onAdVideoThirdQuartile'),
this.emit({kind:'AdVideoThirdQuartile'}))};this.onAdVideoComplete=()=>{this.isEnded=!0;this.videoCompleted||(this.videoCompleted=!0,this.disposed||(this.logger.debug('onAdVideoComplete'),this.emit({kind:'AdVideoComplete'})))};this.onAdUserAcceptInvitation=()=>{this.disposed||this.logger.debug('onAdUserAcceptInvitation')};this.onAdUserMinimize=()=>{this.disposed||this.logger.debug('onAdUserMinimize')};this.onAdUserClose=()=>{this.disposed||this.logger.debug('onAdUserClose')};this.onAdPaused=()=>{this.disposed||
(this.logger.debug('onAdPaused'),window.clearTimeout(this.adRemainingDurationTimeoutPollId),this.emit({kind:'AdPaused'}))};this.onAdPlaying=()=>{this.disposed||(this.logger.debug('onAdPlaying'),this.emit({kind:'AdPlaying'}))};this.onAdError=a=>{this.disposed||(this.logger.debug('onAdError'),this.emit({kind:'AdError',message:a}))};this.onAdLog=()=>{this.disposed||this.logger.debug('onAdLog')};this.onTimeUpdate=()=>{const {currentTime:a}=this;a!==this.lastCurrentTime&&this.emit({kind:'progressTime',
currentTime:a,duration:this.ad.getAdDuration()});this.lastCurrentTime=a};this.adConfig=b;this.context=a;this.logger=a.newLogger('VPAIDProcessor');this.logger.debug('constructor');this.adParameters=f;this.vpaidUrl=c;this.slot=k;this.videoSlot=q;this.width=n;this.height=l;this.videoPlayerVPAID=r;this.loadPromise=new Promise((a,b)=>{this.loadPromiseResolver=a;this.loadPromiseReject=b})}load(){this.logger.debug('load');const a=document.createElement('iframe');h(a);this.vpaidIframe=a;this.context.rootContainer.append(a);
const b=a.contentWindow;b.inDapIF=!0;const c=b.document.createElement('script');c.src=this.vpaidUrl;c.addEventListener('load',this.onVPAIDLoaded);c.addEventListener('error',this.onVPAIDLoadError);setTimeout(()=>{b.document.body.appendChild(c)},0);return this.loadPromise}get callbacks(){return{AdStarted:this.onAdStarted,AdStopped:this.onAdStopped,AdSkipped:this.onAdSkipped,AdLoaded:this.onAdLoaded,AdLinearChange:this.onAdLinearChange,AdSizeChange:this.onAdSizeChange,AdExpandedChange:this.onAdExpandedChange,
AdSkippableStateChange:this.onAdSkippableStateChange,AdDurationChange:this.onAdDurationChange,AdRemainingTimeChange:this.onAdRemainingTimeChange,AdVolumeChange:this.onAdVolumeChange,AdImpression:this.onAdImpression,AdClickThru:this.onAdClickThru,AdInteraction:this.onAdInteraction,AdVideoStart:this.onAdVideoStart,AdVideoFirstQuartile:this.onAdVideoFirstQuartile,AdVideoMidpoint:this.onAdVideoMidpoint,AdVideoThirdQuartile:this.onAdVideoThirdQuartile,AdVideoComplete:this.onAdVideoComplete,AdUserAcceptInvitation:this.onAdUserAcceptInvitation,
AdUserMinimize:this.onAdUserMinimize,AdUserClose:this.onAdUserClose,AdPaused:this.onAdPaused,AdPlaying:this.onAdPlaying,AdError:this.onAdError,AdLog:this.onAdLog}}setDimensions(a){var {width:b,height:g}=a;this.disposed||this.isEnded||(this.logger.debug('vpaid.resizeAd()',{width:b,height:g,viewMode:'normal'}),this.ad.resizeAd(b,g,'normal'))}get isReady(){return!!this.ad&&this.adHasBeenLoaded}play(){this.isReady?(this.logger.debug('play'),this.haveStarted?(this.logger.debug('vpaid.resumeAd()'),this.ad.resumeAd()):
(this.timeoutCallTimerId&&window.clearTimeout(this.timeoutCallTimerId),this.timeoutCallTimerId=window.setTimeout(this.timeoutCall.bind(this,'startAd'),this.adConfig.video.VPAIDCallTimeout),this.logger.debug('vpaid.startAd()'),this.ad.startAd())):this.logger.warn("play: vpaid creative isn't ready")}pause(){this.isReady?(this.logger.debug('pause'),this.logger.debug('vpaid.pauseAd()'),this.ad.pauseAd()):this.logger.warn("pause: vpaid creative isn't ready")}mute(){this.isReady?(this.logger.debug('mute'),
this.logger.debug('vpaid.setAdVolume()',{volume:0}),this.ad.setAdVolume(0)):this.logger.warn("mute: vpaid creative isn't ready")}unmute(){this.isReady?(this.logger.debug('unmute'),this.logger.debug('vpaid.setAdVolume()',{volume:1}),this.ad.setAdVolume(1)):this.logger.warn("unmute: vpaid creative isn't ready")}checkVPAIDInterface(a){this.logger.debug('checking VPAID interface');return'handshakeVersion initAd startAd stopAd skipAd resizeAd pauseAd resumeAd expandAd collapseAd subscribe unsubscribe'.split(' ').every(b=>
'function'===typeof a[b])}get currentTime(){if(!this.isReady)return 0;const a=this.ad.getAdRemainingTime();return this.ad.getAdDuration()-a}dumpDebugInfo(){const a=this.ad;this.logger.debug('VPAID properties',{adLinear:a.getAdLinear(),adWidth:a.getAdWidth(),adHeight:a.getAdHeight(),adExpanded:a.getAdExpanded(),adSkippableState:a.getAdSkippableState(),adRemainingTime:a.getAdRemainingTime(),adDuration:a.getAdDuration(),adVolume:a.getAdVolume(),adCompanions:a.getAdCompanions(),adIcons:a.getAdIcons()})}dispose(){this.logger.debug('dispose');
this.disposed=!0;this.ad&&(Object.keys(this.callbacks).forEach(a=>{this.ad.unsubscribe(this.callbacks[a],a)}),this.timeoutCallTimerId=window.setTimeout(this.timeoutCall.bind(this,'stopAd'),this.adConfig.video.VPAIDCallTimeout),this.logger.debug('vpaid.stopAd()'),this.adStopInvoked=!0,this.ad.stopAd())}timeoutCall(a){this.disposed||(this.logger.error('VPAID Call Timeout',{callName:a}),this.context.messageBus.event.emit({kind:'tracker',event:'video-error',details:{errorCode:t.j}}),this.context.messageBus.event.emit({kind:'close',
interactive:!1}))}tryToUseVideoDimensionsFromTheVideoInsideSlot(){if(this.videoSlot.videoWidth&&this.videoSlot.videoHeight&&this.videoSlot.duration)this.dimensionsCallback(this.videoSlot.videoWidth,this.videoSlot.videoHeight,this.videoSlot.duration,'video-slot'),this.checkAudio(this.videoSlot),this.reportStats(this.videoSlot);else{var a=Array.apply(null,this.slot.querySelectorAll('video')).filter(a=>a!==this.videoSlot);if(1===a.length){const {videoWidth:b,videoHeight:g}=a[0];if(b&&g){const c=this.ad.getAdDuration();
this.dimensionsCallback(b,g,c,'video-slot');this.checkAudio(a[0]);this.reportStats(a[0])}}}}callbackWithMediaFileDimensions(a,b){const g=this.ad.getAdDuration();this.dimensionsCallback(a,b,g,'vast-mediafile')}dimensionsCallback(a,b,c,f){this.videoPlayerVPAID.emit({kind:'actualVideoSizes',width:a,height:b,duration:c,source:f})}reportStats(a){this.context.messageBus.event.emit({kind:'tracker',event:'video-on-play-stats',details:{stats:`${Object(y.b)(a)}x${a.videoWidth}x${a.videoHeight}x${Object(B.a)(this.context.Environment,
a.duration)}`}})}checkAudio(a){this.videoPlayerVPAID.emit({kind:'audioAvailability',hasAudio:f(a)})}}var D=a(0);class O extends m.a{constructor(a,b){super();this.vpaidLoadPromiseResolved=!1;this.previousVideoProgress=0;this.isEnded=!1;this.muted=!0;this.wasClicked=!1;this.videoScrollDownContainer=document.createElement('div');this.onVpaidProcessorEvent=a=>{switch(a.kind){case 'AdSkipped':this.emit({kind:'skip'});break;case 'AdStarted':this.emit({kind:'creativeView'});break;case 'AdImpression':this.emit({kind:'impression'});
break;case 'AdVideoStart':this.emit({kind:'start'});'enabled'===this.adConfig.video.background.mode&&0===this.adConfig.video.background.video.top&&0===this.adConfig.video.background.video.left&&'blurred-video'===this.adConfig.creative.portrait.mode&&0===this.adConfig.creative.portrait.width&&0===this.adConfig.creative.portrait.height&&(a=this.context.Environment.getVideoDimensions(),this.logger.log('VPAID - Enable automatic blurred background',a),['zoom','zoomToSticky'].includes(this.adConfig.display.effect)?
(this.adConfig.creative.portrait.width=a.mediaWidth*(this.context.Environment.isDeviceSmartphone?2:3),this.adConfig.creative.portrait.height=a.mediaHeight,this.adConfig.video.background.video.top=0,this.adConfig.video.background.video.left=(this.adConfig.creative.portrait.width-a.mediaWidth)/2):(['sitebar'].includes(this.adConfig.display.effect),this.adConfig.creative.portrait.width=a.mediaWidth,this.adConfig.creative.portrait.height=3*a.mediaHeight,this.adConfig.video.background.video.top=a.mediaHeight,
this.adConfig.video.background.video.left=0),this.context.adCore.onResize());break;case 'AdVideoFirstQuartile':this.emit({kind:'firstQuartile'});break;case 'AdVideoMidpoint':this.emit({kind:'midpoint'});break;case 'AdVideoThirdQuartile':this.emit({kind:'thirdQuartile'});break;case 'AdVideoComplete':this.isEnded=!0;this.emit({kind:'complete'});break;case 'AdPaused':this.emit({kind:'pause'});break;case 'AdPlaying':this.emit({kind:'resume'});break;case 'AdError':throw this.context.messageBus.event.emit({kind:'tracker',
event:'video-error',details:{errorCode:t.j,message:a.message}}),this.context.messageBus.event.emit({kind:'close',interactive:!1}),new t.k(t.j);case 'AdVolumeChange':this.emit({kind:a.muted?'mute':'unmute'});break;case 'AdClickThru':this.wasClicked?(this.logger.log('SKIP repeated CLICK on VPAID video creative'),this.wrapper.setAttribute(D.a.CLICK_SUCCESS,'click-repeated'),this.context.messageBus.event.emit({kind:'tracker',event:'click-repeated',details:{source:'video-vpaid'}})):(this.logger.log('Handle CLICK on VPAID video creative'),
this.wasClicked=!0,this.context.messageBus.event.emit({kind:'tracker',event:'click',details:{source:'video-vpaid'}}),!0===a.playerHandles&&a.url?(Object(C.a)(this.context,a.url),this.wrapper.setAttribute(D.a.CLICK_STATUS,D.b.FINISHED),this.wrapper.setAttribute(D.a.CLICK_SUCCESS,'click')):(this.wrapper.setAttribute(D.a.CLICK_STATUS,D.b.FINISHED),this.wrapper.setAttribute(D.a.CLICK_SUCCESS,'click-handled-by-ad')));break;case 'progressTime':this.processTimeEvent(a.currentTime,a.duration)}};this.onVideoSlotLoadedMetadata=
()=>{const {videoWidth:a,videoHeight:d,duration:b}=this.video;this.emit({kind:'actualVideoSizes',duration:b,width:a,height:d,source:'video-slot'});this.emit({kind:'audioAvailability',hasAudio:f(this.video)})};this.options=Object.assign({},y.a,b);const {context:c,adConfig:g,vpaidExecutableUrl:k,adParameters:q,width:n,height:l}=a;this.context=c;this.adConfig=g;this.width=n;this.height=l;this.logger=c.newLogger('VideoPlayerVPAID');this.wrapper=a=document.createElement('div');a.style.cursor='pointer';
a.style.position='relative';b=document.createElement('video');a.setAttribute(D.a.CLICK,D.b.ENABLED);a.setAttribute(D.a.CLICK_STATUS,D.b.WAITING);a.setAttribute(D.a.CLICK_GOAL,'click');this.video=b;b.muted=!0;b.preload='auto';b.style.pointerEvents='none';b.addEventListener('loadedmetadata',this.onVideoSlotLoadedMetadata,!1);'playsInline'in b&&(b.playsInline=!0);a.append(b);this.vpaidProcessor=a=new L(c,g,k,q,a,b,this.width,this.height,this);a.on(this.onVpaidProcessorEvent)}load(){this.logger.debug('load');
this.vpaidLoadPromise=this.vpaidProcessor.load();this.vpaidLoadPromise.then(()=>{this.vpaidLoadPromiseResolved=!0});return this.vpaidLoadPromise}processTimeEvent(a,b){if(!(a>b||0>=a||0>=b)){var {breakpointTrackingPercentage:c,breakpointTrackingTime:g}=this.options,f=this.previousVideoProgress,k=f/b,q=a/b,{Environment:n}=this.context;c.forEach(a=>{const d=a/100;k<=d&&d<q&&(this.logger.debug('progressPercentage',{previousPercentage:Object(A.a)(n,k),percentage:Object(A.a)(n,d),currentPercentage:Object(A.a)(n,
q)}),this.emit({kind:'progressPercentage',percentage:a}))});g.forEach(b=>{f<=b&&b<a&&(this.logger.debug('progressTime',{previousTime:Object(B.a)(n,f),time:Object(B.a)(n,b),currentTime:Object(B.a)(n,a)}),this.emit({kind:'progressTime',time:b}))});this.previousVideoProgress=a}}setDimensions(a){var {width:b,height:c,scaleFactor:g}=a;this.width=b;this.height=c;a=this.wrapper.style;a.width=`${b}px`;a.height=`${c}px`;a.transform=`scale(${g})`;a.transformOrigin='top left';this.vpaidLoadPromiseResolved?this.vpaidProcessor.setDimensions({width:b,
height:c}):this.vpaidLoadPromise&&this.vpaidLoadPromise.then(()=>{this.vpaidProcessor.setDimensions({width:b,height:c})})}appendTo(a){a.append(this.wrapper)}mute(){this.muted=!0;this.logger.debug('mute');this.vpaidProcessor.mute();this.video.muted=!0}unmute(){this.muted=!1;this.logger.debug('unmute');this.vpaidProcessor.unmute();this.video.muted=!1}play(){this.isEnded?this.logger.debug('play: video is ended'):(this.logger.debug('play'),this.vpaidProcessor.play())}pause(){this.logger.debug('pause');
this.vpaidProcessor.pause()}dispose(){this.logger.debug('dispose');this.vpaidProcessor.off(this.onVpaidProcessorEvent);this.vpaidProcessor.dispose();this.video.removeEventListener('loadedmetadata',this.onVideoSlotLoadedMetadata,!1)}}},function(m,c,a){a.d(c,'e',function(){return'inside'});a.d(c,'g',function(){return'outside'});a.d(c,'q',function(){return'top-left'});a.d(c,'r',function(){return'top-right'});a.d(c,'b',function(){return'bottom-left'});a.d(c,'c',function(){return'bottom-right'});a.d(c,
'a',function(){return'add-element'});a.d(c,'j',function(){return'remove-element'});a.d(c,'i',function(){return'refresh'});a.d(c,'f',function(){return'<script>window.mraid=window.parent.mraid;window.MRAID_ENV=window.parent.MRAID_ENV;\x3c/script>'});a.d(c,'o',function(){return h});a.d(c,'n',function(){return.7});a.d(c,'p',function(){return k});a.d(c,'s',function(){return r});a.d(c,'d',function(){return 500});a.d(c,'h',function(){return'https://a.yoc.com/assets/helper/pixel.png'});a.d(c,'t',function(){return'Video Auto-Start-Stop'});
a.d(c,'m',function(){return 72100});a.d(c,'l',function(){return 72200});a.d(c,'k',function(){return 72300});const h=['takeoverUnderstitialMiniAndSticky','takeoverInlineAndSticky'],k=['zoomToSticky'],r=['celtra-banner','celtra-interscroller','celtra-banner-sticky','celtra-interstitial']},function(m,c,a){function h(a,d,b){var c=a.options.adUnit;const g=a.options.deal,u=a.options.ioCreative;let I=d.mraid.mode;M=d.mraid.visxMediationSupport;try{const a=Object(ja.b)(c);a&&'mraid'in a&&('mode'in a.mraid&&
(I=a.mraid.mode),'visxMediationSupport'in a.mraid&&(M=!!a.mraid.visxMediationSupport))}catch(ka){}try{const a=Object(ja.b)(g);a&&'mraid'in a&&('mode'in a.mraid&&(I=a.mraid.mode),'visxMediationSupport'in a.mraid&&(M=!!a.mraid.visxMediationSupport))}catch(ka){}try{const a=Object(ja.b)(u);a&&a.mraid&&a.mraid.mode&&(I=a.mraid.mode)}catch(ka){}if('disabled'===I)b(void 0);else{if('app'!==a.meta.inventoryType&&(d='undefined'!==typeof MRAID_ENV,c='object'===typeof mraid&&null!==mraid,!('check-for-mraid3'!==
I&&'default-visx'!==I||d||c))){b(void 0);return}a.meta.io||'app'!==a.meta.inventoryType||T()||'number'===typeof window.__YOCMRAIDLoadCount||(window.__YOCMRAIDLoadCount=0);R=b;k()}}function k(){q(f,()=>{var a=document.documentElement.querySelector('script[src="mraid.js"]');const d=()=>{'loading'===mraid.getState()?mraid.addEventListener('ready',()=>{f()}):f()};if(a)if('undefined'!==typeof mraid)d();else try{a.addEventListener('load',d),a.addEventListener('error',r)}catch(ba){console&&console.error&&
console.error(ba)}else a=document.createElement('script'),a.src='mraid.js',a.addEventListener('load',d),a.addEventListener('error',r),document.head.append(a)},'checkForMraid2')}function r(){R(void 0)}function f(){q(n,r,'ignoreMraid2Check')}function q(a,d,b){if('undefined'===typeof mraid)d();else{if('checkForMraid2'===b)try{if(3>Number(mraid.getVersion())){d();return}}catch(na){}'loading'===mraid.getState()?mraid.addEventListener('ready',()=>{a()}):a()}}function n(){try{if(window&&'number'===typeof window.__YOCMRAIDLoadCount&&
window.__YOCMRAIDLoadCount++,!(window&&'number'===typeof window.__YOCMRAIDLoadCount&&1<window.__YOCMRAIDLoadCount)){ha=mraid.getPlacementType();{let a=!1;try{O()?a=Y():T()&&(mraid.getIsMediationAdView()?M&&(a=Y()):a=Y())}finally{try{mraid.useCustomClose(a)}catch(ma){}}mraid.addEventListener('sizeChange',la);fa=mraid.getVersion();R({version:fa,placement:mraid.getPlacementType(),screenSize:C(),isVisxSDK:T(),useCustomClose:a})}}}catch(N){console&&console.error&&console.error(N)}}function b(){if(mraid.getCurrentPosition){const {width:a,
height:d}=mraid.getCurrentPosition();if(0<a&&0<d)return{width:a,height:d}}else if(mraid.getSize){const {width:a,height:d}=mraid.getSize();if(0<a&&0<d)return{width:a,height:d}}}function C(){if(mraid.getScreenSize)return mraid.getScreenSize()}function y(){mraid.unload&&mraid.unload()}function A(a){mraid.open(a)}function B(){return mraid.isViewable()}function t(a){0===da.length&&mraid.addEventListener('viewableChange',x);da.push(a)}function l(a){da=da.filter(d=>d!==a);0===da.length&&mraid.removeEventListener('viewableChange',
x)}function x(a){da.forEach(d=>{'interstitial'===ha?d(a):d(!0)})}function S(a){0===aa.length&&mraid.addEventListener('exposureChange',D);aa.push(a)}function L(a){aa=aa.filter(d=>d!==a);0===aa.length&&mraid.removeEventListener('exposureChange',D)}function D(a){aa.forEach(d=>{d(a)})}function O(){try{return'Google Mobile Ads'===MRAID_ENV.sdk}catch(N){return!1}}function g(){try{if(T())return!0;if(O())return!1;if(3<=Number(MRAID_ENV.version))return!0}catch(N){}return!1}function w(){try{mraid.visxClosePlacement()}catch(N){}try{mraid.unload()}catch(N){}}
function P(){try{return mraid.getIsMediationAdView()}catch(N){return!1}}function T(){try{if(mraid.getExposureChangeAvailability&&mraid.getExposureChangeAvailability())return!0}catch(N){}return!1}function X(){try{return mraid.getMaxSize()}catch(N){}}function U(a,d){var {width:b,height:c}=d;if(T()&&(!mraid.getIsMediationAdView()||!1!==M))try{console.log(`calling visxSetPlacementEffect with ${a}`,b,c,b,c),mraid.visxSetPlacementEffect(a,b,c,b,c)}catch(ua){}}function Y(){return'interstitial'===ha?!1:!0}
function ca(a){if(mraid.visxShowAdvertisementMessageBelow)try{mraid.visxShowAdvertisementMessageBelow(a)}catch(ma){}}function Z(a,d){try{mraid.visxVideoFinished&&(a.visxNotifyAboutAudioStatusChange?(d.log('Audio status change (video finished) will be propagated ...'),mraid.visxVideoFinished()):d.warn('Audio status change (video finished) notification is DISABLED!'))}catch(ba){}}function d(a,d){try{mraid.visxVideoWasMuted&&(a.visxNotifyAboutAudioStatusChange?(d.log('Audio status change (video muted) will be propagated ...'),
mraid.visxVideoWasMuted()):d.warn('Audio status change (video muted) notification is DISABLED!'))}catch(ba){}}function u(a,d){try{mraid.visxVideoWasUnmuted&&(a.visxNotifyAboutAudioStatusChange?(d.log('Audio status change (video unmuted) will be propagated ...'),mraid.visxVideoWasUnmuted()):d.warn('Audio status change (video unmuted) notification is DISABLED!'))}catch(ba){}}function p(a,d){try{mraid.visxVideoWasCanceled&&(a.visxNotifyAboutAudioStatusChange?(d.log('Audio status change (video was cancelled) will be propagated ...'),
mraid.visxVideoWasCanceled()):d.warn('Audio status change (video was cancelled) notification is DISABLED!'))}catch(ba){}}function K(a){let d;try{d=3<=Number(mraid.getVersion())}catch(ba){}return!1===d?!0:O()&&!0===a.mraid.disableViewabilityTrackingWithGoogleMobileAdsSDK}function V(a){function d(b,c){({y:c}=c);0===b&&0>c&&(mraid.removeEventListener('exposureChange',d),a())}mraid.addEventListener('exposureChange',d)}function Q(a){Object(oa.g)(a,'body{height:9999px!important;background:rgba(0,0,0,0)!important}')}
function I(){try{mraid.addEventListener('visxOnScroll',(a,d,b,c)=>{b<a&&window.scrollTo(0,Math.ceil(b/5))}),mraid.visxEnableOnScrollEvent(),window.scrollTo(0,0)}catch(N){}}function ia(){return'function'===typeof mraid.visxEnableOnScrollEvent}function H(a){if('interstitial'!==ha)a();else if(mraid.isViewable())a();else{var d=function(){l(d);a()};t(d)}}function la(){window.dispatchEvent(new Event('resize'))}function pa(a,d,b,c,g){if('undefined'!==typeof mraid&&'undefined'!==typeof mraid.visxShowBrandedTakeoverSticky)try{mraid.visxShowBrandedTakeoverSticky(a,
d,b,c,g)}catch(va){}}function qa(a,d){if('undefined'!==typeof mraid&&'undefined'!==typeof mraid.visxHideBrandedTakeoverSticky)try{mraid.visxHideBrandedTakeoverSticky(a,d)}catch(ba){}}a.d(c,'a',function(){return h});a.d(c,'k',function(){return b});a.d(c,'j',function(){return C});a.d(c,'u',function(){return y});a.d(c,'p',function(){return A});a.d(c,'o',function(){return B});a.d(c,'g',function(){return t});a.d(c,'r',function(){return l});a.d(c,'f',function(){return S});a.d(c,'q',function(){return L});
a.d(c,'v',function(){return g});a.d(c,'h',function(){return w});a.d(c,'n',function(){return P});a.d(c,'i',function(){return X});a.d(c,'A',function(){return U});a.d(c,'s',function(){return ca});a.d(c,'w',function(){return Z});a.d(c,'x',function(){return d});a.d(c,'y',function(){return u});a.d(c,'z',function(){return p});a.d(c,'b',function(){return K});a.d(c,'l',function(){return V});a.d(c,'d',function(){return Q});a.d(c,'c',function(){return I});a.d(c,'e',function(){return ia});a.d(c,'B',function(){return H});
a.d(c,'t',function(){return pa});a.d(c,'m',function(){return qa});var ja=a(13),oa=a(1);let R,ha,fa,M,da=[],aa=[]},function(m,c,a){function h(a,c,f,k){return{event:a,type:'url',content:c,meta:f,isInvalidated:void 0===k?!1:k,created:Date.now(),lastUpdate:Date.now()}}function k(a,c,f,k){return{event:a,type:'script',content:c,meta:f,isInvalidated:void 0===k?!1:k,created:Date.now(),lastUpdate:Date.now()}}function r(a,c,f,k){return{event:a,type:'iframe',content:c,meta:f,isInvalidated:void 0===k?!1:k,created:Date.now(),
lastUpdate:Date.now()}}function f(a){return'url'===a.type&&void 0!==a.content&&''!==a.content}function q(a){return'script'===a.type&&void 0!==a.content&&''!==a.content}function n(a){return'iframe'===a.type&&void 0!==a.content&&''!==a.content}a.d(c,'f',function(){return h});a.d(c,'e',function(){return k});a.d(c,'d',function(){return r});a.d(c,'c',function(){return f});a.d(c,'b',function(){return q});a.d(c,'a',function(){return n})},function(m,c,a){function h(a,c){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!c||'object'!==typeof c&&'function'!==typeof c?a:c}function k(a,c){if('function'!==typeof c&&null!==c)throw new TypeError('Super expression must either be null or a function, not '+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}a.d(c,'a',function(){return 100});a.d(c,'b',function(){return 300});a.d(c,'c',function(){return 301});a.d(c,'d',function(){return 302});
a.d(c,'e',function(){return 303});a.d(c,'f',function(){return 400});a.d(c,'g',function(){return 401});a.d(c,'h',function(){return 405});a.d(c,'i',function(){return 900});a.d(c,'j',function(){return 901});a.d(c,'k',function(){return r});m=function(a){function c(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:'';if(!(this instanceof c))throw new TypeError('Cannot call a class as a function');var b=h(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,a));Object.defineProperty(b,'message',
{configurable:!0,enumerable:!1,value:a,writable:!0});Object.defineProperty(b,'name',{configurable:!0,enumerable:!1,value:b.constructor.name,writable:!0});if(Error.hasOwnProperty('captureStackTrace'))return Error.captureStackTrace(b,b.constructor),h(b);Object.defineProperty(b,'stack',{configurable:!0,enumerable:!1,value:Error(a).stack,writable:!0});return b}k(c,a);return c}(function(a){function c(){a.apply(this,arguments)}c.prototype=Object.create(a.prototype,{constructor:{value:a,enumerable:!1,writable:!0,
configurable:!0}});Object.setPrototypeOf?Object.setPrototypeOf(c,a):c.__proto__=a;return c}(Error));class r extends m{constructor(a,c){super(`VAST error ${a}`);this.$type='VASTError';this.code=a;c&&(this.cause=c)}}},function(m,c,a){function h(a,c){return'number'!==typeof c?(a.isLogMode&&console.error('NaN'),'NaN'):c.toFixed(2)+'s'}a.d(c,'a',function(){return h})},function(m,c,a){a.d(c,'a',function(){return h});class h{constructor(){this.listeners=[];this.listenersOncer=[];this.listenerOncerUnused=
[];this.on=a=>{this.listeners.push(a);return{dispose:()=>{this.off(a)}}};this.onEvent=(a,c)=>this.on(f=>{f.kind===a&&c(f)});this.once=a=>{this.listenersOncer.push(a)};this.onceEvent=(a,c)=>{const f=k=>{k.kind===a?c(k):this.listenerOncerUnused.push(f)};this.once(f)};this.off=a=>{a=this.listeners.indexOf(a);-1<a&&this.listeners.splice(a,1)};this.emit=a=>{this.listeners.forEach(c=>{c(a)});this.listenersOncer.forEach(c=>{c(a)});this.listenersOncer=this.listenerOncerUnused;this.listenerOncerUnused=[]};
this.pipe=a=>this.on(c=>a.emit(c))}}},function(m,c,a){a.d(c,'a',function(){return f});var h=a(1),k=a(2),r=a(26);class f{constructor(a,c,b,m,y){this.scaleButton=()=>{const {adConfig:a,context:{Environment:b}}=this;var {closeButton:{image:c}}=a,k=Object(r.a)(b,a);const n=Math.round(c.width*k);c=Math.round(c.height*k);({node:k}=f.image);k.width=n;k.height=c;this.root.style.width=`${n}px`;this.root.style.height=`${c}px`};this.adConfig=c;this.context=a;this.logger=a.newLogger('CloseAdButton');({Environment:a}=
a);const {closeButton:{delayDisplay:n=0,image:q,mode:t}}=c;({meta:{adSessionId:c}}=b);b=h.e(a,'div');b.id=`yoc_close_button${y?'_sticky':''}_${this.context.productTitlePostfix}_${c}`;f.image=new h.b(this.context,q.url);({node:c}=f.image);c.style.pointerEvents='none';y&&(c.style.transform=`scale(${k.n})`);c.style.transform='translate3d(0,0,0)';if(0<n||'on-viewability'===t)this.onDelayDisplay();b.append(c);b.style.cursor='pointer';b.style.userSelect='none';b.style.boxSizing='content-box';b.addEventListener('click',
m,!1);this.root=b;this.scaleButton();this.context.messageBus.event.onEvent('resize-buttons',this.scaleButton)}static preload(a,c){const b=new Image;b.style.width='0';b.style.height='0';b.style.position='absolute';const f=()=>{c.removeChild(b)};b.addEventListener('load',f,!1);b.addEventListener('error',f,!1);b.src=a.closeButton.image.url;c.append(b)}onDelayDisplay(){const {Environment:a}=this.context,{closeButton:{delayDisplay:c=0}}=this.adConfig;this.hide();this.logger.log('onDelayDisplay hide');
0<c&&(this.timeoutId=a.hostWindow.setTimeout(()=>{this.logger.log('onDelayDisplay show');f.show()},c))}hide(){if(f.image){const {node:a}=f.image;a.style.display='none'}}static show(){if(f.image){const {node:a}=f.image;a.style.display='block'}}}f.defaultPosition='top-right'},function(m,c,a){function h(a){return-1!==a.indexOf('.celtra.com')}a.d(c,'a',function(){return h})},function(m,c,a){function h(a,c){return'number'!==typeof c?(a.isLogMode&&console.error('NaN'),'NaN'):(100*c).toFixed(2)+'%'}a.d(c,
'a',function(){return h})},function(m,c,a){function h(a,c){var {Environment:f}=a;f.isMRAID?Object(r.p)(c):(f=k.e(f,'a'),f.target='_blank',f.href=c,k.f(f),a.rootContainer.append(f),f.click(),f.remove())}a.d(c,'a',function(){return h});var k=a(1),r=a(3)},function(m,c,a){function h(a){switch(a.readyState){case 0:return'HAVE_NOTHING';case 1:return'HAVE_METADATA';case 2:return'HAVE_CURRENT_DATA';case 3:return'HAVE_FUTURE_DATA';case 4:return'HAVE_ENOUGH_DATA';default:return`UNKNOWN_STATE_${a.readyState}`}}
function k(a,b,c){switch(b.kind){case 'creativeView':a.messageBus.event.emit({kind:'tracker',event:'video-creativeview'});break;case 'start':a.messageBus.event.emit({kind:'tracker',event:'video-start'});break;case 'complete':a.messageBus.event.emit({kind:'tracker',event:'video-complete'});break;case 'firstQuartile':a.messageBus.event.emit({kind:'tracker',event:'video-firstquartile'});break;case 'midpoint':a.messageBus.event.emit({kind:'tracker',event:'video-midpoint'});break;case 'thirdQuartile':a.messageBus.event.emit({kind:'tracker',
event:'video-thirdquartile'});break;case 'mute':a.messageBus.event.emit({kind:'tracker',event:'video-mute'});break;case 'unmute':a.messageBus.event.emit({kind:'tracker',event:'video-unmute'});break;case 'skip':c();break;case 'progressPercentage':a.messageBus.event.emit({kind:'tracker',event:'video-progress',meta:{type:'relative',offset:b.percentage},details:{progress:Object(r.a)(a.Environment,b.percentage/100)}});break;case 'progressTime':a.messageBus.event.emit({kind:'tracker',event:'video-progress',
meta:{type:'absolute',offset:b.time},details:{progress:Object(f.a)(a.Environment,b.time)}});break;case 'impression':a.messageBus.event.emit({kind:'vpaid-impression'})}}a.d(c,'a',function(){return q});a.d(c,'b',function(){return h});a.d(c,'c',function(){return k});a(7);var r=a(10),f=a(6);const q={maintainAspectRatio:!0,breakpointTrackingTime:[],breakpointTrackingPercentage:[]}},function(m,c,a){function h(a,c){let b;try{b=JSON.parse(a)}catch(C){c&&c.warn('bad json',{source:a})}return b}function k(a,
c,b,k,y,m){y=void 0===y?!1:y;if(''!==k){var n=h(k,c);n&&(c.debug(`mergeOptions (${m})`,{custom:JSON.stringify(n,null,2)}),r(c,b,n),Object.keys(n).forEach(k=>{if('string'===typeof n[k]){const l=n[k];switch(k.toLowerCase()){case 'video-overlay-position':switch(l){case 'topleft':b.video.branding.position='top-left';break;case 'topright':b.video.branding.position='top-right';break;case 'bottomleft':b.video.branding.position='bottom-left';break;case 'bottomright':b.video.branding.position='bottom-right'}break;
case 'video-overlay-url':b.video.branding.mode='static-image';b.video.branding.url=l;break;case 'video-overlay-width':b.video.branding.width=l;break;case 'video-overlay-height':b.video.branding.height=l;break;case 'post-ad-image':b.video.reminderBanner.mode='static-image';b.video.reminderBanner.url=l;break;case 'advertisement-message-text-top':b.advertisementMessage.contentAbove=l;break;case 'advertisement-message-text-bottom':b.advertisementMessage.contentBelow=l;break;case 'scale-to-fit-maximum-width':'scale'===
b.display.responsive.mode&&(b.display.responsive.maximumWidth=l);break;case 'scale-to-fit-maximum-height':'scale'===b.display.responsive.mode&&(b.display.responsive.maximumHeight=l);break;case 'background-image':b.creative.portrait.mode='static-image';b.creative.portrait.imageUrl=l;break;case 'background-width':b.creative.portrait.mode='static-image';b.creative.portrait.width=l;break;case 'background-height':b.creative.portrait.mode='static-image';b.creative.portrait.height=l;break;case 'video-top':'undefined'===
typeof b.video.background.video&&(b.video.background.video={});b.video.background.video.top=l;break;case 'video-left':'undefined'===typeof b.video.background.video&&(b.video.background.video={});b.video.background.video.left=l;break;case 'icon-close':b.closeButton.mode='enabled';b.closeButton.image={url:l,width:30,height:30};break;case 'button-close-show':case 'sticky-button-close-show':f(l)?(b.closeButton.mode='enabled',b.closeButton.image={url:'//a.yoc.com/assets/icons/28x28/icon_grey_close_01.svg',
width:30,height:30}):b.closeButton.mode='disabled';break;case 'button-close-position':b.closeButton.mode='enabled';switch(l){case 'topleft':b.closeButton.position='top-left';break;case 'topright':b.closeButton.position='top-right'}break;case 'skip-in-seconds':b.video.skip.mode='enabled-override-vast';b.video.skip.skipSeconds=l;break;case 'skip-position':switch(l){case 'topleft':b.video.skip.button.position='top-left';break;case 'topright':b.video.skip.button.position='top-right'}break;case 'display-effect':'fullscreen-overlay'!==
a.layout&&'third-party-ad'!==a.product.key&&'universal-ad-format'!==a.product.key&&'yoc-sitebar'!==a.product.key&&('string'===typeof l&&'sticky'===l.toLowerCase()?b.display.effect='sticky':'string'===typeof l&&'inline-to-sticky'===l.toLowerCase()?b.display.effect='inlineToSticky':'string'===typeof l&&'mini'===l.toLowerCase()?b.display.effect='understitialMini':'string'===typeof l&&'s'===l.toLowerCase()?b.display.effect='understitialSizeSmall':'string'===typeof l&&'m'===l.toLowerCase()?b.display.effect=
'understitialSizeMedium':'string'===typeof l&&'xl'===l.toLowerCase()?b.display.effect='understitialSizeLarge':b.display.effect='none');break;case 'auto-stopp':b.video.autoStop=f(l);break;case 'overwrite-mrc-settings':break;case 'user-viewability-area':b.tracking.viewabilityPercent=l;break;case 'user-viewability-time':b.tracking.viewabilityTime=parseInt((1E3*parseFloat(l)).toString(),10);break;case 'vcpm':case 'cpv':b.tracking.vCPMEnabled=f(l);break;case 'count-impression-on':if(y)switch(l){case 'creativeview':b.tracking.countImpressionOn=
'video-creativeview';b.tracking.countVPAIDImpressionOn='video-creativeview';break;case 'start':b.tracking.countImpressionOn='video-start';b.tracking.countVPAIDImpressionOn='shown';break;case 'viewable_ad_impression':b.tracking.countImpressionOn='viewability';b.tracking.countVPAIDImpressionOn='viewability';break;case 'firstquartile':b.tracking.countImpressionOn='video-firstquartile';b.tracking.countVPAIDImpressionOn='video-firstquartile';break;case 'midpoint':b.tracking.countImpressionOn='video-midpoint';
b.tracking.countVPAIDImpressionOn='video-midpoint';break;case 'thirdquartile':b.tracking.countImpressionOn='video-thirdquartile';b.tracking.countVPAIDImpressionOn='video-thirdquartile';break;case 'complete':b.tracking.countImpressionOn='video-complete';b.tracking.countVPAIDImpressionOn='video-complete';break;case 'button-close':b.tracking.countImpressionOn='close';b.tracking.countVPAIDImpressionOn='close';break;case 'unmute':b.tracking.countImpressionOn='video-unmute';b.tracking.countVPAIDImpressionOn=
'video-unmute';break;case 'mute':b.tracking.countImpressionOn='video-mute';b.tracking.countVPAIDImpressionOn='video-mute';break;default:b.tracking.countImpressionOn=l,b.tracking.countVPAIDImpressionOn=l}else c.warn("Skip custom option because it's not a video ad",{customOptionKey:k,customOptionValue:l});break;case 'count-creativeview-on':if(y)switch(l){case 'creativeview':b.tracking.countVideoCreativeviewOn='video-creativeview';b.tracking.countVPAIDVideoCreativeviewOn='video-creativeview';break;case 'start':b.tracking.countVideoCreativeviewOn=
'video-start';b.tracking.countVPAIDVideoCreativeviewOn='shown';break;case 'viewable_ad_impression':b.tracking.countVideoCreativeviewOn='viewability';b.tracking.countVPAIDVideoCreativeviewOn='viewability';break;case 'firstquartile':b.tracking.countVideoCreativeviewOn='video-firstquartile';b.tracking.countVPAIDVideoCreativeviewOn='video-firstquartile';break;case 'midpoint':b.tracking.countVideoCreativeviewOn='video-midpoint';b.tracking.countVPAIDVideoCreativeviewOn='video-midpoint';break;case 'thirdquartile':b.tracking.countVideoCreativeviewOn=
'video-thirdquartile';b.tracking.countVPAIDVideoCreativeviewOn='video-thirdquartile';break;case 'complete':b.tracking.countVideoCreativeviewOn='video-complete';b.tracking.countVPAIDVideoCreativeviewOn='video-complete';break;case 'button-close':b.tracking.countVideoCreativeviewOn='close';b.tracking.countVPAIDVideoCreativeviewOn='close';break;case 'unmute':b.tracking.countVideoCreativeviewOn='video-unmute';b.tracking.countVPAIDVideoCreativeviewOn='video-unmute';break;case 'mute':b.tracking.countVideoCreativeviewOn=
'video-mute';b.tracking.countVPAIDVideoCreativeviewOn='video-mute';break;default:b.tracking.countVideoCreativeviewOn=l,b.tracking.countVPAIDVideoCreativeviewOn=l}else c.warn("Skip custom option because it's not a video ad",{customOptionKey:k,customOptionValue:l});break;case 'vast-mediafile-priority-1':case 'vast-mediafile-priority-2':case 'vast-mediafile-priority-3':case 'vast-mediafile-priority-4':case 'vast-mediafile-priority-5':case 'vast-mediafile-priority-6':case 'vast-mediafile-priority-7':case 'vast-mediafile-priority-8':break;
case 'enable-indapif':b.display.useFriendlyIframe=f(l);break;case 'use-creative-wrapper-ge':b.creativeWrapper.ge=f(l)?'enabled':'disabled';break;case 'use-gpt-passback-tag':case 'metrics-tracker-visx-enabled':break;default:c.warn('Unknown custom option',{customOptionKey:k,customOptionValue:l})}}else if('object'===typeof n[k]){const a=n[k];Object.keys(a).forEach(c=>{if('string'===typeof a[c]){const f=a[c];switch(`${k.toLowerCase()}.${c.toLowerCase()}`){case 'thirdparty.source':b.thirdParty.creativeSource.portrait=
f;b.thirdParty.creativeSource.landscape=f;break;case 'tracking.trackingurllist':b.tracking.trackingUrlList=f}}})}}))}}function r(a,c,b,k){k=void 0===k?[]:k;Object.keys(b).forEach(n=>{var h=c[n],q=b[n];var m=k.join('.')+'.'+n;if(void 0===h)'object'!==typeof q||null===q||Array.isArray(q)?(q=Number(q).toString()===q?Number(q):q,c[n]=q,a.debug(`updated ${m}`,{before:h,value:q})):(h={},c[n]=h,r(a,h,q,[...k,n]));else if('number'===typeof h)if('number'===typeof q)c[n]=q,a.debug(`updated ${m}`,{before:h,
value:q});else{if('string'===typeof q){const b=Number(q);b===b?(c[n]=b,a.debug(`updated ${m}`,{before:h,value:b})):a.warn(`cannot merge ${m}`,{original:h,custom:q})}}else'boolean'===typeof h?'boolean'===typeof q||'injectInsideIframe'===n?(c[n]=q,a.debug(`updated ${m}`,{before:h,value:q})):'string'===typeof q&&(q=f(q),c[n]=q,a.debug(`updated ${m}`,{before:h,value:q})):'string'===typeof h&&'string'===typeof q?(c[n]=q,a.debug(`updated ${m}`,{before:h,value:q})):'object'===typeof h&&null!==h&&'object'===
typeof q&&null!==q?Array.isArray(h)&&Array.isArray(q)?(q=h.concat(q),a.debug(`updated ${m}`,{before:JSON.stringify(h,null,2),value:JSON.stringify(q,null,2)}),c[n]=q):Array.isArray(h)||Array.isArray(q)?a.warn(`cannot merge ${m}`,{original:h,custom:q}):r(a,h,q,[...k,n]):a.warn(`cannot merge ${m}`,{original:h,custom:q})})}function f(a){return!0===a||'string'===typeof a&&-1!==['1','true','yes'].indexOf(a.toLowerCase())?!0:!1}a.d(c,'b',function(){return h});a.d(c,'a',function(){return k})},function(m,
c,a){function h(a){return 0===a&&0<1/a}a.d(c,'a',function(){return h})},function(m,c,a){function h(a,c){const {deliveredBy:f}=a.initConfig.meta,k=a.Environment.hostDocument.createElement('div');k.id=`yoc_tracking_container_moat_${a.productTitlePostfix}_${a.initConfig.meta.adSessionId}`;if('gam'===f||'visx'===f&&a.initConfig.meta.io){var n=a.Environment.hostDocument.createElement('noscript');n.className=('gam'===f?'MOAT-yocdfp723917473106?':'visx'===f&&a.initConfig.meta.io?'MOAT-yocsspdisplay921031003724?':
'')+`moatClientLevel1=${a.initConfig.meta.advertiserId}`+`&moatClientLevel2=${a.initConfig.meta.orderId}`+`&moatClientLevel3=${a.initConfig.meta.lineItemId}`+`&moatClientLevel4=${a.initConfig.meta.creativeId}`+`&moatClientSlicer1=${a.initConfig.meta.siteId}`+`&moatClientSlicer2=${a.initConfig.meta.adUnitId}`;k.appendChild(n);n=a.Environment.hostDocument.createElement('script');const b=('gam'===f?'https://z.moatads.com/yocdfp723917473106/moatad.js#':'visx'===f&&a.initConfig.meta.io?'https://z.moatads.com/yocsspdisplay921031003724/moatad.js#':
'')+`moatClientLevel1=${a.initConfig.meta.advertiserId}`+`&moatClientLevel2=${a.initConfig.meta.orderId}`+`&moatClientLevel3=${a.initConfig.meta.lineItemId}`+`&moatClientLevel4=${a.initConfig.meta.creativeId}`+`&moatClientSlicer1=${a.initConfig.meta.siteId}`+`&moatClientSlicer2=${a.initConfig.meta.adUnitId}`;n.type='text/javascript';n.src=b;k.appendChild(n);c.log(`Adding Moat tag for '${f}' IO: '${a.initConfig.meta.io?'TRUE':'FALSE'}'`,k.innerHTML);a.messageBus.event.emit({kind:'tracker',event:'moat'})}else c.warn(`Adding Moat tag FAILED for '${f}' IO: '${a.initConfig.meta.io?
'TRUE':'FALSE'}'`),a.messageBus.event.emit({kind:'tracker',event:'moat-error'});return k}a.d(c,'a',function(){return h})},function(m,c,a){function h(){let a=window,c=document;for(;a!==window.top;)try{a.parent.document&&a.parent.document.body&&(c=a.parent.document,a=a.parent)}catch(f){break}return{wnd:a,doc:c}}a.d(c,'a',function(){return h})},function(m,c,a){a.d(c,'a',function(){return'985203020bbafe65799be6543d0498ad44a5432b'});a.d(c,'b',function(){return'2023-03-27T08-00-48-813Z'})},function(m,c,
a){function h(a,b,c){return Math.max(Math.min((c-a)/(b-a),1),0)}function k(a){let d=a;try{X.test(a)||(d=decodeURIComponent(a))}catch(p){}return d}a.d(c,'a',function(){return Z});var r=a(1),f=a(0),q=a(11),n=a(25),b=a(9);class C{constructor(a,b,c,g,f,Q,I,k){this.creativeIframe=this.adContainer=this.adCore=null;this.intervalStart=this.intervalId=-1;this.thirdPartyClickContainer=this.thirdPartyAdContainer=this.thirdPartyHostContainer=null;this.foundDuringPreCheck=!1;this.demoContainer=null;this.isCheckModeStrict=
this.isCheckModeEasy=!1;this.searchForNodeResult=null;this.wasClicked=this.isRunning=!1;this.context=a;this.logger=a.newLogger(`ThirdPartyAd (${Q})`);this.initConfig=b;this.adConfig=c;this.adCore=g;this.adPainter=f;this.creativeOption=Q;this.configCreative=I;this.creativeDetails=k;'undefined'!==typeof this.adConfig.thirdParty&&'undefined'!==typeof this.adConfig.thirdParty.checkMode&&'easy'===this.adConfig.thirdParty.checkMode?this.isCheckModeEasy=!0:'undefined'!==typeof this.adConfig.thirdParty&&
'undefined'!==typeof this.adConfig.thirdParty.checkMode&&'strict'===this.adConfig.thirdParty.checkMode&&(this.isCheckModeStrict=!0)}preCheck(){this.logger.log(`Pre-check ${this.creativeOption} creative`,{configCreative:this.configCreative});if('string'===typeof this.configCreative.mode&&'disabled'===this.configCreative.mode)'undefined'===typeof this.adConfig.thirdParty.creativeSource[this.creativeOption]||'string'===typeof this.adConfig.thirdParty.creativeSource[this.creativeOption]&&'auto'===this.adConfig.thirdParty.creativeSource[this.creativeOption]?
(this.logger.log("Pre-check: Disable third party creative source, because it's disabled",{configCreative:this.configCreative}),this.adConfig.thirdParty.creativeSource[this.creativeOption]='disabled'):this.logger.log("Pre-check: Nothing to do - it's disabled",{configCreative:this.configCreative});else if('string'===typeof this.configCreative.mode&&0<this.configCreative.mode.length&&'redirect'===this.configCreative.mode.substr(0,8)){try{let a='',c=!1;if('redirect'===this.configCreative.mode||'redirect-load-rtb-hidden'===
this.configCreative.mode){const d=decodeURIComponent(this.configCreative.redirectCode);this.context.Environment.isPreviewMode&&Object(b.a)(d)&&(this.configCreative.redirectCode=encodeURIComponent(d.replace(/web.js/g,'preview.js')),c=!0);a=decodeURIComponent(this.configCreative.redirectCode)}const g=decodeURIComponent(this.initConfig.creativeCode);this.context.Environment.isPreviewMode&&(Object(b.a)(g)&&(this.initConfig.creativeCode=encodeURIComponent(g.replace(/web.js/g,'preview.js')),c=!0),c&&this.context.Environment.hostWindow.addEventListener('message',
a=>{if('data'in a&&(a=a.data,'object'===typeof a&&null!==a&&'name'in a&&'url'in a)){const {name:d,url:b}=a;'openBrowser'===d&&window.open(String(b),'_blank')}},!1));('undefined'===typeof this.adConfig.thirdParty.creativeSource[this.creativeOption]||'string'===typeof this.adConfig.thirdParty.creativeSource[this.creativeOption]&&'auto'===this.adConfig.thirdParty.creativeSource[this.creativeOption])&&('string'===typeof a&&Object(b.a)(a)||'string'===typeof g&&Object(b.a)(g))?(this.fixDisplayInjectInsideIframe(),
-1!==this.initConfig.product.templateName.toLowerCase().indexOf('mystery scroller')&&(this.logger.log("Pre-check: Celtra + Mystery Scroller template identified - set third party source to 'celtra-banner-sticky'"),this.adConfig.thirdParty.creativeSource[this.creativeOption]='celtra-banner-sticky'),-1!==this.initConfig.product.templateName.toLowerCase().indexOf('understitial')&&(this.logger.log("Pre-check: Celtra + Understitial Ad template identified - set third party source to 'celtra-interscroller'"),
this.adConfig.thirdParty.creativeSource[this.creativeOption]='celtra-interscroller'),-1!==this.initConfig.product.templateName.toLowerCase().indexOf('mystery ad')&&(this.logger.log("Pre-check: Celtra + Mystery Ad template identified - set third party source to 'celtra-interstitial'"),this.adConfig.thirdParty.creativeSource[this.creativeOption]='celtra-interstitial'),-1!==this.initConfig.product.templateName.toLowerCase().indexOf('banner classic')&&(this.logger.log("Pre-check: Celtra + Banner Classic template identified - set third party source to 'default'"),
this.adConfig.thirdParty.creativeSource[this.creativeOption]='default')):'disabled'!==this.adConfig.thirdParty.creativeSource[this.creativeOption]&&'auto'!==this.adConfig.thirdParty.creativeSource[this.creativeOption]&&'default'!==this.adConfig.thirdParty.creativeSource[this.creativeOption]&&'unknown'!==this.adConfig.thirdParty.creativeSource[this.creativeOption]?this.logger.log(`Pre-check: Ignore further checks because third party source is '${this.adConfig.thirdParty.creativeSource[this.creativeOption]}'`):
(-1!==this.initConfig.product.templateName.toLowerCase().indexOf('mystery scroller')&&(this.logger.log("Pre-check: Unknown ad vendor + Mystery Scroller template identified - set third party source to 'unknown'"),this.adConfig.thirdParty.creativeSource[this.creativeOption]='unknown'),-1!==this.initConfig.product.templateName.toLowerCase().indexOf('understitial')&&(this.logger.log("Pre-check: Unknown ad vendor + Understitial Ad template identified - set third party source to 'unknown'"),this.adConfig.thirdParty.creativeSource[this.creativeOption]=
'unknown'),-1!==this.initConfig.product.templateName.toLowerCase().indexOf('mystery ad')&&(this.logger.log("Pre-check: Unknown ad vendor + Mystery Ad template identified - set third party source to 'unknown'"),this.adConfig.thirdParty.creativeSource[this.creativeOption]='unknown'),-1!==this.initConfig.product.templateName.toLowerCase().indexOf('banner classic')&&(this.logger.log("Pre-check: Unknown ad vendor + Banner Classic template identified - set third party source to 'default'"),this.adConfig.thirdParty.creativeSource[this.creativeOption]=
'default'))}catch(d){this.logger.error(d)}!this.context.Environment.isVCPM||'undefined'!==typeof this.adConfig.thirdParty.creativeSource[this.creativeOption]&&('string'!==typeof this.adConfig.thirdParty.creativeSource[this.creativeOption]||0!==this.adConfig.thirdParty.creativeSource[this.creativeOption].length&&'auto'!==this.adConfig.thirdParty.creativeSource[this.creativeOption])||(this.logger.log("Pre-check: vCPM is enabled and no third party source was provided, set third party source to 'default'"),
this.adConfig.thirdParty.creativeSource[this.creativeOption]='default');if('portrait'===this.creativeOption||'landscape'===this.creativeOption)'celtra-interscroller'===this.adConfig.thirdParty.creativeSource[this.creativeOption]&&'scale'===this.adConfig.display.responsive.mode&&!1===this.adConfig.display.responsive.followLayout&&(this.logger.log("Pre-check: third party source for portrait/landscape is 'celtra-interscroller', reset scale mode and set followLayout to 'true'"),this.adConfig.display.responsive.followLayout=
!0,this.adConfig.display.responsive.mode='none'),'celtra-interstitial'===this.adConfig.thirdParty.creativeSource[this.creativeOption]&&'scale'===this.adConfig.display.responsive.mode&&!1===this.adConfig.display.responsive.followLayout&&(this.logger.log("Pre-check: third party source for portrait/landscape is 'celtra-interstitial', reset scale mode and set followLayout to 'true'"),this.adConfig.display.responsive.followLayout=!0,this.adConfig.display.responsive.mode='none'),'celtra-banner-sticky'===
this.adConfig.thirdParty.creativeSource[this.creativeOption]&&'scale'===this.adConfig.display.responsive.mode&&!1===this.adConfig.display.responsive.followLayout&&(this.logger.log("Pre-check: third party source for portrait/landscape is 'celtra-banner-sticky', reset scale mode and set followLayout to 'true'"),this.adConfig.display.responsive.followLayout=!0,this.adConfig.display.responsive.mode='none');switch(this.adConfig.thirdParty.creativeSource[this.creativeOption]){case 'unknown':this.logger.log("Pre-check: Check environment - nothing to do - it's unknown");
break;case 'disabled':this.logger.log("Pre-check: Check environment - nothing to do - it's disabled");break;case 'default':this.logger.log("Pre-check: Check environment - 'Default' (delivered inside the product container)");break;case 'celtra-banner':this.logger.log("Pre-check: Check environment - 'Celtra Banner'");break;case 'celtra-banner-sticky':this.logger.log("Pre-check: Check environment - 'Celtra Banner Sticky'");if('portrait'===this.creativeOption||'landscape'===this.creativeOption)this.logger.log("Pre-check: Check environment - 'Celtra Banner Sticky' - Force ad container hiding"),
this.adConfig.display.hide=!0;break;case 'celtra-interscroller':this.logger.log("Pre-check: Check environment - 'Celtra Interscroller'");break;case 'celtra-interstitial':this.logger.log("Pre-check: Check environment - 'Celtra Interstitial'");if('portrait'===this.creativeOption||'landscape'===this.creativeOption)this.logger.log("Pre-check: Check environment - 'Celtra Interstitial' - Force ad container hiding"),this.adConfig.display.hide=!0;break;default:this.logger.warn(`Pre-check: Check environment - invalid third party source: '${this.adConfig.thirdParty.creativeSource[this.creativeOption]}'`),
this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-error-source`})}}else this.logger.log(`Pre-check: Invalid creative mode used for third party ad in ${this.creativeOption} creative`,{configCreative:this.configCreative});this.foundDuringPreCheck&&this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-error-precheck`})}init(){const {Environment:a}=this.context;this.logger.log(`Initialize ${this.creativeOption} creative`,{configCreative:this.configCreative});
if('string'===typeof this.configCreative.mode&&0<this.configCreative.mode.length&&'redirect'===this.configCreative.mode.substr(0,8))switch(this.adConfig.thirdParty.creativeSource[this.creativeOption]){case 'unknown':this.logger.log("Prepare environment - nothing to do - it's unknown");break;case 'disabled':this.logger.log("Prepare environment - nothing to do - it's disabled");break;case 'default':this.logger.log("Prepare environment - 'Default' (delivered inside the product container)");break;case 'celtra-banner':this.logger.log("Prepare environment - 'Celtra Banner'");
break;case 'celtra-banner-sticky':this.logger.log("Prepare environment - 'Celtra Banner Sticky'");this.context.Environment.isPreviewMode?this.startCheckCeltraStickyInPreviewMode(!0):this.startCheckCeltraOverlay(!0);break;case 'celtra-interscroller':this.logger.log("Prepare environment - 'Celtra Interscroller'");break;case 'celtra-interstitial':this.logger.log("Prepare environment - 'Celtra Interstitial'");this.startCheckCeltraOverlay(!0);break;default:this.logger.warn(`Prepare environment - invalid third party source: '${this.adConfig.thirdParty.creativeSource[this.creativeOption]}'`)}else this.logger.log(`Invalid creative mode used for third party ad in ${this.creativeOption} creative`,
{configCreative:this.configCreative});a.isDemoMode&&(this.demoContainer=a.hostDocument.createElement('div'),this.demoContainer.id=`yoc_demo_container_${this.creativeOption}_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`,this.demoContainer.style.cssText='position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; z-index: 2147483647; background-color: rgba(127, 0, 0, 0.3);')}run(a){if(!this.isRunning)switch(this.isRunning=!0,this.creativeIframe=a,this.adConfig.thirdParty.creativeSource[this.creativeOption]){case 'unknown':this.logger.log('Run - nothing to do - creative source is unknown');
break;case 'celtra-banner-sticky':this.context.Environment.isPreviewMode?this.startCheck(this.startCheckCeltraStickyInPreviewMode.bind(this)):this.startCheck(this.startCheckCeltraOverlay.bind(this));break;case 'celtra-interstitial':this.startCheck(this.startCheckCeltraOverlay.bind(this));break;case 'celtra-interscroller':this.startCheck(this.startCheckCeltraInline.bind(this));break;default:({Environment:a}=this.context),'sticky'===this.creativeOption&&a.isBrandedTakeoverSticky?({productStickyContainer:a}=
this.context,this.thirdPartyClickContainer=this.thirdPartyAdContainer=this.thirdPartyHostContainer=a):(this.thirdPartyClickContainer=this.thirdPartyAdContainer=this.thirdPartyHostContainer=this.adCore.outerContainerForTracking,this.enableTracking(this.thirdPartyHostContainer,this.thirdPartyAdContainer,this.thirdPartyClickContainer))}}startCheckCeltraOverlay(a){a=void 0===a?!1:a;const {display:{injectInsideIframe:d}}=this.adConfig,{Environment:b}=this.context,c=d&&this.creativeIframe?this.creativeIframe.contentWindow:
b.hostWindow;let g=!1,f=null;this.logger.log(`${a?'PRE-Check ':''}${this.isCheckModeStrict?'STRICT ':''}Try to find third party ad OVERLAY container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`);this.adConfig.display.injectInsideIframe?(this.logger.log('Creative was injected inside an IFRAME ...'),this.context.Environment.hostDocument.querySelectorAll('div > iframe:first-child[allowfullscreen]').forEach(d=>{this.logger.log(`Found element - start checking (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,
{parentElementStyle:d.parentElement&&d.parentElement.style?d.parentElement.style:'unknown'});if(d.parentElement&&d.parentElement.style&&'string'===typeof d.parentElement.style.position&&('fixed'===d.parentElement.style.position||'absolute'===d.parentElement.style.position)&&'undefined'!==typeof d.parentElement.style.zIndex&&2E9<parseInt(d.parentElement.style.zIndex,10))if(a)this.foundDuringPreCheck=!0,this.logger.warn(`PRE-Check - Found third party ad container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,
d.parentElement);else if(this.thirdPartyAdContainer)this.logger.error('Third party ad container was found already',this.thirdPartyAdContainer);else{'iframe'===d.nodeName.toLocaleLowerCase()&&d.contentDocument&&(f=d.contentDocument.getElementById('viewport'));const a=c&&'undefined'!==typeof c.celtra&&'object'===typeof c.celtra.payloads;try{this.logger.log(`Checking Celtra viewport (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,{celtraViewportStyle:f?f.getAttribute('style'):'unknown'});
const b=a?Object.keys(c.celtra.payloads)[0]:'unknown';this.logger.log(`Checking Celtra payloads (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,{celtraPayloads:b});this.logger.log(`Checking Celtra urls (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,{celtraUrlsCreativeUrl:d.contentWindow&&'undefined'!==typeof d.contentWindow.urls&&'undefined'!==typeof d.contentWindow.urls.creativeUrl?d.contentWindow.urls.creativeUrl:'unknown'})}catch(H){this.logger.error(H)}if(this.isCheckModeStrict&&
f&&a&&d.contentWindow&&'undefined'!==typeof d.contentWindow.urls&&'undefined'!==typeof d.contentWindow.urls.creativeUrl)try{if(this.logger.log('STRICT - TRY to find third party ad container check based on Celtra ID',d.parentElement),a){const a=d.contentWindow.urls.creativeUrl.match(/https:\/\/ads.celtra.com\/compiled\/([0-9a-zA-Z]+)\//)[1];Object.keys(c.celtra.payloads).forEach(b=>{this.logger.log(`STRICT - CHECK payloads entry key: '${b}'`,d.parentElement);b=b.match(/https:\/\/cache-ssl.celtra.com\/api\/creatives\/([0-9a-zA-Z]+)\//)[1];
this.logger.log(`STRICT - CHECK third party ad container check based on Celtra ID: '${b}' <> '${a}'`,d.parentElement);'string'===typeof b&&0<b.length&&'string'===typeof a&&0<a.length&&b===a&&(g=!0,this.logger.log(`STRICT - FOUND third party ad container based on Celtra ID: '${b}' <> '${a}'`,d.parentElement))})}}catch(H){this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-error-ad-container`}),this.logger.error(H)}f&&(!this.isCheckModeStrict||this.isCheckModeStrict&&
g)&&(this.logger.log(`Found third party ad container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,f),this.thirdPartyHostContainer=d.parentElement,this.thirdPartyAdContainer=f)}})):(this.logger.log('Creative was injected inside a DIV ...'),this.context.Environment.hostDocument.querySelectorAll('div[id="viewport"][style*="position: absolute"][style*="top: 0px"][style*="left: 0px"][style*="width: 100%"][style*="height: 100%"]').forEach(d=>{this.logger.log(`Found element - start checking (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`);
if(d.firstChild&&d.firstChild.style&&'string'===typeof d.firstChild.style.position&&('fixed'===d.firstChild.style.position||'absolute'===d.firstChild.style.position)&&'undefined'!==typeof d.firstChild.style.zIndex&&2E9<parseInt(d.firstChild.style.zIndex,10))if(a)this.foundDuringPreCheck=!0,this.logger.warn(`PRE-Check - Found third party ad container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,d.firstChild);else if(this.thirdPartyAdContainer)this.logger.error('Third party ad container was found already',
this.thirdPartyAdContainer);else{f=d;const a=c&&'undefined'!==typeof c.celtra&&'object'===typeof c.celtra.payloads;try{this.logger.log(`Checking Celtra viewport (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,{celtraViewportStyle:f?f.getAttribute('style'):'unknown'});const d=a?Object.keys(c.celtra.payloads)[0]:'unknown';this.logger.log(`Checking Celtra payloads (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,{celtraPayloads:d})}catch(H){this.logger.error(H)}if(this.isCheckModeStrict&&
f&&a)try{this.logger.log('STRICT - TRY to find third party ad container check based on Celtra ID',d.parentElement),a&&Object.keys(c.celtra.payloads).forEach(a=>{this.logger.log(`STRICT - CHECK payloads entry key: '${a}'`,d.parentElement);a=a.match(/https:\/\/cache-ssl.celtra.com\/api\/creatives\/([0-9a-zA-Z]+)\//)[1];g=!0;this.logger.log(`STRICT - FOUND third party ad container with Celtra ID: '${a}''`,d.parentElement)})}catch(H){this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-error-ad-container`}),
this.logger.error(H)}f&&(!this.isCheckModeStrict||this.isCheckModeStrict&&g)&&(this.logger.log(`Found third party ad container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,f),this.thirdPartyHostContainer=d.firstChild,this.thirdPartyAdContainer=f)}}));if(f&&(!this.isCheckModeStrict||this.isCheckModeStrict&&g)&&this.thirdPartyHostContainer&&this.thirdPartyAdContainer){this.logger.log(`Enable third party ad tracking (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,
f);this.stopCheck();this.startCheckCeltraClickContainer();this.enableTracking(this.thirdPartyHostContainer,this.thirdPartyAdContainer,this.thirdPartyClickContainer);try{const a=Date.now()-this.intervalStart;this.logger.log(`Third party ad container was found (${a/1E3}s)`);this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-found`,details:{msSinceStart:a}})}catch(I){}}this.validateCheck()}startCheckCeltraStickyInPreviewMode(a){a=void 0===a?!1:a;const {display:{injectInsideIframe:d}}=
this.adConfig,{Environment:b}=this.context,c=d&&this.creativeIframe?this.creativeIframe.contentWindow:b.hostWindow;let g=!1,f=null;this.logger.log(`${a?'PRE-Check ':''}${this.isCheckModeStrict?'STRICT ':''}Try to find third party ad banner sticky container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`);this.adConfig.display.injectInsideIframe?(this.logger.log('Creative was injected inside an IFRAME ...'),this.context.Environment.hostDocument.querySelectorAll('div > iframe:first-child[allowfullscreen]').forEach(d=>
{this.logger.log(`Found element - start checking (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,{parentElementStyle:d.parentElement&&d.parentElement.style?d.parentElement.style:'unknown'});if(d.parentElement&&d.parentElement.style&&'string'===typeof d.parentElement.style.position&&('fixed'===d.parentElement.style.position||'absolute'===d.parentElement.style.position)&&'undefined'!==typeof d.parentElement.style.zIndex&&2E9<parseInt(d.parentElement.style.zIndex,10))if(a)this.foundDuringPreCheck=
!0,this.logger.warn(`PRE-Check - Found third party ad container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,d.parentElement);else if(this.thirdPartyAdContainer)this.logger.error('Third party ad container was found already',this.thirdPartyAdContainer);else{'iframe'===d.nodeName.toLocaleLowerCase()&&d.contentDocument&&(f=d.contentDocument.getElementById('viewport'));const a=c&&'undefined'!==typeof c.celtra&&'object'===typeof c.celtra.payloads;try{this.logger.log(`Checking Celtra viewport (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,
{celtraViewportStyle:f?f.getAttribute('style'):'unknown'});const b=a?Object.keys(c.celtra.payloads)[0]:'unknown';this.logger.log(`Checking Celtra payloads (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,{celtraPayloads:b});this.logger.log(`Checking Celtra urls (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,{celtraUrlsCreativeUrl:d.contentWindow&&'undefined'!==typeof d.contentWindow.urls&&'undefined'!==typeof d.contentWindow.urls.creativeUrl?d.contentWindow.urls.creativeUrl:
'unknown'})}catch(H){this.logger.error(H)}if(this.isCheckModeStrict&&f&&a&&d.contentWindow&&'undefined'!==typeof d.contentWindow.urls&&'undefined'!==typeof d.contentWindow.urls.creativeUrl)try{if(this.logger.log('STRICT - TRY to find third party ad container check based on Celtra ID',d.parentElement),a){const a=d.contentWindow.urls.creativeUrl.match(/https:\/\/ads.celtra.com\/compiled\/([0-9a-zA-Z]+)\//)[1];Object.keys(c.celtra.payloads).forEach(b=>{this.logger.log(`STRICT - CHECK payloads entry key: '${b}'`,
d.parentElement);b=b.match(/https:\/\/cache-ssl.celtra.com\/api\/creatives\/([0-9a-zA-Z]+)\//)[1];this.logger.log(`STRICT - CHECK third party ad container check based on Celtra ID: '${b}' <> '${a}'`,d.parentElement);'string'===typeof b&&0<b.length&&'string'===typeof a&&0<a.length&&b===a&&(g=!0,this.logger.log(`STRICT - FOUND third party ad container based on Celtra ID: '${b}' <> '${a}'`,d.parentElement))})}}catch(H){this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-error-ad-container`}),
this.logger.error(H)}f&&(!this.isCheckModeStrict||this.isCheckModeStrict&&g)&&(this.logger.log(`Found third party ad container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,f),this.thirdPartyHostContainer=d.parentElement,this.thirdPartyAdContainer=f)}})):(this.logger.log('Creative was injected inside a DIV ...'),this.context.Environment.hostDocument.querySelectorAll('div[class*="celtra-placement-sticky"]').forEach(d=>{this.logger.log(`Found element - start checking (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`);
if(d&&d.style&&'string'===typeof d.style.position&&('fixed'===d.style.position||'absolute'===d.style.position)&&'undefined'!==typeof d.style.zIndex&&2E9<parseInt(d.style.zIndex,10))if(a)this.foundDuringPreCheck=!0,this.logger.warn(`PRE-Check - Found third party ad container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,d);else if(this.thirdPartyAdContainer)this.logger.error('Third party ad container was found already',this.thirdPartyAdContainer);else{d.childNodes.forEach(a=>{a.contentDocument&&
a.contentDocument.getElementById('viewport')&&(f=a.contentDocument.getElementById('viewport'))});const a=c&&'undefined'!==typeof c.celtra&&'object'===typeof c.celtra.payloads;try{this.logger.log(`Checking Celtra viewport (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,{celtraViewportStyle:f?f.getAttribute('style'):'unknown'});const d=a?Object.keys(c.celtra.payloads)[0]:'unknown';this.logger.log(`Checking Celtra payloads (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,
{celtraPayloads:d})}catch(H){this.logger.error(H)}if(this.isCheckModeStrict&&f&&a)try{this.logger.log('STRICT - TRY to find third party ad container check based on Celtra ID',d.parentElement),a&&Object.keys(c.celtra.payloads).forEach(a=>{this.logger.log(`STRICT - CHECK payloads entry key: '${a}'`,d.parentElement);a=a.match(/https:\/\/cache-ssl.celtra.com\/api\/creatives\/([0-9a-zA-Z]+)\//)[1];g=!0;this.logger.log(`STRICT - FOUND third party ad container with Celtra ID: '${a}''`,d.parentElement)})}catch(H){this.context.messageBus.event.emit({kind:'tracker',
event:`tpa-${this.creativeOption}-error-ad-container`}),this.logger.error(H)}f&&(!this.isCheckModeStrict||this.isCheckModeStrict&&g)&&(this.logger.log(`Found third party ad container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,f),this.thirdPartyHostContainer=d,this.thirdPartyAdContainer=f)}}));if(f&&(!this.isCheckModeStrict||this.isCheckModeStrict&&g)&&this.thirdPartyHostContainer&&this.thirdPartyAdContainer){this.logger.log(`Enable third party ad tracking (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,
f);this.stopCheck();this.startCheckCeltraClickContainer();this.enableTracking(this.thirdPartyHostContainer,this.thirdPartyAdContainer,this.thirdPartyClickContainer);try{const a=Date.now()-this.intervalStart;this.logger.log(`Third party ad container was found (${a/1E3}s)`);this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-found`,details:{msSinceStart:a}})}catch(I){this.logger.error(I)}}this.validateCheck()}startCheckCeltraInline(){const {Environment:a}=this.context;
this.logger.log(`Try to find third party ad INLINE container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`);if(this.thirdPartyAdContainer)this.logger.error('Third party ad INLINE container was found already',this.thirdPartyAdContainer);else if(this.adCore.adAssetList.forEach(d=>{d instanceof Z&&Object.keys(d.creative).forEach(b=>{const {creativeDetails:c}=this.adCore.getCreativeOptionDetails(d.creative,b);this.logger.log(`Check creative option ${b} (${a.creativeOption})`);c.container?
b===a.creativeOption&&!1!==c.host&&'undefined'!==typeof c.host?c.host.childNodes.forEach(a=>{this.logger.log('Check child node (DIV)',a);'div'===a.nodeName.toLowerCase()&&(this.logger.log('Search for iframe'),this.searchForNode(a,'iframe'),this.searchForNodeResult?(this.logger.log('Found iframe',this.searchForNodeResult),'iframe'===this.searchForNodeResult.nodeName.toLocaleLowerCase()&&this.searchForNodeResult.contentDocument?(this.logger.log('FOUND',a),this.thirdPartyHostContainer=a,this.thirdPartyAdContainer=
this.searchForNodeResult.contentDocument.getElementById('viewport')):this.logger.log('Iframe has no content')):this.logger.log("Can't find iframe"))}):this.logger.log(`Can't find host for creative option ${b} (${a.creativeOption})`):this.logger.log(`Can't find container for creative option ${b} (${a.creativeOption})`)})}),this.thirdPartyHostContainer&&this.thirdPartyAdContainer){this.logger.log(`Found third party ad INLINE container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`,
this.thirdPartyAdContainer);this.thirdPartyClickContainer=this.thirdPartyAdContainer;this.stopCheck();this.enableTracking(this.thirdPartyHostContainer,this.thirdPartyAdContainer,this.thirdPartyClickContainer);try{const a=Date.now()-this.intervalStart;this.logger.log(`Third party ad INLINE container was found (${a/1E3}s)`);this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-found`,details:{msSinceStart:a}})}catch(u){}!this.adCore.takeoverVisibilityHandler||'takeoverInlineAndSticky'!==
this.adConfig.display.effect&&'takeoverInlineAndHidden'!==this.adConfig.display.effect&&'takeoverUnderstitialMiniAndSticky'!==this.adConfig.display.effect&&'takeoverUnderstitialMiniAndHidden'!==this.adConfig.display.effect||!this.adCore.takeoverTarget||'celtra-banner'!==this.adConfig.thirdParty.creativeSource.portrait&&'celtra-banner'!==this.adConfig.thirdParty.creativeSource.landscape&&'celtra-interscroller'!==this.adConfig.thirdParty.creativeSource.portrait&&'celtra-interscroller'!==this.adConfig.thirdParty.creativeSource.landscape||
(this.logger.log('TakeoverVisibilityHandler: Celtra third party ad INLINE creative source is detected (Celtra Banner/Interscroller) - start initializing, enabling and adding to visibility handler list'),this.adCore.takeoverVisibilityHandler.init(),this.adCore.takeoverVisibilityHandler.enable(),this.adCore.visibilityHandlerList.push(this.adCore.takeoverVisibilityHandler))}this.validateCheck()}startCheckCeltraClickContainer(a){this.logger.log(`${(void 0===a?0:a)?'PRE-Check ':''}Try to find third party click container (${this.adConfig.thirdParty.creativeSource[this.creativeOption]})`);
if(this.thirdPartyAdContainer)try{switch(this.logger.log('TRY to find third party click container',this.thirdPartyAdContainer.parentElement),this.adConfig.thirdParty.creativeSource[this.creativeOption]){case 'celtra-banner':this.thirdPartyClickContainer=this.thirdPartyAdContainer.parentElement;break;case 'celtra-banner-sticky':this.thirdPartyClickContainer=this.thirdPartyAdContainer;break;case 'celtra-interscroller':break;case 'celtra-interstitial':this.thirdPartyClickContainer=this.thirdPartyAdContainer;
break;default:this.thirdPartyClickContainer=this.thirdPartyAdContainer.parentElement,this.logger.warn(`TRY to find third party click container - invalid third party source: '${this.adConfig.thirdParty.creativeSource[this.creativeOption]}'`),this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-error-source`})}}catch(u){this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-error-click-container`}),this.logger.error(u)}else this.context.messageBus.event.emit({kind:'tracker',
event:`tpa-${this.creativeOption}-error-click-container`})}startCheck(a){this.logger.log(`startCheck - Entered (interval start: ${this.intervalStart})`);this.logger.log('startCheck - Reset interval start');this.intervalStart=Date.now();'undefined'!==typeof this.adConfig.thirdParty&&'undefined'!==typeof this.adConfig.thirdParty.checkInterval&&'undefined'!==typeof this.adConfig.thirdParty.checkTimeout?this.intervalId=this.context.Environment.hostWindow.setInterval(a,this.adConfig.thirdParty.checkInterval):
(this.logger.error("startCheck - Can't start checking third party ad container"),this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-error-config`}))}validateCheck(){this.logger.log(`validateCheck - Entered (interval start: ${this.intervalStart})`);0>=this.intervalStart&&(this.logger.log('validateCheck - Reset interval start'),this.intervalStart=Date.now());const a=Date.now()-this.intervalStart;'undefined'!==typeof this.adConfig.thirdParty&&'undefined'!==typeof this.adConfig.thirdParty.checkTimeout&&
a>this.adConfig.thirdParty.checkTimeout&&(this.stopCheck(),this.logger.error('validateCheck - Timeout during checking third party ad container'),this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-timeout`,details:{msSinceStart:a}}))}stopCheck(){this.intervalId&&this.context.Environment.hostWindow.clearInterval(this.intervalId)}searchForNode(a,b,c){c=void 0===c?0:c;a.childNodes.forEach(a=>{a.nodeName.toLowerCase()===b.toLowerCase()?this.searchForNodeResult=a:this.searchForNode(a,
b,c++)})}enableTracking(a,b,c){const {Environment:d}=this.context;this.logger.log('Enable Tracking on ad container');a.setAttribute(f.a.AD_SESSION_ID,this.initConfig.meta.adSessionId);a.setAttribute(f.a.CONTAINER_TYPE,'host');b.setAttribute(f.a.AD_SESSION_ID,this.initConfig.meta.adSessionId);b.setAttribute(f.a.CONTAINER_TYPE,'ad');d.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(255, 255, 0, 0.3)',b.append(this.demoContainer));if(this.adConfig.tracking.viewabilityTrackingOverAll||
'portrait'===this.creativeOption||'landscape'===this.creativeOption){b.setAttribute(f.a.VIEWABILITY,f.b.ENABLED);b.setAttribute(f.a.VIEWABILITY_STATUS,f.b.WAITING);b.setAttribute(f.a.VIEWABILITY_GOAL,`viewability ${this.adConfig.tracking.viewabilityPercent}/${this.adConfig.tracking.viewabilityTime/1E3}`);let a=null;a=new f.c(`Viewability Tracking (ThirdPartyAd - ${this.creativeOption})`,this.context,this.adConfig,b,!1,this.adConfig.tracking.viewabilityPercent,this.adConfig.tracking.viewabilityTime,
this.adConfig.tracking.visibilityHandlerType,this.adCore.visibilityHandlerViewabilityGroupList,!0,()=>{try{const c=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'viewability',details:{msSinceStart:c}});d.isVCPM&&(d.isPortrait?(this.context.trackingMiner.portrait.visibleCreative&&this.context.trackingMiner.portrait.visibleCreative.release(),this.context.trackingMiner.portrait.hiddenCreative&&this.context.trackingMiner.portrait.hiddenCreative.release()):
(this.context.trackingMiner.landscape.visibleCreative&&this.context.trackingMiner.landscape.visibleCreative.release(),this.context.trackingMiner.landscape.hiddenCreative&&this.context.trackingMiner.landscape.hiddenCreative.release()));b.setAttribute(f.a.VIEWABILITY_STATUS,f.b.FINISHED);b.setAttribute(f.a.VIEWABILITY_SUCCESS,`viewability ${this.adConfig.tracking.viewabilityPercent}/${this.adConfig.tracking.viewabilityTime/1E3}`);b.setAttribute(f.a.VIEWABILITY_TIME,`${a.visibilityHandler.viewedTime}`);
d.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(0, 255, 0, 0.3)')}catch(Q){this.context.messageBus.event.emit({kind:'tracker',event:`tpa-${this.creativeOption}-error-viewability`}),this.logger.error(Q)}},()=>{},!1,()=>{a.visibilityHandler.disabled||(b.setAttribute(f.a.VIEWABILITY_STATUS,f.b.STARTED),b.setAttribute(f.a.VIEWABILITY_TIME,`${a.visibilityHandler.viewedTime} +`),d.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(255, 165, 0, 0.3)'))},
()=>{a.visibilityHandler.disabled||(b.setAttribute(f.a.VIEWABILITY_STATUS,f.b.PAUSED),b.setAttribute(f.a.VIEWABILITY_TIME,`${a.visibilityHandler.viewedTime}`),d.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(255, 255, 0, 0.3)'))});a.init();this.adCore.visibilityHandlerDependsOnImpressionList.push(a);this.adConfig.tracking.viewabilityTrackingOverAll&&this.adCore.visibilityHandlerViewabilityGroupList.push(a);a.enable()}else b.setAttribute(f.a.VIEWABILITY,f.b.SKIPPED),
b.setAttribute(f.a.VIEWABILITY_STATUS,f.b.SKIPPED),this.logger.log(`SKIP viewability tracking for ${this.creativeOption} creative`,{configCreative:this.configCreative});this.adConfig.tracking.enableClickTrackingWorkaround&&c?(this.logger.log('Setup click tracking on click container (ThirdPartyAd)'),c.setAttribute(f.a.CLICK,f.b.ENABLED),c.setAttribute(f.a.CLICK_STATUS,f.b.WAITING),c.setAttribute(f.a.CLICK_GOAL,'click'),c.setAttribute(f.a.AD_SESSION_ID,this.initConfig.meta.adSessionId),c.onclick=a=>
{this.wasClicked?(this.logger.log('SKIP repeated CLICK on click container (ThirdPartyAd)'),c.setAttribute(f.a.CLICK_SUCCESS,'click-repeated'),d.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(128, 128, 128, 0.3)'),this.context.messageBus.event.emit({kind:'tracker',event:'click-repeated',details:{source:`tpa-${this.creativeOption}`}})):(this.logger.log('Handle CLICK on click container (ThirdPartyAd)'),this.wasClicked=!0,c.setAttribute(f.a.CLICK_STATUS,f.b.FINISHED),
c.setAttribute(f.a.CLICK_SUCCESS,'click'),d.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(0, 0, 0, 0.3)'),this.context.messageBus.event.emit({kind:'tracker',event:'click',details:{source:`tpa-${this.creativeOption}`}}))}):this.logger.log('Setup click tracking on click container (ThirdPartyAd)')}fixDisplayInjectInsideIframe(){!0===this.adConfig.display.injectInsideIframe&&this.context.Environment.isMRAID&&(this.logger.log('Celtra creative inside MRAID: overriding injectInsideIframe to false'),
this.adConfig.display.injectInsideIframe=!1)}}class y{constructor(a,b,c,g,f){this.adConfig=this.initConfig=null;this.method='all';this.creativeContentWithoutTracking=this.creativeContentOriginal='';this.trackingImages=[];this.trackingIframes=[];this.countOfTrackersFound=0;this.isReleased=this.isError=!1;this.context=a;this.initConfig=b;this.adConfig=c;this.logger=a.newLogger('Miner');'all'!==g&&'pattern'!==g&&(g='all');this.method=g;this.creativeContentOriginal=f}release(){this.isReleased?this.logger.warn('Ignore call to fetch all trackers, already done'):
(this.logger.log('Start fetching all trackers'),this.isReleased=!0,this.trackingImages.forEach(a=>{this.logger.log(`Fetching image tracker: ${a}`);this.context.metrics.loadTrackingImage(a)}),this.trackingIframes.forEach(a=>{this.logger.log(`Fetching iframe tracker: ${a}`);this.context.metrics.loadTrackingIframe(a)}),this.context.messageBus.event.emit({kind:'tracker',event:'tracking-miner-released'}),this.logger.log('Finished fetching all trackers'))}collect(){this.logger.log('Start mining of trackers');
this.countOfTrackersFound=0;const a=['IMG','IFRAME'],b={IMG:[],IFRAME:[],CONTENT:''};try{if(''!==this.creativeContentOriginal)if('33'===this.initConfig.meta.dspId)try{const a=this.creativeContentOriginal.match(/https?:\/\/[a-z0-9\-]+\.adnxs\.com\/it\?[^"]+/gm);a&&a.forEach(a=>{b.IMG.push(a);this.creativeContentOriginal=this.creativeContentOriginal.replace(a,'')});this.countOfTrackersFound+=b.IMG.length;0===this.countOfTrackersFound&&(this.logger.warn("DSP 33: Can't find trackings"),this.isError=!0,
this.context.messageBus.event.emit({kind:'tracker',event:'tracking-miner-warn-notfound'}))}catch(p){this.logger.error('DSP 33: Error during search for trackings',p)}finally{b.CONTENT=this.creativeContentOriginal}else try{const d=(new DOMParser).parseFromString(this.creativeContentOriginal,'text/html');a.forEach(a=>{const c=d.getElementsByTagName(a);0<c.length&&(Object.keys(c).forEach(d=>{d=c[d];const g=d.src;let f=!1;this.logger.log(`By using method '${this.method}' found '${a}': ${g}`,d);try{if('string'!==
typeof g||'data:'!==g.toLocaleLowerCase().substring(0,5))'all'===this.method?1!==d.width&&0!==d.width||1!==d.height&&0!==d.height?'undefined'===typeof d.style||(1===parseInt(d.style.width,10)||0===parseInt(d.style.width,10),!1)||1!==parseInt(d.style.height,10)&&0!==parseInt(d.style.height,10)||(f=!0,this.logger.log(`By using method '${this.method}' - identified as tracker due to style dimension: ${g}`),b[a].push(g)):(f=!0,this.logger.log(`By using method '${this.method}' - identified as tracker due to tag dimension: ${g}`),
b[a].push(g)):'pattern'===this.method&&-1!==g.indexOf('bidswitch.net/imp/')&&(f=!0,this.logger.log(`By using method '${this.method}' - identified as tracker: ${g}`),b[a].push(g))}catch(H){this.isError||this.logger.error('Internal error 90003'),this.isError=!0}f||this.logger.log(`Skip element: ${g}`)}),b[a].forEach(a=>{Object.keys(c).forEach(d=>{if('undefined'!==typeof c[d]){d=c[d];const b=d.src;b===a&&'undefined'!==typeof d&&'undefined'!==typeof d.parentNode&&(this.logger.log(`Removed tracker: ${b}`),
d.parentNode.removeChild(d))}})}));this.countOfTrackersFound+=b[a].length});0===this.countOfTrackersFound?(this.logger.warn("Can't find trackings"),this.isError=!0,b.CONTENT=this.creativeContentOriginal,this.context.messageBus.event.emit({kind:'tracker',event:'tracking-miner-warn-notfound'})):b.CONTENT=d.body.innerHTML}catch(p){this.logger.error('Error during search for trackings',p),this.isError=!0,b.IMG=[],b.IFRAME=[],b.CONTENT=this.creativeContentOriginal,this.context.messageBus.event.emit({kind:'tracker',
event:'tracking-miner-error-search'})}}catch(p){this.logger.error('Exception during mining of trackers: '+p),this.isError=!0,b.IMG=[],b.IFRAME=[],b.CONTENT=this.creativeContentOriginal,this.context.messageBus.event.emit({kind:'tracker',event:'tracking-miner-error-exception'})}this.trackingImages=b.IMG;this.trackingIframes=b.IFRAME;this.creativeContentWithoutTracking=b.CONTENT;this.logger.log(`Finished mining of trackers ${this.isError?'WITH':'without'} error: ${this.countOfTrackersFound} trackers found`,
b);this.context.messageBus.event.emit({kind:'tracker',event:'tracking-miner',details:{countOfTrackersFound:this.countOfTrackersFound}});return this.isError?!1:!0}}var A=a(8),B=a(2);const t=1-.9,l=1-2*t;class x{constructor(a,b,c,g){this.scene=a;this.card=b;this.front=c;this.back=g;this.height=this.width=0;this.scene.style.perspective='600vw';a=this.front.style;b=this.back.style;this.card.style.cssText='width:100%;height:100%;position:relative;transform-style:preserve-3d';[a,b].forEach(a=>{a.cssText=
'position:absolute;width:100%;height:100%;backface-visibility:hidden;-webkit-backface-visibility:hidden'})}setDimensions(a,b){this.width=a;this.height=b;this.card.style.width=`${a}px`;this.card.style.height=`${b}px`;this.postSetDimensions&&this.postSetDimensions(a,b)}}class S extends x{constructor(...a){super(...a);this.back.style.transform='rotateY(180deg)'}update(a){this.card.style.transform=`rotateY(${180*a}deg)`}}class L extends x{constructor(...a){super(...a);this.card.style.transformOrigin=
'center right';this.back.style.transform='rotateY(180deg)'}update(a){this.card.style.transform=`translateX(${-100*a}%) rotateY(${180*a}deg)`}}class D extends x{constructor(...a){super(...a);this.postSetDimensions=(a,d)=>{this.back.style.transform=`rotateY(-90deg) translateZ(${a}px)`};this.card.style.transformOrigin='left center';this.card.style.transform='rotateY(0deg) translateZ(0px)';this.back.style.transformOrigin='right'}update(a){this.card.style.transform=`rotateY(${90*a}deg) translateZ(${this.width*
a}px)`}}class O extends x{constructor(...a){super(...a);this.back.style.transform='rotateX(180deg)'}update(a){this.card.style.transform=`rotateX(${180*a}deg)`}}class g extends x{constructor(...a){super(...a);this.back.style.transform='translateX(15%)';this.back.style.opacity='0'}update(a){a=.5>a?4*a*a*a:1-Math.pow(-2*a+2,3)/2;this.back.style.opacity=`${a}`;this.back.style.transform=`translateX(${15*(1-a)}%)`}}var w=a(24);const P=['flip','front-flip','back-flip','vertical-flip','slide-in'];class T{constructor(a,
b,c){this.context=a;this.adConfig=b;this.prevPos=0;this.handleScroll=()=>{const {top:a,height:b}=this.context.rootContainer.getBoundingClientRect();var {innerHeight:d}=window;var c=b,g=a;.9*d<=c&&(g+=c*t,c*=l);d=0>=g?1:c+g>=d?0:1-g/(d-c);if(d!==this.prevPos){const {start:a,stop:b}=this.adConfig.display.animation;this.effect.update(h(a/100,b/100,d));this.prevPos=d}};this.enableScrollHandler=()=>{window.addEventListener('scroll',this.handleScroll,w.a?{passive:!0}:!1)};this.disableScrollHandler=()=>
{window.removeEventListener('scroll',this.handleScroll)};var {Environment:d}=a;a=r.e(d,'div');b=r.e(d,'div');const k=r.e(d,'div');d=r.e(d,'div');b.setAttribute('data-animate','');this.scene=a;this.card=b;this.front=k;this.back=d;a.append(b);b.append(k);b.append(d);'random'===c&&(c=P[Math.floor(Math.random()*P.length)]);switch(c){case 'flip':c=new S(a,b,k,d);break;case 'back-flip':c=new L(a,b,k,d);break;case 'front-flip':c=new D(a,b,k,d);break;case 'vertical-flip':c=new O(a,b,k,d);break;default:c=
new g(a,b,k,d)}this.effect=c;this.visibilityTracker=new f.c('Animation[Visibility]',this.context,this.adConfig,this.scene,!1,0,0,'auto',[],!1,this.enableScrollHandler,this.disableScrollHandler,!0)}setDimensions(a,b){this.effect.setDimensions(a,b)}addToFront(a){this.front.append(a)}addToBack(a){this.back.append(a)}dispose(){this.visibilityTracker.disable();this.disableScrollHandler()}}const X=/^(https?:)?\/\//i;var U=a(3),Y=a(15),ca=a(19);class Z{constructor(){this.adAssetList=[];this.assetContainer=
null;this.creative={portrait:{container:!1,wrapper:!1,host:!1,iframe:!1,iframeHidden:!1,image:!1,canvas:!1,alreadyInserted:!1,thirdPartyAd:!1,backfaceImage:!1},landscape:{container:!1,wrapper:!1,host:!1,iframe:!1,iframeHidden:!1,image:!1,canvas:!1,alreadyInserted:!1,thirdPartyAd:!1,backfaceImage:!1},sticky:{container:!1,wrapper:!1,host:!1,iframe:!1,iframeHidden:!1,image:!1,canvas:!1,alreadyInserted:!1,thirdPartyAd:!1,backfaceImage:!1},hidden:{container:!1,wrapper:!1,host:!1,iframe:!1,iframeHidden:!1,
image:!1,canvas:!1,alreadyInserted:!1,thirdPartyAd:!1,backfaceImage:!1}};this.isImage=this.isVideo=this.isReady=!1;this.waitForAssetReadyCheck=!0;this.wasImpressionTrackingAlignedAndInjected=this.wasRepeatedFastClick=this.wasClicked=!1;this.closeAd=(a,b)=>{b=!1;a&&(b=!0,a.stopPropagation(),this.context.messageBus.event.emit({kind:'tracker',event:'close'}));this.context.messageBus.event.emit({kind:'close',interactive:b});(this.context.Environment.isLogMode||this.context.Environment.isDebugMode)&&this.context.troubleshooting.log()};
this.closeStickyAd=a=>{const {Environment:{isLogMode:b,isDebugMode:d},troubleshooting:c,messageBus:g}=this.context;let f=!1;a&&(f=!0,a.stopPropagation(),g.event.emit({kind:'tracker',event:'close-sticky'}));g.event.emit({kind:'close-sticky',interactive:f});(b||d)&&c.log()};this.onUnderstitialPaint=a=>{({enabled:a}=a);const {creativeOption:b,isSticky:d,isBrandedTakeoverSticky:c}=this.context.Environment,{wrapper:g}=this.creative[b];g&&(g.style.overflow=!a||d||c?'':'hidden')}}init(a,c,g,f,k,l){this.adCore=
a;this.context=c;this.adPainter=g;this.initConfig=f;this.adConfig=k;this.adAssetList=l;this.logger=this.context.newLogger('AdCreative');Object.keys(this.creative).forEach(a=>{const {configCreative:d,creativeDetails:g}=this.adCore.getCreativeOptionDetails(this.creative,a);'static-image'===d.mode&&(this.isImage=!0);this.logger.log(`Pre-check third party ad logic for ${a} creative`,{configCreative:d});if('third-party-ad'!==f.product.key&&!0===k.display.injectInsideIframe&&c.Environment.isMRAID)try{let a=
'';'redirect'===d.mode?d.useCreativeCodeInstead?(this.logger.log('useCreativeCodeInstead is set, using creative code from InitConfig'),a=decodeURIComponent(this.initConfig.creativeCode)):a=decodeURIComponent(d.redirectCode):'redirect-load-rtb-hidden'===d.mode&&(d.useCreativeCodeInstead&&(this.logger.log(`useCreativeCodeInstead not allowed for ${d.mode}`),d.useCreativeCodeInstead&&this.context.messageBus.event.emit({kind:'tracker',event:'creative-misconfiguration-creative-code'})),a=decodeURIComponent(d.redirectCode));
const c=decodeURIComponent(f.creativeCode);if('string'===typeof a&&Object(b.a)(a)||'string'===typeof c&&Object(b.a)(c))this.logger.log('Celtra creative inside MRAID: overriding injectInsideIframe to false'),this.adConfig.display.injectInsideIframe=!1}catch(la){}g.thirdPartyAd=new C(this.context,this.initConfig,this.adConfig,this.adCore,this.adPainter,a,d,g);g.thirdPartyAd.preCheck()});return this.initForFeature(this.adCore,this.context=c,this.adPainter,this.initConfig,this.adConfig,this.adAssetList)}initForFeature(a,
b,c,g,f,k){return!0}constructVisibilityHandler(a){return this.constructVisibilityHandlerForFeature(a)}constructVisibilityHandlerForFeature(a){return a}constructAdNodes(a,b){let d=a,c=b;const {Environment:g}=this.context;this.context.Environment.isVideo&&this.adCore.adAssetList.forEach(a=>{a.isVideo&&(this.adCore.zoomElement=a.assetContainer)});Object.keys(this.creative).forEach(a=>{const {configCreative:b,creativeDetails:l}=this.adCore.getCreativeOptionDetails(this.creative,a);this.logger.log(`Starting to prepare ${a} creative`,
{configCreative:b});const {meta:{adSessionId:n}}=this.initConfig;var {productTitlePostfix:h}=this.context;const u=r.e(g,'div');u.id=`yoc_creative_container_${a}_${h}_${n}`;const m=r.e(g,'div');m.id=`yoc_creative_wrapper_${a}_${h}_${n}`;const y=r.e(g,'div');y.id=`yoc_creative_host_${a}_${h}_${n}`;if('static-image'===b.mode){var p='';let d='';b.useCreativeCodeInstead?(this.logger.log('useCreativeCodeInstead is set, using creative code from InitConfig'),p=k(this.initConfig.creativeCode)):p=k(b.imageUrl);
d=k(b.clickUrl);d=this.adCore.replaceMacros(d);if(p){p=new r.b(this.context,p,!0);p.node.id=`yoc_creative_image_${a}_${h}_${n}`;u.setAttribute(f.a.CLICK,f.b.ENABLED);u.setAttribute(f.a.CLICK_STATUS,f.b.WAITING);u.setAttribute(f.a.CLICK_GOAL,'click');u.setAttribute(f.a.AD_SESSION_ID,this.initConfig.meta.adSessionId);let c;b.animation&&b.animation.mode&&'disabled'!==b.animation.mode?(this.animation=new T(this.context,this.adConfig,b.animation.mode),this.animation.addToFront(p.node),y.append(this.animation.scene),
l.image=p.node,c=new r.b(this.context,k(b.animation.imageUrl),!0),c.node.style.width=`${b.width}px`,c.node.style.height=`${b.height}px`,c.node.style.backfaceVisibility='hidden',p.node.style.backfaceVisibility='hidden',this.animation.addToBack(c.node),this.animation.setDimensions(b.width,b.height)):(y.append(p.node),l.image=p.node);this.context.setupClickHandler(u,l=>{this.logger.log(`Handle CLICK on ${a} image creative`,{configCreative:b});if(g.isVideo)this.logger.log('This is video ad, not processing click on image creative');
else{if('enabled'===this.adConfig.feature.swiper.mode)try{if(this.wasRepeatedFastClick){this.logger.log('Swiper - Not processing click (for landing page) because of repeated fast click');return}if(l.target.getAttribute('id').startsWith('yoc_swiper_container_button_')){this.logger.log('Swiper - Not processing click (for landing page) on swiper navigation');this.context.messageBus.event.emit({kind:'tracker',event:'swiper-interaction-real'});this.context.messageBus.event.emit({kind:'tracker',event:'swiper-interaction-real-button'});
try{this.adCore.wasSwiperFirstRealInteractionTracked||(this.adCore.wasSwiperFirstRealInteractionTracked=!0,this.adCore.pingRuntimeStatus(Number(B.l)+Number(this.adCore.swiperSlideActive)+1,!1))}catch(aa){this.logger.error(`Swiper (AdCreative setupClickHandler ${this.adCore.swiperSlideActive}) - button (${a}) - Unable to report the run-time status`)}return}}catch(aa){this.logger.error('Swiper - Determine click (for landing page) on swiper slide FAILED')}var h=d,n=d;b.animation&&b.animation.mode&&'disabled'!==
b.animation.mode&&(n=b.animation.clickUrl);c&&l.target===c.node&&n&&(h=k(n));h?(Object(q.a)(this.context,h),u.setAttribute(f.a.CLICK_STATUS,f.b.FINISHED),u.setAttribute(f.a.CLICK_SUCCESS,'click')):(u.setAttribute(f.a.CLICK_STATUS,f.b.FINISHED),u.setAttribute(f.a.CLICK_SUCCESS,'click-error'));this.wasClicked?(u.setAttribute(f.a.CLICK_SUCCESS,'click-repeated'),this.context.messageBus.event.emit({kind:'tracker',event:'click-repeated',details:{source:`adcreative-${a}`}})):(u.setAttribute(f.a.CLICK_SUCCESS,
'click'),this.context.messageBus.event.emit({kind:'tracker',event:'click',details:{source:`adcreative-${a}`}}));this.wasClicked=!0;this.setRepeatedFastClickStatus()}})}else this.logger.log(`Skip ${a} image creative - URL is missing`,{configCreative:b});g.isVideo||g.isPreloadImage||(this.waitForAssetReadyCheck=!1)}else if('html5'===b.mode||'redirect'===b.mode||'redirect-use-rtb'===b.mode||'redirect-load-rtb-hidden'===b.mode){const {display:{sandboxForIframes:d,injectInsideIframe:c}}=this.adConfig;
let f='';if('html5'===b.mode||'redirect'===b.mode)b.animation&&b.animation.mode&&'disabled'!==b.animation.mode&&(this.animation=new T(this.context,this.adConfig,b.animation.mode),y.append(this.animation.scene),p=new r.b(this.context,k(b.animation.imageUrl),!0),p.node.style.width=`${b.width}px`,p.node.style.height=`${b.height}px`,p.node.style.backfaceVisibility='hidden',this.context.setupClickHandler(p.node,()=>{b.animation&&b.animation.mode&&'disabled'!==b.animation.mode&&Object(q.a)(this.context,
k(b.animation.clickUrl))}),this.animation.addToBack(p.node),this.animation.setDimensions(b.width,b.height)),b.overrideClickUrl&&(f=Object(ca.a)(k(b.overrideClickUrl),this.initConfig));if(c){p=r.e(g,'iframe');p.id=`yoc_creative_iframe_${b.mode}_${a}_${h}_${n}`;p.frameBorder='0';p.scrolling='no';0<d.length&&(p.sandbox=d);y.append(p);l.iframe=p;if(f){const a=r.e(g,'div');a.style.position='absolute';a.style.top='0';a.style.left='0';a.style.right='0';a.style.bottom='0';y.append(a);this.context.setupClickHandler(a,
()=>{this.wasClicked?this.context.messageBus.event.emit({kind:'tracker',event:'click-repeated',details:{source:'adcreative-override'}}):this.context.messageBus.event.emit({kind:'tracker',event:'click',details:{source:'adcreative-override'}});this.wasClicked=!0;this.setRepeatedFastClickStatus();Object(q.a)(this.context,f)})}this.animation&&this.animation.addToFront(p)}else p=r.e(g,'div'),p.id=`yoc_creative_div_${b.mode}_${a}_${h}_${n}`,y.append(p),l.div=p,this.animation&&this.animation.addToFront(p);
r.f(u);'redirect-load-rtb-hidden'===b.mode&&(c?(p=r.e(g,'iframe'),p.id=`yoc_creative_hidden_iframe_${b.mode}_${a}_${h}_${n}`,p.frameBorder='0',p.scrolling='no',0<d.length&&(p.sandbox=d),r.f(p),y.append(p),l.iframeHidden=p):(p=r.e(g,'div'),p.id=`yoc_creative_hidden_div_${b.mode}_${a}_${h}_${n}`,r.f(p),y.append(p),l.divHidden=p));this.waitForAssetReadyCheck=!1}else'blurred-video'===b.mode&&(p=r.e(g,'canvas'),p.id=`yoc_creative_canvas_${a}_${h}_${n}`,r.f(u),y.append(p),l.canvas=p,this.isOverlayBlurredVideo(b)&&
this.context.overlayContainerBackground&&({parentElement:h}=this.context.overlayContainerBackground,h.insertBefore(p,this.context.overlayContainerBackground)),g.isZoom&&(h=r.e(g,'canvas'),h.id=`yoc_backface_canvas_${this.context.productTitlePostfix}_${n}`,g.backfaceContainer.append(h),r.f(h),this.adCore.backfaceCanvas=h));try{if(this.adConfig.tracking.moat&&'creative'===this.adConfig.tracking.injectTagMode&&!this.adCore.wasMoatTagInjected&&['portrait','landscape'].includes(a)&&(!g.isVideo||g.isVideo&&
'enabled'===this.adConfig.video.background.mode)){this.adCore.wasMoatTagInjected=!0;const a=Object(Y.a)(this.context,this.logger);y.append(a)}}catch(R){this.logger.error(R)}m.append(y);u.append(m);this.isBrandedTakeoverStickyCreative(a)?(this.logger.log('YOC Branded TAKEOVER - append creativeContainer to backgroundStickyContainer'),this.context.backgroundStickyContainer.append(u)):'hidden'===a?c.prepend(u):this.isOverlayBlurredVideo(b)||d.prepend(u);A.a.preload(this.adConfig,u);l.container=u;l.wrapper=
m;l.host=y;'undefined'!==typeof this.adConfig.thirdParty.creativeSource[a]&&'disabled'!==this.adConfig.thirdParty.creativeSource[a]?(this.logger.log(`Init third party ad logic for ${a} creative`,{configCreative:b}),l.thirdPartyAd.init()):this.logger.log(`SKIP third party ad logic for ${a} creative because it's disabled / undefined`,{configCreative:b})});a=this.constructAdNodesForFeature(d,c);d=a.adNode;c=a.adNodeHidden;this.context.messageBus.event.onceEvent('shown',()=>{this.fallbackCloseButtonAddTimeoutId=
window.setTimeout(()=>{this.addFallbackCloseAdButton()},B.d)});A.a.preload(this.adConfig,this.adPainter.productContainer);this.addCloseAdButton();this.understitialPaintHandler=this.context.messageBus.event.onEvent('understitial',this.onUnderstitialPaint);return{adNode:d,adNodeHidden:c}}constructAdNodesForFeature(a,b){return{adNode:a,adNodeHidden:b}}updateStyles(a){var {updateAdPosition:b,reset:d}=void 0===a?{updateAdPosition:!1,reset:!1}:a;const {Environment:c}=this.context;Object.keys(this.creative).forEach(a=>
{let b=0,g=0,f=1;const {configCreative:k,creativeDetails:l}=this.adCore.getCreativeOptionDetails(this.creative,a);if(l.container)if(a===c.creativeOption||this.isBrandedTakeoverStickyCreative(a))if(this.adConfig.display.hide)this.logger.log(`Style update - custom option hide found - hide ${a} - ${k.mode} creative`,{configCreative:k}),r.f(l.container),this.context.messageBus.event.emit({kind:'tracker',event:'hide'});else if('html5'===k.mode||'redirect'===k.mode||'redirect-load-rtb-hidden'===k.mode||
'static-image'===k.mode||'blurred-video'===k.mode)if(this.logger.log(`Style update - show ${a} - ${k.mode} creative`,{configCreative:k}),r.h(l.container),this.isBrandedTakeoverStickyCreative(a)){const {scaledWidth:a,scaledHeight:d,scaleFactor:l}=c.getDimensions(k.width,k.height,!0);b=a;g=d;f=l}else c.updatedCreativeHeight=k.height,c.updatedCreativeWidth=k.width,c.calculateAdDimension(),b=c.scaledWidth,g=c.scaledHeight,f=c.usedScaleFactor;else'redirect-use-rtb'===k.mode?(this.logger.log(`Style update - show ${a} - ${k.mode} creative`,
{configCreative:k}),r.h(l.container),c.updatedCreativeHeight=this.adConfig.display.height,c.updatedCreativeWidth=this.adConfig.display.width,c.calculateAdDimension(),b=c.scaledWidth,g=c.scaledHeight,f=c.usedScaleFactor):this.logger.log(`Style update - SKIP ${a} creative because of unsupported mode '${k.mode}'`,{configCreative:k});else c.isBrandedTakeoverSticky||(this.logger.log(`Style update - hide ${a} - ${k.mode} creative`,{configCreative:k}),r.f(l.container));d?this.setDimensions({width:0,height:0,
scaleFactor:1,creativeOption:a}):this.setDimensions({width:b/f,height:g/f,scaleFactor:f,creativeOption:a})});this.updateStylesForFeature({updateAdPosition:b,reset:d})}updateStylesForFeature(a){}setDimensions(a){var {width:b,height:c,scaleFactor:d,creativeOption:g}=a;const {configCreative:f,creativeDetails:k}=this.adCore.getCreativeOptionDetails(this.creative,g);if(g===this.context.Environment.creativeOption||this.isBrandedTakeoverStickyCreative(g))if(this.logger.log(`Starting to set dimension of ${g} - ${f.mode} creative`,
{configCreative:f}),this.adConfig.display.hide)this.logger.log(`Set dimension - custom option hide found - skip ${g} - ${f.mode} creative`,{configCreative:f});else if(k.container&&k.wrapper&&k.host&&('html5'===f.mode||'redirect'===f.mode||'redirect-use-rtb'===f.mode||'redirect-load-rtb-hidden'===f.mode||'static-image'===f.mode||'blurred-video'===f.mode)){a=0===b?0:this.adConfig.display.width;let u=0===c?0:this.adConfig.display.height;if('html5'===f.mode||'redirect'===f.mode||'redirect-load-rtb-hidden'===
f.mode||'static-image'===f.mode||'blurred-video'===f.mode)a=0===b?0:f.width,u=0===c?0:f.height;var l=a,h=u,n='';const {display:{iFrameScaleMethod:q}}=this.adConfig;1!==d&&('scaleToFit'===q?(n=`transform-origin: left top; transform:scale(${d});`,l*=d,h*=d):'scaleToWidth'===q&&(a*=d,u*=d));this.logger.log(`Set dimension - process ${g} - ${f.mode} creative`,{width:b,height:c,scaleFactor:d,creativeWidth:a,creativeHeight:u,configCreative:f});h=`position: relative; width: ${l}px; height: ${h}px;`;if(!(this.adConfig.display.forceUsingDeliveryContainer||
this.context.Environment.isMRAID||this.context.Environment.isUnderstitial||this.context.Environment.isMysteryAd||this.context.Environment.isSticky||this.context.Environment.isSitebar)||(this.context.Environment.isMRAID||this.adConfig.display.forceUsingDeliveryContainer)&&'yoc-banner-classic'===this.initConfig.product.key&&'scale'===this.adConfig.display.responsive.mode&&0<this.adConfig.display.responsive.maximumWidth&&0<this.adConfig.display.responsive.maximumHeight&&this.context.Environment.availableWidth>
this.adConfig.display.responsive.maximumWidth||this.context.Environment.isMRAID&&'third-party-ad'===this.initConfig.product.key&&'scale'===this.adConfig.display.responsive.mode&&('celtra-banner'===this.adConfig.thirdParty.creativeSource.portrait||'celtra-banner'===this.adConfig.thirdParty.creativeSource.landscape))h='scale'===this.adConfig.display.responsive.mode&&!1===this.adConfig.display.responsive.followLayout?h+`left: ${(this.context.Environment.viewportWidth-l)/2}px;`:h+`left: ${(this.context.Environment.availableWidth-
l)/2}px;`,!0===Object(U.b)(this.adConfig)&&(h+='margin-left: 50%; transform: translateX(-50%)');l=`display: block; width: ${a}px; height: ${u}px; ${n}`;'celtra-interscroller'!==this.adConfig.thirdParty.creativeSource.portrait||this.isBrandedTakeoverStickyCreative(g)||(h='position: relative; width: auto; height: auto;',l=`display: block; width: auto; height: auto; ${n}`);'blurred-video'===f.mode&&'sharp'===f.type&&(l+='overflow: hidden;');k.container.style.cssText='left: 0px; top: 0px; width: 100%; height: auto;';
k.wrapper.style.cssText=h;k.host.style.cssText=l;k.iframe?'none'!==k.iframe.style.display&&'hidden'!==k.iframe.style.visibility&&(k.iframe.style.cssText=`position: relative; display: block; width: ${a}px; height: ${u}px; max-width: none !important; max-height: none !important; overflow: hidden;`):k.image?(k.image.style.cssText=`position: relative; display: block; width: ${a}px; height: ${u}px; max-width: none !important; max-height: none !important; overflow: hidden;`,k.backfaceImage&&!this.context.Environment.isSticky&&
(k.backfaceImage.style.cssText=`position: relative; display: block; width: ${a*d}px; height: ${u*d}px; max-width: none !important; max-height: none !important; overflow: hidden;`)):k.canvas&&(n=`position: relative; display: block; width: ${a}px; height: ${u}px; max-width: none !important; max-height: none !important; overflow: hidden;`,'blurred-video'===f.mode&&(n+=`filter: blur(${f.intensity}px);`,n+=`backdrop-filter: blur(${f.intensity}px);`,this.isOverlayBlurredVideo(f)&&(this.context.overlayContainerBackground&&
(this.context.overlayContainerBackground.style.cssText+='background-color: transparent;'),n+='position: fixed; top: 0; left: 0; width: 100%; height: 100%;')),k.canvas.style.cssText=n,this.context.Environment.isZoom&&(this.adCore.backfaceCanvas.style.cssText=`${`position: relative; display: block; width: ${a*d}px; height: ${u*d}px; max-width: none !important; max-height: none !important; overflow: hidden;`}`));!this.adConfig.display.useFullSpace||'html5'!==f.mode&&'redirect'!==f.mode||(this.context.Environment.isSitebar||
this.context.Environment.isMysteryAd?(k.container.style.height='100%',k.wrapper.style.height='100%',k.wrapper.style.width='100%',k.host.style.height='100%',k.host.style.width='100%',k.host.style.transform='scale(1)',k.iframe&&(k.iframe.style.width='100%',k.iframe.style.height='100%')):this.context.Environment.isUnderstitial&&(k.wrapper.style.width='100%',k.host.style.width='100%',k.host.style.height=`${this.context.Environment.scaledHeight}px`,k.host.style.transform='scale(1)',k.iframe&&(k.iframe.style.height=
'100%')))}else this.logger.log(`Set dimension - SKIP ${g} creative because of unsupported mode '${f.mode}'`,{configCreative:f});else this.logger.log(`Set dimension - skip ${g} - ${f.mode} creative`,{configCreative:f})}onOrientationChange(a){this.isReady&&this.postProcessAfterInsertAd()}onResize(a){this.isReady&&this.postProcessAfterInsertAd()}postProcessAfterInsertAd(a){const {Environment:c}=this.context,{display:{injectInsideIframe:d}}=this.adConfig,{meta:{adSessionId:g}}=this.initConfig,{productTitlePostfix:l}=
this.context,{backfaceContainer:h}=this.context.Environment;this.logger.log('Post process after insert ad - run ...');let n=!0;Object.keys(this.creative).forEach(u=>{this.logger.log(`Post process after insert ad - PROCESS ${u} creative`);const {configCreative:p,creativeDetails:m,trackingMiner:C}=this.adCore.getCreativeOptionDetails(this.creative,u);if(m.container)if(m.alreadyInserted)this.logger.log(`Post process after insert ad - SKIP ${u} creative because it was already inserted`,{configCreative:p});
else{if(this.context.Environment.isZoom&&['portrait','landscape'].includes(u)&&'static-image'===p.mode&&h&&'boolean'===typeof m.backfaceImage&&!m.backfaceImage){var t='';let a='';t=k(p.imageUrl);a=k(p.clickUrl);a=this.adCore.replaceMacros(a);t?(t=new r.b(this.context,t,!0),t.node.id=`yoc_backface_image_${u}_${l}_${g}`,h.append(t.node),m.backfaceImage=t.node,h.setAttribute(f.a.CLICK,f.b.ENABLED),h.setAttribute(f.a.CLICK_STATUS,f.b.WAITING),h.setAttribute(f.a.CLICK_GOAL,'click'),h.setAttribute(f.a.AD_SESSION_ID,
this.initConfig.meta.adSessionId),this.context.setupClickHandler(h,b=>{this.logger.log(`Handle CLICK on backface ${u} image creative`,{configCreative:p});c.isVideo?this.logger.log('This is video ad, not processing click on backface image creative'):((b=a)?(Object(q.a)(this.context,b),h.setAttribute(f.a.CLICK_STATUS,f.b.FINISHED),h.setAttribute(f.a.CLICK_SUCCESS,'click')):(h.setAttribute(f.a.CLICK_STATUS,f.b.FINISHED),h.setAttribute(f.a.CLICK_SUCCESS,'click-error')),this.wasClicked?(h.setAttribute(f.a.CLICK_SUCCESS,
'click-repeated'),this.context.messageBus.event.emit({kind:'tracker',event:'click-repeated',details:{source:`adcreative-backface-${u}`}})):(h.setAttribute(f.a.CLICK_SUCCESS,'click'),this.context.messageBus.event.emit({kind:'tracker',event:'click',details:{source:`adcreative-backface-${u}`}})),this.wasClicked=!0,this.setRepeatedFastClickStatus())})):this.logger.log(`Skip backface ${u} image creative - URL is missing`,{configCreative:p})}if(u===c.creativeOption||u===a&&void 0!==a){if(this.logger.log(`Post process after insert ad - ${u} - ${p.mode} creative`,
{configCreative:p}),'static-image'!==p.mode)if('html5'===p.mode){t='';try{p.useCreativeCodeInstead?(this.logger.log('useCreativeCodeInstead is set, using creative code from InitConfig'),t=decodeURIComponent(this.initConfig.creativeCode)):t=decodeURIComponent(p.html5Url)}catch(fa){this.logger.error(fa)}if(t){t=this.adCore.replaceMacros(t);try{d?m.iframe&&(m.iframe.contentWindow||m.iframe.contentDocument)&&(m.iframe.src=t,m.alreadyInserted=!0):fetch(t).then(a=>a.text()).then(a=>{m.div.innerHTML=a;m.alreadyInserted=
!0}).catch(a=>{this.logger.error('Error during fetching creative content (HTML5 URL)');this.context.messageBus.event.emit({kind:'tracker',event:'error-html5-add'})})}catch(fa){this.logger.error('Error during creative content handling (HTML5 URL)'),this.context.messageBus.event.emit({kind:'tracker',event:'error-html5-add'})}}}else if('redirect'===p.mode||'redirect-use-rtb'===p.mode||'redirect-load-rtb-hidden'===p.mode){let a=t='';try{'redirect'===p.mode?p.useCreativeCodeInstead?(this.logger.log('useCreativeCodeInstead is set, using creative code from InitConfig'),
t=decodeURIComponent(this.initConfig.creativeCode)):t=decodeURIComponent(p.redirectCode):'redirect-use-rtb'===p.mode?(p.useCreativeCodeInstead&&(this.logger.log(`useCreativeCodeInstead not allowed for ${p.mode}`),p.useCreativeCodeInstead&&this.context.messageBus.event.emit({kind:'tracker',event:'creative-misconfiguration-creative-code'})),t=decodeURIComponent(this.initConfig.creativeCode)):'redirect-load-rtb-hidden'===p.mode&&(p.useCreativeCodeInstead&&(this.logger.log(`useCreativeCodeInstead not allowed for ${p.mode}`),
p.useCreativeCodeInstead&&this.context.messageBus.event.emit({kind:'tracker',event:'creative-misconfiguration-creative-code'})),t=decodeURIComponent(p.redirectCode),a=decodeURIComponent(this.initConfig.creativeCode))}catch(M){this.logger.error(M)}t=this.adCore.replaceMacros(t);a=this.adCore.replaceMacros(a);this.adCore.wasImpressionTrackingAligned&&!this.wasImpressionTrackingAlignedAndInjected&&0>this.adCore.bundle.indexOf('video')&&(this.wasImpressionTrackingAlignedAndInjected=!0,t+=`<img src="${this.initConfig.tracking.impression}" width="0" height="0" style="width: 0px; height: 0px;">`,
this.logger.log('alignImpression is enabled - added the impression tracking',t));c.isVCPM&&(this.logger.log('vCPM is enabled - tracking miner for visible creative started',t),C.visibleCreative=new y(this.context,this.initConfig,this.adConfig,'all',t),C.visibleCreative.collect(),t=C.visibleCreative.creativeContentWithoutTracking,this.logger.log('vCPM is enabled - tracking miner for visible creative finished',t),'redirect-load-rtb-hidden'===p.mode&&(this.logger.log('vCPM is enabled - tracking miner for hidden creative started',
a),C.hiddenCreative=new y(this.context,this.initConfig,this.adConfig,'all',a),C.hiddenCreative.collect(),a=C.hiddenCreative.creativeContentWithoutTracking,this.logger.log('vCPM is enabled - tracking miner for hidden creative finished',a)));if('redirect-load-rtb-hidden'===p.mode&&'string'===typeof a&&0<a.length)if(this.detectDocumentWriteInCreative(a,d),d){if(m.iframeHidden&&(m.iframeHidden.contentWindow||m.iframeHidden.contentDocument))try{var K=`<!DOCTYPE html><head>${this.adConfig.display.useFriendlyIframe?
'<script>var inDapIF=true;\x3c/script>':''}
                                            ${c.isMRAID?B.f:''}</head><body style="margin:0;padding:0;">${a}</body></html>`,A=m.iframeHidden.contentDocument||m.iframeHidden.contentWindow.document;A.open();A.close();m.iframeHidden.contentWindow.contents=K;m.iframeHidden.src='javascript:window["contents"]'}catch(M){this.logger.error('Error during creative content handling (redirect code hidden)'),this.context.messageBus.event.emit({kind:'tracker',event:'error-redirect-add-hidden'})}}else this.injectCreativeToDiv(m.divHidden,
a);c.isVCPM&&'enabled'===this.adConfig.creativeWrapper.ge&&(this.logger.log("vCPM is enabled and creative wrapper 'ge' was enabled - creative wrapper is now disabled"),this.adConfig.creativeWrapper.ge='disabled',this.context.messageBus.event.emit({kind:'tracker',event:'creative-wrapper-disabled-ge'}));this.initConfig.meta.visx||'enabled'!==this.adConfig.creativeWrapper.ge||(this.logger.log("Ad is not delivered via VIS.X and creative wrapper 'ge' was enabled - creative wrapper is now disabled"),this.adConfig.creativeWrapper.ge=
'disabled');this.initConfig.meta.io&&'enabled'===this.adConfig.creativeWrapper.ge&&(this.logger.log("Ad is delivered via VIS.X ad server and creative wrapper 'ge' was enabled - creative wrapper is now disabled"),this.adConfig.creativeWrapper.ge='disabled');this.initConfig.meta.om||'enabled'!==this.adConfig.creativeWrapper.ge||(this.logger.log("Ad is not from open market (a deal) and creative wrapper 'ge' was enabled - creative wrapper is now disabled"),this.adConfig.creativeWrapper.ge='disabled');
if(t){this.detectDocumentWriteInCreative(t,d);if('app'!==this.initConfig.meta.inventoryType||'hidden'!==u||'redirect'!==p.mode||'takeoverInlineAndHidden'!==this.adConfig.display.effect&&'takeoverUnderstitialMiniAndHidden'!==this.adConfig.display.effect||'disabled'===this.adConfig.creative.hidden.mode)if(d){({creativeWrapper:{ge:K}}=this.adConfig);if('enabled'===K||'force-enabled'===K){const {creativeWrapperGEPre:a,creativeWrapperGEPost:b}=this.getCreativeWrapperGE();t=`${a}${t}${b}`}try{var x=`<!DOCTYPE html><head>${this.adConfig.display.useFriendlyIframe?
'<script>var inDapIF=true;\x3c/script>':''}${c.isMRAID?B.f:''}</head><body style="margin:0;padding:0;">${t}</body></html>`,w=m.iframe.contentDocument||m.iframe.contentWindow.document;w.open();w.close();m.iframe.contentWindow.contents=x;m.iframe.src='javascript:window["contents"]'}catch(M){this.logger.error('Error during creative content handling (redirect code)'),this.context.messageBus.event.emit({kind:'tracker',event:'error-redirect-add'})}}else this.injectCreativeToDiv(m.div,t);else{this.logger.log(`Post process after insert ad - YBT in-app ${u} - ${p.mode} - take over to the VIS.X SDK`,
{configCreative:p,creativeRedirectCode:t});n=!1;x=p.width;w=p.height;this.context.Environment.isMRAID&&(K=Object(U.j)(),A=1,K&&(A=this.context.Environment.getStickyScaleFactor(x,w,K.width,K.height,!1),x=Math.floor(x*A),w=Math.floor(w*A)));try{Object(b.a)(t)&&-1<t.indexOf("'showDismissButton':'1'")&&(t=t.replace("'showDismissButton':'1'","'showDismissButton':'0'"))}catch(M){}Object(U.t)(t,x,w,'linear','rising-up')}m.alreadyInserted=!0}n&&'undefined'!==typeof this.adConfig.thirdParty.creativeSource[u]&&
'disabled'!==this.adConfig.thirdParty.creativeSource[u]&&m.thirdPartyAd.run(m.iframe)}else'blurred-video'===p.mode?(this.logger.log(`Post process after insert ad - ${u} - ${p.mode} creative`,{configCreative:p}),m.alreadyInserted=!0):this.logger.log(`Post process after insert ad - SKIP ${u} - ${p.mode} creative because of unsupported mode '${p.mode}'`,{configCreative:p})}else this.logger.log(`Post process after insert ad - SKIP ${u} - ${p.mode} creative for now, because not needed yet`,{configCreative:p})}});
this.postProcessAfterInsertAdForFeature(a);this.isReady=!0}postProcessAfterInsertAdForFeature(a){}returnToOriginalPosition(a){}dispose(){const {Environment:a}=this.context;this.logger.debug('dispose');if(this.context.Environment.isZoom){const a=this.context.Environment.adUnitContainer;a&&r.f(a)}window.clearTimeout(this.fallbackCloseButtonAddTimeoutId);this.repeatedFastClickTimeoutId&&this.context.Environment.hostWindow.clearTimeout(this.repeatedFastClickTimeoutId);this.understitialPaintHandler.dispose();
this.closeAdButton&&this.closeAdButton.timeoutId&&(this.logger.log('AdCreative Close Button clearTimeout',{timeoutId:this.closeAdButton.timeoutId}),a.hostWindow.clearTimeout(this.closeAdButton.timeoutId));this.stickyCloseAdButton&&this.stickyCloseAdButton.timeoutId&&(this.logger.log('AdCreative Sticky Close Button clearTimeout',{timeoutId:this.stickyCloseAdButton.timeoutId}),a.hostWindow.clearTimeout(this.stickyCloseAdButton.timeoutId));this.handleTakeoverEnableAnimationEndTimeoutId&&a.hostWindow.clearTimeout(this.handleTakeoverEnableAnimationEndTimeoutId);
this.handleTakeoverDisableAnimationEndTimeoutId&&a.hostWindow.clearTimeout(this.handleTakeoverDisableAnimationEndTimeoutId);Object.keys(this.creative).forEach(a=>{const {configCreative:b,creativeDetails:c}=this.adCore.getCreativeOptionDetails(this.creative,a);'static-image'===b.mode?(c.image&&c.image.remove(),c.backfaceImage&&c.backfaceImage.remove()):'html5'===b.mode||'redirect'===b.mode||'redirect-use-rtb'===b.mode||'redirect-load-rtb-hidden'===b.mode?(c.iframe&&c.iframe.remove(),c.div&&c.div.remove()):
'blurred-video'===b.mode&&c.canvas&&c.canvas.remove();c.container&&(c.container.remove(),c.container=!1);c.wrapper&&(c.wrapper.remove(),c.wrapper=!1);c.host&&(c.host.remove(),c.host=!1)});this.animation&&this.animation.dispose();this.disposeForFeature()}disposeForFeature(){}removeCloseAdButton(){if('creative'===this.adCore.bundle||this.adCore.bundle.startsWith('creative-feature-'))this.closeAdButton&&(this.closeAdButton.root&&this.emitOverlay({kind:B.j,element:this.closeAdButton.root}),delete this.closeAdButton),
this.stickyCloseAdButton&&(this.stickyCloseAdButton.root&&this.emitOverlay({kind:B.j,element:this.stickyCloseAdButton.root}),delete this.stickyCloseAdButton)}shouldAddCloseButton(){const {Environment:a,initConfig:{meta:{inventoryType:b}}}=this.context,{mode:c}=this.adConfig.closeButton;return(('creative'===this.adCore.bundle||this.adCore.bundle.startsWith('creative-feature-'))&&(!a.isSticky&&('enabled'===c||'only-inline'===c)||a.isSitebar&&'only-sticky'===c)||a.isSticky&&('enabled'===c||'only-sticky'===
c))&&!(!1===a.MRAIDUseCustomClose&&'app'===b)}addCloseAdButton(){const {Environment:a}=this.context,{placement:b,position:c}=this.adConfig.closeButton;var g=a.isMRAID||a.isSitebar?B.e:b;if(this.shouldAddCloseButton()){const b=new A.a(this.context,this.adConfig,this.initConfig,this.closeAd);this.closeAdButton=b;b.root&&this.emitOverlay({kind:B.a,element:b.root,preferredPosition:c||A.a.defaultPosition||'top-right',placement:g,isSticky:a.isBrandedTakeoverSticky,type:'close',applyLeftRightMargin:this.adConfig.display.alignProductContainer?
!1:!0})}a.isBrandedTakeoverSticky&&(this.stickyCloseAdButton=g=new A.a(this.context,this.adConfig,this.initConfig,this.closeStickyAd,a.isBrandedTakeoverSticky),g.root&&this.emitOverlay({kind:B.a,element:g.root,preferredPosition:c||A.a.defaultPosition||'top-right',parent:this.context.productStickyContainer,isSticky:a.isBrandedTakeoverSticky,type:'close',applyLeftRightMargin:!0}))}addFallbackCloseAdButton(){const {Environment:a}=this.context,{effect:b}=this.adConfig.display;a.isMRAID&&'fullscreenOverlay'===
b&&this.handleInAppCloseButton()}onSticky(){this.logger.debug('onSticky');this.postProcessAfterInsertAd();this.removeCloseAdButton();this.addCloseAdButton()}onTakeoverEnable(a){this.logger.log(`onTakeoverEnable - ${a}`);if(this.isReady){const {configCreative:b,creativeDetails:c}=this.adCore.getCreativeOptionDetails(this.creative,a);if('app'===this.initConfig.meta.inventoryType&&'redirect'===b.mode)if(this.logger.log(`onTakeoverEnable - IN-APP - ${a}`),c.alreadyInserted){this.logger.log(`onTakeoverEnable - IN-APP - ${a} - already inserted - take over to the VIS.X SDK`);
a=b.width;let c=b.height;if(this.context.Environment.isMRAID){const b=Object(U.j)();let d=1;b&&(d=this.context.Environment.getStickyScaleFactor(a,c,b.width,b.height,!1),a=Math.floor(a*d),c=Math.floor(c*d))}Object(U.t)('',a,c,'linear','rising-up')}else this.logger.log(`onTakeoverEnable - IN-APP - ${a} - not yet inserted`),this.postProcessAfterInsertAd(a);else if(c.thirdPartyAd&&c.thirdPartyAd.thirdPartyHostContainer)this.logger.log(`onTakeoverEnable - ${a} - adding styles`),this.adCore.showTakeoverContainer(c.thirdPartyAd.thirdPartyHostContainer);
else if(this.adConfig.takeover.activateImmediately&&'sticky'===this.adCore.takeoverTarget&&this.isBrandedTakeoverStickyCreative(a)&&this.context.productStickyContainer){this.logger.log(`onTakeoverEnable - ${a} - enable takeover`);if('disabled'!==this.adConfig.creative.sticky.mode)this.context.Environment.onStickyShow('sticky');else this.context.Environment.onStickyShow();this.adAssetList.forEach(a=>{a.onSticky()});this.updateStyles({updateAdPosition:!0,reset:!1});this.adPainter.updateAdPosition(this.adPainter.adVisibilityDetails);
this.context.messageBus.event.emit({kind:'sticky'});this.adCore.showTakeoverContainer(this.context.productStickyContainer)}else this.logger.log(`onTakeoverEnable - ${a} - post process after insert ad`),this.postProcessAfterInsertAd(a)}else this.logger.log(`onTakeoverEnable - ${a} - creative is not yet ready`)}onTakeoverDisable(a){this.logger.log(`onTakeoverDisable - ${a}`);if(this.isReady){const {configCreative:b,creativeDetails:c}=this.adCore.getCreativeOptionDetails(this.creative,a);'app'===this.initConfig.meta.inventoryType&&
'redirect'===b.mode?(this.logger.log(`onTakeoverDisable - IN-APP - ${a}`),c.alreadyInserted?(this.logger.log(`onTakeoverDisable - IN-APP - ${a} - already inserted - take over to the VIS.X SDK`),Object(U.m)('linear','rising-up')):this.logger.log(`onTakeoverDisable - IN-APP - ${a} - not yet inserted`)):c.thirdPartyAd&&c.thirdPartyAd.thirdPartyHostContainer?(this.logger.log(`onTakeoverDisable - ${a} - adding styles`),this.adCore.hideTakeoverContainer(c.thirdPartyAd.thirdPartyHostContainer)):this.adConfig.takeover.activateImmediately&&
'sticky'===this.adCore.takeoverTarget&&this.adCore.isStickyBrandedTakeover()&&this.context.productStickyContainer?(this.logger.log(`onTakeoverEnable - ${a} - disable takeover`),this.adCore.hideTakeoverContainer(this.context.productStickyContainer),this.context.Environment.onStickyHide(this.context.Environment.isPortrait?'portrait':'landscape'),this.context.messageBus.clickOverlay.emit({kind:B.i})):this.logger.log(`onTakeoverDisable - ${a} - can't find third party ad and corresponding host container`)}else this.logger.log(`onTakeoverDisable - ${a} - creative is not yet ready`)}emitOverlay(a){const {display:{effect:b}}=
this.adConfig;'fullscreenOverlay'===b||this.context.Environment.isSitebar||this.context.Environment.isZoom?this.context.messageBus.elementsOverlay.emit(a):this.context.messageBus.clickOverlay.emit(a)}handleInAppCloseButton(){A.a.image?(this.logger.log('handleInAppCloseButton - closeButton exists'),this.closeAdButton&&!Object(n.a)(A.a.image.node,this.context.Environment)&&(this.logger.log('handleInAppCloseButton - closeButton not in viewport'),this.insertFallbackCloseButton())):(this.logger.log('handleInAppCloseButton - no closeButton added'),
this.insertFallbackCloseButton())}insertFallbackCloseButton(){const {display:{zIndex:a=2}}=this.adConfig;this.logger.log('insertFallbackCloseButton');const b=new A.a(this.context,this.adConfig,this.initConfig,this.closeAd);b.root.style.cssText=`display: block; position: absolute; z-index:${a}; top: 5vh; left: 5vw;`;this.context.productContainer.appendChild(b.root)}isOverlayBlurredVideo(a){const {display:{effect:b}}=this.adConfig;return'fullscreenOverlay'===b&&'creative-video'===this.context.bundle&&
'blurred-video'===a.mode}injectCreativeToDiv(a,b){try{const c=document.createRange().createContextualFragment(b);a.appendChild(c)}catch(p){this.logger.error('Error during creative content handling (redirect code)'),this.context.messageBus.event.emit({kind:'tracker',event:'error-redirect-add'})}}getCreativeWrapperGE(){const {display:{width:a,height:b}}=this.adConfig,{meta:{adUnitId:c,dspId:g,dspName:f,creativeId:k,publisherId:h}}=this.initConfig;try{const d=`<div id="grumi-container"><script type="text/javascript" nonce="!headerNonce!">!function(d,i){var p={wver:"1.1.3",wtype:"dfp",key:"c41ea7b0-7b8a-4bcc-9876-4a9f25cab255",meta:{adup:"${c}",dest:"",w:"${a}",h:"${b}",li:"",adv:"",ord:"",cr:"",aduid:"",haduid:"",isAfc:"",isAmp:"",qid:"",cust_imp:"",cust1:"",cust2:"",cust3:"",caid:"",di:"${g}",dn:"${f}",dcid:"${k}",pid:"${h}",pn:"",adElId:""},sp:"dfp",cfg:{},pbAdId:"",pbAdIdAst:"",pbBidder:"",hbPb:"",hbCid:"",site:"",pimp:""};window.grumi=p}();</script><template style="display: none;" id="template0"><xmp style="display: none;" id="xmp0">`;
this.context.messageBus.event.emit({kind:'tracker',event:'creative-wrapper-setup-done-ge'});return{creativeWrapperGEPre:d,creativeWrapperGEPost:'</xmp></template><script type="text/javascript" nonce="!footerNonce!">!function(n){var e,o=window.grumi.key,i=window.grumi,r=i&&i.wtype&&"gpt"===i.wtype,a=1*new Date,d=navigator.userAgent&&navigator.userAgent.match(/\\b(MSIE |Trident.*?rv:|Edge\\/)(\\d+)/);function t(){var e=function(){for(var e,t=document.getElementsByTagName("template"),n=t.length-1;0<=n;n--)if("template0"===t[n].id){e=t[n];break}return e}();return e.content?e.content.getElementById?e.content.getElementById("xmp0"):e.content.childNodes[0]:e.getElementsByTagName("xmp")[0]}function u(e,t){t=t||!1,top.postMessage&&top.postMessage({evType:e||"",key:i.key,adup:i.meta.adup,html:window.grumi?window.grumi.tag:"",el:i.meta.adElId,refresh:t},"*")}function w(e,t){var n="",o=d&&"complete"===document.readyState;window.grumi&&(window.grumi.fsRan=!0,n=window.grumi.tag),o||(window.document.open(),window.document.write(n),window.document.close()),((t=t||!1)||o)&&u(e,o)}function c(e,n){return function(){var t=setTimeout(function(){var e=document.getElementById(a);e&&null===function(e){if(void 0!==e.nextElementSibling)return e.nextElementSibling;for(var t=e.nextSibling;t&&1!==t.nodeType;)t=t.nextSibling;return t}(e)&&n&&n(),clearTimeout(t)},e)}}c(5e3,function(){w()})(),c(2e3,function(){u("slwCl")})(),window.grumi.tag=(e=t())&&e.innerHTML,window.grumi.scriptHost=n,window.parent&&window.parent.postMessage&&window.parent.postMessage({iw:!0,key:i.key,adup:i.meta.adup,el:i.meta.adElId},"*"),function(){var e=document.createElement("script");e.type="text/javascript",e.src=n+o+"/grumi.js",e.className="rm",e.id=a,r&&!d&&(e.async=!0);var t="_"+1*new Date;window[t]=function(){w("netErr",!0)},window.grumi.start=1*new Date;try{window.document.write(e.outerHTML.replace(\'class="rm"\',\'onerror="\'+t+\'();"\'))}catch(e){w()}}()}(("http"===window.location.protocol.substr(0,4)?window.location.protocol:"https:")+"//rumcdn.geoedge.be/");\x3c/script></div>'}}catch(ia){return this.logger.error('Error during creative wrapper setup (ge)'),
this.context.messageBus.event.emit({kind:'tracker',event:'creative-wrapper-setup-error-ge'}),{creativeWrapperGEPre:'',creativeWrapperGEPost:''}}}detectDocumentWriteInCreative(a,b){try{a.includes('document.write')&&(this.logger.log('document.write found in creative'),this.context.messageBus.event.emit({kind:'tracker',event:'document-write-found',details:{injectInsideIframe:b}}))}catch(p){this.logger.error('Error during detection of document.write in creative',p)}}isBrandedTakeoverStickyCreative(a){const {display:{effect:b}}=
this.adConfig;return B.o.includes(b)&&'sticky'===a}setRepeatedFastClickStatus(){try{this.logger.log('setRepeatedFastClickStatus - set status'),this.wasRepeatedFastClick=!0,this.repeatedFastClickTimeoutId=this.context.Environment.hostWindow.setTimeout(()=>{try{this.logger.log('setRepeatedFastClickStatus - reset status'),this.wasRepeatedFastClick=!1,this.repeatedFastClickTimeoutId=0}catch(d){this.logger.error('setRepeatedFastClickStatus - error on status reset',d)}},1E3)}catch(d){this.logger.error('setRepeatedFastClickStatus - error on status set',
d)}}}},function(m,c,a){function h(a,c){let f=a;const b=`${c.timestamp}`;c.meta.io&&Object(k.a)(f)&&(f=f.replace("'clickUrl':'%%CLICK_URL_UNESC%%'",`'clickUrl':'${c.tracking.click}${encodeURIComponent(r.h)}'`));const h={percent:'%%',at:'@@'};Object.keys(h).forEach(a=>{f=f.replace(new RegExp(`${h[a]}CLICK_URL_UNESC${h[a]}`,'g'),c.tracking.click);f=f.replace(new RegExp(`${h[a]}CLICK_URL_ESC${h[a]}`,'g'),encodeURIComponent(c.tracking.click));f=f.replace(new RegExp(`${h[a]}CLICK_URL_ESC_ESC${h[a]}`,'g'),
encodeURIComponent(encodeURIComponent(c.tracking.click)));f=f.replace(new RegExp(`${h[a]}CACHEBUSTER${h[a]}`,'g'),b);f=f.replace(new RegExp(`${h[a]}cachebuster${h[a]}`,'g'),b);f=f.replace(new RegExp(`${h[a]}CACHEBUSTING${h[a]}`,'g'),b);f=f.replace(new RegExp(`${h[a]}cachebusting${h[a]}`,'g'),b);f=f.replace(new RegExp(`${h[a]}SITE${h[a]}`,'g'),c.meta.publisherDomain);f=f.replace(new RegExp(`${h[a]}ADVERTISING_IDENTIFIER_PLAIN${h[a]}`,'g'),'')});f=f.replace(new RegExp(decodeURIComponent('%25ecid!'),
'g'),c.meta.creativeId);f=f.replace(new RegExp(decodeURIComponent('%25esid!'),'g'),c.meta.siteId);f=f.replace(new RegExp(decodeURIComponent('%25epid!'),'g'),c.meta.adUnitId);f=f.replace(new RegExp(decodeURIComponent('%25ebuy!'),'g'),c.meta.orderId);f=f.replace(new RegExp(decodeURIComponent('%25eaid!'),'g'),c.meta.lineItemId);f=f.replace(new RegExp(decodeURIComponent('%25eadv!'),'g'),c.meta.advertiserId);f=f.replace(new RegExp(decodeURIComponent('%5C%5BTIMESTAMP%5C%5D'),'g'),b);f=f.replace(new RegExp(decodeURIComponent('%5C%5Btimestamp%5C%5D'),
'g'),b);try{f=f.replace(/\$\{GDPR\}/gim,c.gdpr.applied);const a=f.match(/\$\{GDPR_CONSENT_(.*?)\}/gim);a&&a.forEach(a=>{a=a.replace('${','\\$\\{').replace('}','\\}');f=f.replace(new RegExp(a,'g'),c.gdpr.consent)})}catch(y){}try{f=f.replace(/%%ADSESSIONID%%/g,c.meta.adSessionId)}catch(y){}return f}a.d(c,'a',function(){return h});var k=a(9),r=a(2)},function(m,c,a){function h(a){let c=!0;({context:a}=a);a&&'function'===typeof a.observeIntersection||(c=!1);return c}function k(a){return a.context&&a.context.location&&
a.context.location.href||null}function r(a){return a.context&&a.context.location&&a.context.location.host||null}a.d(c,'c',function(){return h});a.d(c,'b',function(){return k});a.d(c,'a',function(){return r})},function(m,c,a){function h(){return/i(Pod|Phone|Pad)/.test(navigator.platform)}a.d(c,'a',function(){return h})},function(m,c,a){a.d(c,'a',function(){return Z});c='function'===typeof atob;var h='function'===typeof btoa;a='function'===typeof Buffer;const k='function'===typeof TextDecoder?new TextDecoder:
void 0,r='function'===typeof TextEncoder?new TextEncoder:void 0,f=[...'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='],q=(a=>{let b={};a.forEach((a,c)=>b[a]=c);return b})(f),n=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,b=String.fromCharCode.bind(String),C='function'===typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(a,b)=>{b=void 0===b?a=>a:b;return new Uint8Array(Array.prototype.slice.call(a,0).map(b))},y=a=>a.replace(/[+\/]/g,a=>'+'==a?
'-':'_').replace(/=+$/m,'');m=a=>{var b;let c,d,g='';const k=a.length%3;for(let k=0;k<a.length;){if(255<(b=a.charCodeAt(k++))||255<(c=a.charCodeAt(k++))||255<(d=a.charCodeAt(k++)))throw new TypeError('invalid character found');b=b<<16|c<<8|d;g+=f[b>>18&63]+f[b>>12&63]+f[b>>6&63]+f[b&63]}return k?g.slice(0,k-3)+'==='.substring(k):g};const A=h?a=>btoa(a):a?a=>Buffer.from(a,'binary').toString('base64'):m,B=a?a=>Buffer.from(a).toString('base64'):a=>{let c=[];for(let d=0,g=a.length;d<g;d+=4096)c.push(b.apply(null,
a.subarray(d,d+4096)));return A(c.join(''))},t=(a,b)=>(void 0===b?0:b)?y(B(a)):B(a),l=a=>{if(2>a.length){var c=a.charCodeAt(0);return 128>c?a:2048>c?b(192|c>>>6)+b(128|c&63):b(224|c>>>12&15)+b(128|c>>>6&63)+b(128|c&63)}c=65536+1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320);return b(240|c>>>18&7)+b(128|c>>>12&63)+b(128|c>>>6&63)+b(128|c&63)},x=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,S=a?a=>Buffer.from(a,'utf8').toString('base64'):r?a=>B(r.encode(a)):a=>A(a.replace(x,l)),L=(a,b)=>(void 0===
b?0:b)?y(S(a)):S(a);h=a=>L(a,!0);const D=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,O=a=>{switch(a.length){case 4:return a=((7&a.charCodeAt(0))<<18|(63&a.charCodeAt(1))<<12|(63&a.charCodeAt(2))<<6|63&a.charCodeAt(3))-65536,b((a>>>10)+55296)+b((a&1023)+56320);case 3:return b((15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2));default:return b((31&a.charCodeAt(0))<<6|63&a.charCodeAt(1))}},g=a=>{a=a.replace(/\s+/g,'');if(!n.test(a))throw new TypeError('malformed base64.');
a+='=='.slice(2-(a.length&3));let c,d='',g,f;for(let k=0;k<a.length;)c=q[a.charAt(k++)]<<18|q[a.charAt(k++)]<<12|(g=q[a.charAt(k++)])<<6|(f=q[a.charAt(k++)]),d+=64===g?b(c>>16&255):64===f?b(c>>16&255,c>>8&255):b(c>>16&255,c>>8&255,c&255);return d},w=c?a=>atob(a.replace(/[^A-Za-z0-9\+\/]/g,'')):a?a=>Buffer.from(a,'base64').toString('binary'):g,P=a?a=>C(Buffer.from(a,'base64')):a=>C(w(a),a=>a.charCodeAt(0)),T=a?a=>Buffer.from(a,'base64').toString('utf8'):k?a=>k.decode(P(a)):a=>w(a).replace(D,O),X=a=>
a.replace(/[-_]/g,a=>'-'==a?'+':'/').replace(/[^A-Za-z0-9\+\/]/g,'');c=a=>T(X(a));const U=a=>({value:a,enumerable:!1,writable:!0,configurable:!0}),Y=function(){const a=(a,b)=>Object.defineProperty(String.prototype,a,U(b));a('fromBase64',function(){return T(X(this))});a('toBase64',function(a){return L(this,a)});a('toBase64URI',function(){return L(this,!0)});a('toBase64URL',function(){return L(this,!0)});a('toUint8Array',function(){return P(X(this))})},ca=function(){const a=(a,b)=>Object.defineProperty(Uint8Array.prototype,
a,U(b));a('toBase64',function(a){return t(this,a)});a('toBase64URI',function(){return t(this,!0)});a('toBase64URL',function(){return t(this,!0)})},Z={version:'3.6.0',VERSION:'3.6.0',atob:w,atobPolyfill:g,btoa:A,btoaPolyfill:m,fromBase64:c,toBase64:L,encode:L,encodeURI:h,encodeURL:h,utob:a=>a.replace(x,l),btou:a=>a.replace(D,O),decode:c,isValid:a=>{if('string'!==typeof a)return!1;a=a.replace(/\s+/g,'').replace(/=+$/,'');return!/[^\s0-9a-zA-Z\+/]/.test(a)||!/[^\s0-9a-zA-Z\-_]/.test(a)},fromUint8Array:t,
toUint8Array:a=>P(X(a)),extendString:Y,extendUint8Array:ca,extendBuiltins:()=>{Y();ca()}}},function(m,c,a){function h(a){a.__YOC=a.__YOC||[];a.__YOC.session=a.__YOC.session||{};a.__YOC.block=a.__YOC.block||{};a.__YOC.refresh=a.__YOC.refresh||{};a.__YOC.bundle=a.__YOC.bundle||{}}a.d(c,'a',function(){return h})},function(m,c,a){let h=!1;try{m={get passive(){h=!0;return!1}},window.addEventListener('test',null,m),window.removeEventListener('test',null,m)}catch(k){}c.a=h},function(m,c,a){function h(a,
c){const {hostWindow:f,viewportHeight:k,viewportWidth:h}=c,{top:b,bottom:m,right:r,left:A}=a.getBoundingClientRect();a=f.document.documentElement;return 0<=b&&0<=A&&m<=(k||a.clientHeight)&&r<=(h||a.clientWidth)}a.d(c,'a',function(){return h})},function(m,c,a){function h(a,c){if('scale'!==c.display.buttonScale)return 1;a=a.getDeviceSize();return'small'===a?.9:'medium'===a?1.2:1.4}a.d(c,'a',function(){return h})},function(m,c,a){var h=Array.isArray,k=Object.keys,r=Object.prototype.hasOwnProperty;m.exports=
function b(a,c){if(a===c)return!0;if(a&&c&&'object'==typeof a&&'object'==typeof c){var m=h(a),q=h(c);if(m&&q){var n=a.length;if(n!=c.length)return!1;for(m=n;0!==m--;)if(!b(a[m],c[m]))return!1;return!0}if(m!=q)return!1;m=a instanceof Date;q=c instanceof Date;if(m!=q)return!1;if(m&&q)return a.getTime()==c.getTime();m=a instanceof RegExp;q=c instanceof RegExp;if(m!=q)return!1;if(m&&q)return a.toString()==c.toString();q=k(a);n=q.length;if(n!==k(c).length)return!1;for(m=n;0!==m--;)if(!r.call(c,q[m]))return!1;
for(m=n;0!==m--;)if(n=q[m],!b(a[n],c[n]))return!1;return!0}return a!==a&&c!==c}},function(m,c,a){function h(a){const e=t.e(a,'div');e.style.width='1000px';e.style.overflowY='scroll';({body:a}=a.hostDocument);a.append(e);const b=1E3-e.clientWidth;a.removeChild(e);return b}function k(){return/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)}function r(a){window.top.postMessage(a,'*')}function f(a,b){return parseInt(a.toString(10),10)/parseInt(b.toString(10),10)}function q(a,
b){return'yoc-banner-classic'===a.product.key&&0<b.refresh.timeout&&(!b.refresh.omOnly||b.refresh.omOnly&&a.meta.visx&&a.meta.om)?!0:!1}function n(a,b){let e=0,c=0;const z=a.hostDocument.body.getBoundingClientRect();var d=0,F=0,g=0,f=0,k=z.height;try{a.hostDocument.body.querySelectorAll('*|*:not([id*="yoc"])').forEach(v=>{try{if(v&&(null===v.parentElement||'string'!==typeof v.parentElement.id||-1===v.parentElement.id.toLowerCase().indexOf('yoc'))){const b=v.getBoundingClientRect(),E=b.top-z.top,J=
b.left-z.left;0<b.width&&0<b.height&&(b.width>=d&&b.width<a.viewportWidth&&0<=J&&J<a.viewportWidth&&b.height>F&&(F=b.height,d=b.width,e=J+b.width),0===E&&b.height!==a.viewportHeight&&b.height<k&&b.width>=f&&b.width<=a.viewportWidth&&b.right>=a.viewportWidth/2&&J>=g&&(k=b.height,f=b.width,g=J,c=E+b.height))}}catch(W){b.error('getSitebarPosition elementsList inside forEach',W)}})}catch(G){b.error('getSitebarPosition elementsList',G)}b.log('getSitebarPosition',{leftPosition:e,topPosition:c});return{left:e,
top:c}}function b(a){const {sitebar:{ignorePermittedDimensions:e},placement:{responsive:b}}=a;return e?Object.assign({},b,{maximumPermittedWidth:0,maximumPermittedHeight:0,minimumPermittedHeight:0,minimumPermittedWidth:0}):b}function C(a,b,c){({sitebar:{selectors:a}={}}=a);if(a&&'string'===typeof a[b]&&(c=(c=c.hostDocument.body.querySelector(a[b]))?c.getBoundingClientRect():void 0,c)){if('top'===b)return c.bottom;if('left'===b)return c.right}}function y(a,b){let e;return function(...c){clearTimeout(e);
e=window.setTimeout(()=>{a.apply(this,c)},b)}}function A(a){let e=null;try{for(let b=0;20>b&&a;b++){if('enabled'===a.getAttribute('data-visx-hand-over')){e=a;break}if(a.parentElement)a=a.parentElement;else break}}catch(v){}return e}function B(a){let e=null,b=window,c=null;try{if(e=A(a),!e){for(;b!==window.top;)try{const a=b.parent,v=b.parent.document.getElementsByTagName('iframe');for(let a=0;a<v.length;a++)v[a].contentWindow===b&&(c=v[a],e=A(c));b=a}catch(J){break}e&&c||(e=A(a))}}catch(J){}return e}
a.d(c,'a',function(){return ya});a(29);a(30);a(31);var t=a(1),l=a(2),x=a(3),S=a(21);class L{constructor(a,b,c,E,d){this.displayAsUnderstitialEnabled=!1;this.updateAdPosition=a=>{a=void 0===a?this.adVisibilityDetails:a;this.adjustRootContainer();const {Environment:e}=this.context;this.adVisibilityDetails=a;({display:{effect:a}}=this.adConfig);this.logger.log(`updateAdPosition() Ad is visible for ${100*this.adVisibilityDetails.visibilityPercentage}% (Position: ${this.adVisibilityDetails.top}x${this.adVisibilityDetails.left} - ${this.adVisibilityDetails.bottom}x${this.adVisibilityDetails.right} - Dimension: ${this.adVisibilityDetails.width}x${this.adVisibilityDetails.height}) (${this.adVisibilityDetails.bottom-
e.viewportHeight})`);this.advertisementMessageAboveContainer.style.height=`${this.advertisementMessageAboveWrapper.clientHeight}px`;this.advertisementMessageBelowContainer.style.height=`${this.advertisementMessageBelowWrapper.clientHeight}px`;this.advertisementMessageAboveWrapper.style.width=`${e.scaledWidth}px`;this.advertisementMessageBelowWrapper.style.width=`${e.scaledWidth}px`;const b=['fullscreenOverlay','sitebar'];try{this.context.Environment.rootContainer.parentElement.getBoundingClientRect()}catch(W){this.logger.error(`Can't determine the left position: ${W}`)}if(e.isUnderstitial)if('scale'===
this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.followLayout&&(this.rootContainer.style.overflow='hidden'),('understitialMini'===this.adConfig.display.effect||'understitialMiniToSticky'===this.adConfig.display.effect||'takeoverUnderstitialMiniAndHidden'===this.adConfig.display.effect||'takeoverUnderstitialMiniAndSticky'===this.adConfig.display.effect)&&1<=this.adVisibilityDetails.visibilityY&&(0>=this.adConfig.creative.marginTop||0<this.adConfig.creative.marginTop&&this.adVisibilityDetails.top>=
this.adConfig.creative.marginTop)&&(0>=this.adConfig.creative.marginBottom||0<this.adConfig.creative.marginBottom&&0>=this.adVisibilityDetails.bottom-e.viewportHeight+this.adConfig.creative.marginBottom)){this.displayAsUnderstitialEnabled=!1;this.productContainer.style.clipPath='';this.productContainer.style.webkitClipPath='';this.productContainer.style.mozClipPath='';this.productContainer.style.msClipPath='';this.productContainer.style.oClipPath='';if(!e.supportClipPath||(Object(S.a)()||k())&&e.isVideo)this.productContainer.style.clip=
'',this.backgroundContainer.style.transform='';this.backgroundContainer.style.position='absolute';e.isSticky||(this.backgroundContainer.style.width=`${e.scaledWidth}px`,this.backgroundContainer.style.left='scale'!==this.adConfig.display.responsive.mode||this.adConfig.display.responsive.followLayout?'scale'===this.adConfig.display.responsive.mode?`${parseInt(((e.availableWidth-e.scaledWidth)/2).toString(),10).toString()}px`:'0px':`${parseInt(((e.viewportWidth-e.scaledWidth)/2).toString(),10).toString()}px`);
this.context.messageBus.event.emit({kind:'understitial',enabled:!1})}else{this.displayAsUnderstitialEnabled=!0;this.productContainer.style.clipPath='inset(0)';this.productContainer.style.webkitClipPath='inset(0)';this.productContainer.style.mozClipPath='inset(0)';this.productContainer.style.msClipPath='inset(0)';this.productContainer.style.oClipPath='inset(0)';if(!e.supportClipPath||(Object(S.a)()||k())&&e.isVideo)this.productContainer.style.clip='rect(auto, auto, auto, auto)',this.backgroundContainer.style.transform=
'translateZ(0px)';this.backgroundContainer.style.position='fixed';if(!e.isSticky)if(this.adConfig.display.understitialFollowLayout){var c=this.context.Environment.rootContainer.parentElement.getBoundingClientRect(),v=c.width/c.height,z=e.scaledWidth/(e.scaledHeight+e.getAdMessagesHeight());v<=z?(this.backgroundContainer.style.left=`${c.left}px`,this.backgroundContainer.style.width=`${c.width}px`):(v=c.height*z,z=(c.width-v)/2,this.backgroundContainer.style.width=`${v}px`,this.backgroundContainer.style.left=
`${c.left+z}px`)}else this.backgroundContainer.style.width=`${e.scaledWidth}px`,this.backgroundContainer.style.left=`${parseInt(((e.viewportWidth-e.scaledWidth)/2).toString(),10).toString()}px`;this.context.messageBus.event.emit({kind:'understitial',enabled:!0})}else e.isSticky||(this.backgroundContainer.style.position='absolute',this.backgroundContainer.style.width=`${e.scaledWidth}px`,this.backgroundContainer.style.left='scale'!==this.adConfig.display.responsive.mode||this.adConfig.display.responsive.followLayout?
'scale'===this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.followLayout?`${parseInt(((e.availableWidth-e.scaledWidth)/2).toString(),10).toString()}px`:`${parseInt(((e.availableWidth-e.usedWidth)/2).toString(),10).toString()}px`:`${parseInt(((e.viewportWidth-e.scaledWidth)/2).toString(),10).toString()}px`);if(e.isBrandedTakeoverSticky&&({creative:c}=this.adConfig,c=c.sticky,'html5'===c.mode||'redirect'===c.mode||'redirect-load-rtb-hidden'===c.mode||'static-image'===c.mode||'blurred-video'===
c.mode)){const {scaledWidth:a,viewportWidth:b}=e.getDimensions(c.width,c.height,!0);c=`${parseInt(((b-a)/2).toString(),10).toString()}px`;e.rootStickyContainer.style.left=c}this.context.Environment.adUnitContainer&&(this.context.Environment.adUnitContainer.style.position='relative');e.isZoom&&!e.isSticky?(this.rootContainer.style.position='relative',this.rootContainer.style.right='',this.rootContainer.style.left='',this.rootContainer.style.top='',this.rootContainer.style.bottom='',t.f(this.context.Environment.backfaceContainer),
(this.adConfig.placement.responsive.maximumPermittedWidth||this.adConfig.placement.responsive.maximumPermittedHeight||'scale'===this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.maximumWidth||'scale'===this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.maximumHeight)&&this.context.Environment.backfaceContainer.style.removeProperty('position')):e.isZoom&&e.isSticky&&t.h(this.context.Environment.backfaceContainer);if(e.isSticky){this.contentContainer.style.top=
'';this.contentContainer.style.left='';this.contentContainer.style.width='';this.contentContainer.style.height='';this.productContainer.style.position='relative';this.productContainer.style.top='';this.productContainer.style.left='';this.productContainer.style.width='';this.productContainer.style.height='';this.productContainer.style.clip='';this.productContainer.style.clipPath='';this.backgroundContainer.style.position='relative';this.backgroundContainer.style.transform='';this.backgroundContainer.style.top=
'';this.backgroundContainer.style.bottom='';this.backgroundContainer.style.left='';this.backgroundContainer.style.width='';this.backgroundContainer.style.height='';this.productContainer.style.top='0px';this.productContainer.style.left='0px';this.rootContainer.style.position='fixed';e.isZoom&&this.context.Environment.backfaceContainer?(c=this.context.Environment.backfaceContainer.getBoundingClientRect(),v=this.rootContainer.getBoundingClientRect(),z=c.left,c.width!==v.width&&(z+=(c.width-v.width)/
2),this.rootContainer.style.left=`${z}px`):this.rootContainer.style.left=`${parseInt(((e.viewportWidth-e.scaledWidth)/2).toString(),10).toString()}px`;this.rootContainer.style.right='';this.rootContainer.style.top='';if(e.isZoom&&(this.adConfig.placement.responsive.maximumPermittedWidth||this.adConfig.placement.responsive.maximumPermittedHeight)||'scale'===this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.maximumWidth||'scale'===this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.maximumHeight)c=
this.context.Environment.backfaceContainer.querySelector('img'),this.context.Environment.backfaceContainer.style.position='relative',this.context.Environment.backfaceContainer.style.left=`${(this.context.Environment.availableWidth-c.offsetWidth)/2}px`,this.context.Environment.backfaceContainer.style.width=`${c.offsetWidth}px`;switch(this.adConfig.display.stickyPosition){case 'auto':this.context.Environment.isMovingUp?this.rootContainer.style.top=`${this.adConfig.display.stickyMargin}px`:this.rootContainer.style.bottom=
`${this.adConfig.display.stickyMargin}px`;this.rootContainer.style.zIndex=`${this.adConfig.display.zIndexSticky}`;break;case 'bottom':this.rootContainer.style.bottom=`${this.adConfig.display.stickyMargin}px`;this.rootContainer.style.zIndex=`${this.adConfig.display.zIndexSticky}`;break;case 'top':this.rootContainer.style.top=`${this.adConfig.display.stickyMargin}px`,this.rootContainer.style.zIndex=`${this.adConfig.display.zIndexSticky}`}}else if('scale'===this.adConfig.display.responsive.mode){this.rootContainer.style.width=
'auto';this.rootContainer.style.height='auto';this.contentContainer.style.width='auto';this.contentContainer.style.height=`${e.scaledHeight}px`;if(this.adConfig.display.responsive.useMobileViewportWidth&&this.context.Environment.isDeviceSmartphone){const {viewportWidth:a,rootContainer:e}=this.context.Environment;this.rootContainer.style.width=`${a}px`;0<e.getClientRects()[0].left&&(this.rootContainer.style.left=`-${e.getClientRects()[0].left}px`)}e.isDebugMode&&(this.contentContainer.style.backgroundColor=
'green');this.productContainer.style.position='fullscreenOverlay'===a?'relative':'absolute';this.productContainer.style.top='0px';this.productContainer.style.left='0px';this.productContainer.style.width='100%';this.productContainer.style.height='auto';({left:c}=this.productContainer.getBoundingClientRect());this.adConfig.display.responsive.followLayout||b.includes(a)||(this.productContainer.style.width=`${e.viewportWidth}px`,this.productContainer.style.left=`-${c}px`);e.isUnderstitial?(0<this.adConfig.creative.marginTop?
(this.backgroundContainer.style.top=`${this.adConfig.creative.marginTop+Math.floor((e.viewportHeight-this.adConfig.creative.marginTop-this.adConfig.creative.marginBottom-e.scaledHeight)/2)}px`,this.backgroundContainer.style.bottom=''):0<this.adConfig.creative.marginBottom?(this.backgroundContainer.style.top='',this.backgroundContainer.style.bottom=`${this.adConfig.creative.marginBottom+Math.floor((e.viewportHeight-this.adConfig.creative.marginTop-this.adConfig.creative.marginBottom-e.scaledHeight)/
2)}px`):(this.backgroundContainer.style.top=`${Math.floor((e.viewportHeight-this.adConfig.creative.marginTop-this.adConfig.creative.marginBottom-e.scaledHeight)/2)}px`,this.backgroundContainer.style.bottom=''),'understitialMini'===this.adConfig.display.effect||'takeoverUnderstitialMiniAndSticky'===this.adConfig.display.effect||'understitialMiniToSticky'===this.adConfig.display.effect||'takeoverUnderstitialMiniAndHidden'===this.adConfig.display.effect?(this.contentContainer.style.height=`${e.scaledHeight}px`,
this.productContainer.style.height=`${e.scaledHeight}px`,this.displayAsUnderstitialEnabled&&0<this.adConfig.creative.marginTop?this.adVisibilityDetails.top>=0+this.adConfig.creative.marginTop?(this.backgroundContainer.style.top='',this.backgroundContainer.style.bottom='0px'):(this.backgroundContainer.style.top=`${this.adConfig.creative.marginTop}px`,this.backgroundContainer.style.bottom=''):this.displayAsUnderstitialEnabled&&0<this.adConfig.creative.marginBottom?0<=this.adVisibilityDetails.top?(this.backgroundContainer.style.top=
'',this.backgroundContainer.style.bottom=`${this.adConfig.creative.marginBottom}px`):(this.backgroundContainer.style.top='0px',this.backgroundContainer.style.bottom=''):0<=this.adVisibilityDetails.top?(this.backgroundContainer.style.top='',this.backgroundContainer.style.bottom='0px'):(this.backgroundContainer.style.top='0px',this.backgroundContainer.style.bottom='')):'shiftDown'===this.adConfig.display.effect?(this.contentContainer.style.height=`${this.adConfig.placement.responsive.maximumPermittedHeight}px`,
this.productContainer.style.height=`${this.adConfig.placement.responsive.maximumPermittedHeight}px`,this.backgroundContainer.style.top='0px'):'understitialSizeSmall'===this.adConfig.display.effect?(this.contentContainer.style.height=`${.28*e.viewportHeight}px`,this.productContainer.style.height=`${.28*e.viewportHeight}px`):'understitialSizeMedium'===this.adConfig.display.effect?(this.contentContainer.style.height=`${.6*e.viewportHeight}px`,this.productContainer.style.height=`${.6*e.viewportHeight}px`):
'understitialSizeLarge'===this.adConfig.display.effect?(this.contentContainer.style.height=`${.9*e.viewportHeight}px`,this.productContainer.style.height=`${.9*e.viewportHeight}px`):'understitialSizeCustom'===this.adConfig.display.effect?'pixel'===this.adConfig.display.unit?(this.contentContainer.style.height=`${this.adConfig.display.height}px`,this.productContainer.style.height=`${this.adConfig.display.height}px`):'percent'===this.adConfig.display.unit?(this.contentContainer.style.height=`${e.viewportHeight*
(parseInt(this.adConfig.display.height.toString(),10)/100)}px`,this.productContainer.style.height=`${e.viewportHeight*(parseInt(this.adConfig.display.height.toString(),10)/100)}px`):(this.contentContainer.style.height=`${e.viewportHeight}px`,this.productContainer.style.height=`${e.viewportHeight}px`):(this.contentContainer.style.height=`${e.viewportHeight}px`,this.productContainer.style.height=`${e.viewportHeight}px`),this.adConfig.display.alignProductContainer&&this.displayAsUnderstitialEnabled&&
(this.productContainer.style.width=`${this.context.Environment.scaledWidth}px`,this.productContainer.style.left=`${(this.context.Environment.availableWidth-this.context.Environment.scaledWidth)/2}px`)):this.productContainer.style.height=`${this.context.Environment.scaledHeight}px`;'third-party-ad'===this.initConfig.product.key&&(this.productContainer.style.position='relative',this.productContainer.style.height='auto',this.contentContainer.style.height='auto');e.isZoom&&this.context.Environment.backfaceContainer&&
(this.context.Environment.backfaceContainer.style.width=this.productContainer.style.width,this.context.Environment.backfaceContainer.style.height=this.productContainer.style.height)}b.includes(a)&&(this.productContainer.style.width='100%',this.productContainer.style.height='auto',this.contentContainer.style.height='auto',this.productContainer.style.position='relative');'sitebar'===this.adConfig.display.effect&&'disabled'!==this.adConfig.thirdParty.creativeSource.portrait&&this.adjustRootContainer('sitebar');
this.adConfig.display.useFullSpace&&(a=Object.values(this.adConfig.creative).find(a=>null!==a&&'object'===typeof a&&a.hasOwnProperty('mode')&&'disabled'!==a.mode),'object'===typeof a&&a.hasOwnProperty('mode')&&('html5'===a.mode||'redirect'===a.mode))&&(e.isSitebar?(this.rootContainer.style.right='0',this.contentContainer.style.height='100%',this.productContainer.style.height='100%'):e.isMysteryAd?(this.rootContainer.style.top='0',this.rootContainer.style.left='0',this.rootContainer.style.width='100%',
this.rootContainer.style.height='100%',this.rootContainer.style.transform='none',this.contentContainer.style.height='100%',this.productContainer.style.height='100%'):e.isUnderstitial&&(this.backgroundContainer.style.display='block',this.backgroundContainer.style.left='auto',this.backgroundContainer.style.width=`${e.rootContainer.offsetWidth}px`,this.advertisementMessageBelowWrapper||this.advertisementMessageAboveWrapper)&&(this.advertisementMessageBelowWrapper.style.left='0',this.advertisementMessageBelowWrapper.style.width=
'100%',this.advertisementMessageBelowWrapper.style.transform='none',this.advertisementMessageAboveWrapper.style.left='0',this.advertisementMessageAboveWrapper.style.width='100%',this.advertisementMessageAboveWrapper.style.transform='none'))};this.showAdvertisementMessage=()=>{this.logger.debug('showAdvertisementMessage');'string'===typeof this.adConfig.advertisementMessage.contentAbove&&0<this.adConfig.advertisementMessage.contentAbove.trim().length&&(this.advertisementMessageAboveContainer.style.visibility=
'visible',this.advertisementMessageAboveContainer.style.display='block');'string'===typeof this.adConfig.advertisementMessage.contentBelow&&0<this.adConfig.advertisementMessage.contentBelow.trim().length&&(this.advertisementMessageBelowContainer.style.visibility='visible',this.advertisementMessageBelowContainer.style.display='block')};this.hideAdvertisementMessage=()=>{this.logger.debug('hideAdvertisementMessage');'string'===typeof this.adConfig.advertisementMessage.contentAbove&&0<this.adConfig.advertisementMessage.contentAbove.trim().length&&
(this.advertisementMessageAboveContainer.style.visibility='hidden',this.advertisementMessageAboveContainer.style.display='none');'string'===typeof this.adConfig.advertisementMessage.contentBelow&&0<this.adConfig.advertisementMessage.contentBelow.trim().length&&(this.advertisementMessageBelowContainer.style.visibility='hidden',this.advertisementMessageBelowContainer.style.display='none')};this.replaceDictionaryMacros=a=>{let e=a;const b={unknown:{AdvertisementMessage:'Advertisement',SkipCounterMessage:'You can skip video in @SkipCounter@',
SkipToMessage:'Skip Ad'},en:{AdvertisementMessage:'Advertisement',SkipCounterMessage:'You can skip video in @SkipCounter@',SkipToMessage:'Skip Ad'},de:{AdvertisementMessage:'Werbung',SkipCounterMessage:'You can skip video in @SkipCounter@',SkipToMessage:'Skip Ad'},es:{AdvertisementMessage:'Publicidad',SkipCounterMessage:'You can skip video in @SkipCounter@',SkipToMessage:'Skip Ad'},pl:{AdvertisementMessage:'Reklama',SkipCounterMessage:'You can skip video in @SkipCounter@',SkipToMessage:'Skip Ad'}};
Object.keys(b).forEach(a=>{if('object'===typeof b[a]&&a===(this.context.Environment.language||'unknown')){const c=b[a];Object.keys(c).forEach(a=>{'string'===typeof c[a]&&(e=e.replace(`@${a}@`,c[a]))})}});return e};this.context=a;this.logger=a.newLogger('AdPainter');this.rootContainer=b;this.overlayContainerBackground=this.context.overlayContainerBackground;b.style.fontSize='0';({Environment:a}=a);a.isMRAID&&(document.documentElement.style.width='100%',document.documentElement.style.height='100%',
document.body.style.width='100%',document.body.style.height='100%',document.body.style.position='fixed',document.body.style.overflow='hidden','fullscreenOverlay'!==E.display.effect&&(b.style.marginTop='50vh',b.style.transform='translateY(-50%)'));this.initConfig=c;this.adConfig=E;this.adVisibilityDetails=d;try{this.adConfig.display.invalidateDeliveryContainerID&&this.context.Environment.deliveryContainer&&(this.logger.log('Invalidated / renamed the delivery container ID'),this.context.Environment.deliveryContainer.id=
`${this.context.Environment.deliveryContainer.id}_${this.initConfig.meta.adSessionId}`)}catch(ea){this.logger.error(ea)}({display:{effect:d}}=E);this.advertisementMessageAboveContainer=t.e(a,'div');this.advertisementMessageAboveWrapper=t.e(a,'div');this.context.advertisementMessageAboveContainer=this.advertisementMessageAboveContainer;this.insertAdvertisementMessageAbove();l.o.includes(d)&&this.prepareStickyContainers();E=t.e(a,'div');this.context.contentContainer=E;E.id=`yoc_content_container_${this.context.productTitlePostfix}_${c.meta.adSessionId}`;
E.style.position='relative';E.style.lineHeight='0';this.contentContainer=E;b.append(E);'enabled'===this.adConfig.feature.swiper.mode&&this.context.Environment.deliveryContainer&&this.context.Environment.deliveryContainer.parentElement&&(b=this.context.Environment.hostDocument.createElement('div'),b.id=`yoc_navigation_container_${this.context.productTitlePostfix}_${c.meta.adSessionId}`,'fullscreenOverlay'===d?this.adConfig.display.forceUsingDeliveryContainer?this.context.Environment.deliveryContainer.append(b):
this.context.Environment.deliveryContainer.parentElement.insertBefore(b,this.context.Environment.deliveryContainer):this.context.contentContainer.append(b),this.context.navigationContainer=b);b=t.e(a,'div');this.context.backgroundContainer=b;b.id=`yoc_background_container_${this.context.productTitlePostfix}_${c.meta.adSessionId}`;b.style.position='absolute';b.style.top='0px';b.style.left='0px';b.style.width='100%';b.style.height='auto';b.style.display='inline-block';b.style.cursor='pointer';b.style.backgroundColor=
this.adConfig.display.bgColor;this.backgroundContainer=b;b=t.e(a,'div');this.context.productContainer=b;b.id=`yoc_product_container_${this.context.productTitlePostfix}_${c.meta.adSessionId}`;b.style.position='relative';b.style.display='block';this.productContainer=b;this.context.Environment.isUnderstitial||this.setCursorPointerOnProductContainer();b.style.backgroundColor=this.adConfig.display.bgColor;E.append(b);this.advertisementMessageBelowContainer=t.e(a,'div');this.advertisementMessageBelowWrapper=
t.e(a,'div');this.context.advertisementMessageBelowContainer=this.advertisementMessageBelowContainer;this.insertAdvertisementMessageBelow()}insertAd(a,b,c){const {rootContainer:e,contentContainer:v,backgroundContainer:z,productContainer:d}=this;this.logger.log('Inserting Ad');this.adConfig.display.resetDisplayNone&&this.walkAndDisableDisplayNone();'yoc-banner-classic'!==this.initConfig.product.key&&(e.style.zIndex=this.adConfig.display.zIndex.toString());e.style.position='relative';this.addOverlayContainer();
this.adjustRootContainer();this.adjustContentContainerOnInsertAd();this.adjustProductContainerOnInsertAd();if(void 0===this.initConfig.product.key)d.append(b);else if('yoc-inline-video-ad'===this.initConfig.product.key)d.append(b),this.updateAdPosition();else if('yoc-zoom-ad'===this.initConfig.product.key)d.append(b);else if('yoc-understitial-ad'===this.initConfig.product.key||'universal-ad-format'===this.initConfig.product.key&&('understitial'===this.adConfig.display.effect||'understitialMini'===
this.adConfig.display.effect||'understitialMiniToSticky'===this.adConfig.display.effect||'understitialSizeCustom'===this.adConfig.display.effect||'understitialSizeSmall'===this.adConfig.display.effect||'understitialSizeMedium'===this.adConfig.display.effect||'understitialSizeLarge'===this.adConfig.display.effect))d.append(z),z.append(b),this.updateAdPosition();else{if('third-party-ad'===this.initConfig.product.key||'yoc-banner-classic'===this.initConfig.product.key)v.style.margin='0px auto',d.style.width=
'100%',d.style.height='auto';d.append(b)}this.context.Environment.hostDocument.body.append(c)}close(){if('shiftDown'===this.adConfig.display.effect){const a=`_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`,b=document.getElementById(`yoc_ad_placeholder${a}`);b&&(b.style.maxHeight='0',setTimeout(()=>{this.adConfig.display.cleanupOnDispose&&b.remove();const e=document.getElementById(`yoc_content_wrapper${a}`);e&&e.childNodes&&e.replaceWith(...e.childNodes)},300))}t.f(this.rootContainer);
this.overlayContainerBackground&&t.f(this.overlayContainerBackground);this.context.navigationContainer&&t.f(this.context.navigationContainer)}closeStickyAd(){const {Environment:a}=this.context;t.f(a.rootStickyContainer)}revertCursorToDefault(){this.productContainer.style.removeProperty('cursor')}insertAdvertisementMessageAbove(){const {Environment:a}=this.context;this.advertisementMessageAboveContainer.id=`yoc_advertisement_message_above_container_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`;
this.advertisementMessageAboveContainer.style.cssText=`position: relative; top: 0px; left: 0px; width: 100%; height: auto; margin: 0px auto; text-align: center; color: ${this.adConfig.advertisementMessage.colorText}; background-color: ${this.adConfig.advertisementMessage.colorBackground}; box-sizing: content-box; visibility: hidden; display: none; line-height: 1.2`;this.advertisementMessageAboveWrapper.id=`yoc_advertisement_message_above_wrapper_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`;
this.advertisementMessageAboveWrapper.style.cssText='position: absolute; top: 0px; left: 50%; width: 100%; height: auto; transform: translate(-50%, 0);';a.isMRAID||(this.advertisementMessageAboveWrapper.innerHTML=this.replaceDictionaryMacros(this.adConfig.advertisementMessage.contentAbove));'fullscreenOverlay'===this.adConfig.display.effect&&(this.advertisementMessageAboveContainer.style.zIndex=this.adConfig.display.zIndex.toString());this.advertisementMessageAboveContainer.append(this.advertisementMessageAboveWrapper);
this.rootContainer.append(this.advertisementMessageAboveContainer)}insertAdvertisementMessageBelow(){this.advertisementMessageBelowContainer.id=`yoc_advertisement_message_below_container_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`;this.advertisementMessageBelowContainer.style.cssText=`position: relative; top: 0px; left: 0px; width: 100%; height: auto; margin: 0px auto; color: ${this.adConfig.advertisementMessage.colorText}; background-color: ${this.adConfig.advertisementMessage.colorBackground}; box-sizing: content-box; visibility: hidden; display: none;`;
this.advertisementMessageBelowWrapper.id=`yoc_advertisement_message_below_wrapper_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`;this.advertisementMessageBelowWrapper.style.cssText='position: absolute; top: 0px; left: 50%; width: 100%; height: auto; transform: translate(-50%, 0);';var {display:{effect:a}}=this.adConfig;'fullscreenOverlay'===a&&(this.advertisementMessageBelowContainer.style.textAlign='right');if(a=this.replaceDictionaryMacros(this.adConfig.advertisementMessage.contentBelow))this.context.Environment.isMRAID?
Object(x.s)(a):this.advertisementMessageBelowWrapper.innerHTML=a;'fullscreenOverlay'===this.adConfig.display.effect&&(this.advertisementMessageBelowContainer.style.zIndex=this.adConfig.display.zIndex.toString());this.advertisementMessageBelowContainer.append(this.advertisementMessageBelowWrapper);this.rootContainer.append(this.advertisementMessageBelowContainer);this.context.Environment.isZoom&&this.context.Environment.adUnitContainer.append(this.advertisementMessageBelowContainer)}addOverlayContainer(){const {zIndex:a,
bgColorOverlay:b='rgba(0,0,0,0.5)',bgStyleOverlay:c=''}=this.adConfig.display;if(this.overlayContainerBackground){const {viewportHeight:e,viewportWidth:v}=this.context.Environment;this.logger.debug('addOverlayContainer dimensions',{viewportHeight:e,viewportWidth:v});this.overlayContainerBackground.style.cssText=`position: fixed; z-index: ${a}; width: ${v}px; height: ${e}px; left: 0px; top: 0px; overflow: hidden; ${''!==c?c:`background-color: ${b};`}`}}adjustRootContainer(a){a=void 0===a?this.adConfig.display.effect:
a;const e=h(this.context.Environment);switch(a){case 'fullscreenOverlay':this.rootContainer.style.position='fixed';this.rootContainer.style.top=`${(this.context.Environment.viewportAvailableHeight-this.context.Environment.scaledHeight)/2}px`;this.rootContainer.style.left=e?`calc(50vw - ${e/2}px)`:'50vw';this.rootContainer.style.width='100%';this.rootContainer.style.height='100%';this.rootContainer.style.textAlign='center';this.rootContainer.style.transform='translate(-50%, 0%)';break;case 'shiftDown':var b=
`_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`;const v=`yoc_ad_placeholder${b}`,z=document.getElementById(v),{maximumPermittedHeight:E=0}=this.adConfig.placement.responsive;if(!z){var c=document.createElement('div');c.id=`yoc_content_wrapper${b}`;for(b=document.body.childNodes;b.length;)c.appendChild(b[0]);document.body.appendChild(c);c=document.createElement('div');c.id=v;c.setAttribute('style','max-height: 0; height: 100vh; overflow: hidden; position: relative; transition: max-height 0.3s ease-out;');
document.body.insertBefore(c,document.body.firstChild)}z&&''===z.innerHTML&&this.rootContainer&&(z.appendChild(this.rootContainer),z.style.maxHeight=`${E}px`,setTimeout(()=>{this.rootContainer.style.height=`${E}px`;var a=`${E-this.advertisementMessageAboveWrapper.clientHeight-this.advertisementMessageBelowWrapper.clientHeight}px`;this.contentContainer.style.height=a;this.backgroundContainer.style.height=a;this.productContainer.style.height=a;if(a=this.rootContainer.querySelector('[id^="yoc_close_button"]'))a.style.position=
'fixed'},0));break;case 'sitebar':const {sitebar:{sticky:d}={},placement:{responsive:{marginLeft:g,marginTop:f}},display:{zIndexSticky:k}}=this.adConfig;d?(this.rootContainer.style.top=`calc(${this.context.Environment.sitebarTopPosition}px)`,this.rootContainer.style.left=`calc(${this.context.Environment.sitebarLeftPosition}px)`,0>=this.context.Environment.sitebarLeftPosition&&(this.logger.log(`YOC Sitebar left position: ${this.context.Environment.sitebarLeftPosition} - right is set to 0px`),this.rootContainer.style.left=
'',this.rootContainer.style.right='0px'),this.rootContainer.style.position='fixed',this.rootContainer.style.bottom='0',this.rootContainer.style.width='auto',this.rootContainer.style.height='auto',this.rootContainer.style.zIndex=`${k}`):(this.rootContainer.style.position='relative',this.rootContainer.style.top='',this.rootContainer.style.left='',this.rootContainer.style.right='',this.rootContainer.style.transform='',this.rootContainer.style.width='auto',this.rootContainer.style.height='auto');this.rootContainer.style.marginLeft=
`${g}px`;this.rootContainer.style.marginTop=`${f}px`;break;case 'zoom':case 'zoomToSticky':this.rootContainer.style.setProperty('margin','0','important'),'undefined'!==typeof this.context.videoWrapper&&this.context.videoWrapper.style.setProperty('margin','0','important')}try{this.logger.log(`adjustRootContainer('${a}')`,{environment_scaledWidth:this.context.Environment.scaledWidth,environment_scaledHeight:this.context.Environment.scaledHeight,environment_viewportWidth:this.context.Environment.viewportWidth,
environment_viewportHeight:this.context.Environment.viewportHeight,environment_viewportAvailableHeight:this.context.Environment.viewportAvailableHeight,scrollbarWidth:e,position:this.rootContainer.style.position,top:this.rootContainer.style.top,left:this.rootContainer.style.left,width:this.rootContainer.style.width,height:this.rootContainer.style.height,marginLeft:this.rootContainer.style.marginLeft,marginTop:this.rootContainer.style.marginTop,marginBottom:this.rootContainer.style.marginBottom})}catch(J){this.logger.error(J)}}adjustContentContainerOnInsertAd(){switch(this.adConfig.display.effect){case 'fullscreenOverlay':this.contentContainer.style.zIndex=
this.adConfig.display.zIndex.toString();break;case 'sitebar':this.contentContainer.style.width='auto',this.contentContainer.style.height='auto'}}adjustProductContainerOnInsertAd(){switch(this.adConfig.display.effect){case 'fullscreenOverlay':case 'sitebar':this.productContainer.style.position='relative',this.productContainer.style.zIndex=this.adConfig.display.zIndex.toString()}}prepareStickyContainers(){const {Environment:a,productTitlePostfix:b}=this.context,{initConfig:{meta:{adSessionId:c}},adConfig:{display:{bgColor:E,
stickyMargin:d},creative:g}}=this;var F=g.sticky;if('html5'===F.mode||'redirect'===F.mode||'redirect-load-rtb-hidden'===F.mode||'static-image'===F.mode||'blurred-video'===F.mode){const {scaledWidth:e,viewportWidth:b}=a.getDimensions(F.width,F.height,!0);F=`${parseInt(((b-e)/2).toString(),10).toString()}px`;var f=`bottom: ${d}px;`;a.isZoom&&(f=`top: ${d}px;`);a.rootStickyContainer.style.cssText=`position: fixed; z-index: ${this.adConfig.display.zIndexSticky}; height: auto; left: ${F}px; ${f}`}f=t.e(a,
'div');f.id=`yoc_content_sticky_container_${b}_${c}`;f.style.position='relative';f.style.lineHeight='0';a.rootStickyContainer.append(f);F=t.e(a,'div');F.id=`yoc_product_sticky_container_${b}_${c}`;F.style.cssText=`position: relative; display: none; cursor: pointer; backgroundColor: ${E};`;this.context.productStickyContainer=F;f.append(F);f=t.e(a,'div');f.id=`yoc_background_sticky_container_${b}_${c}`;this.context.backgroundStickyContainer=f;F.append(f)}walkAndDisableDisplayNone(){let a=this.rootContainer;
for(;;)try{const e=getComputedStyle(a);'none'===e.display&&(this.logger.log('walkAndDisableDisplayNone: overriding display:none'),a.style.setProperty('display','unset','important'));'hidden'===e.visibility&&(this.logger.log('walkAndDisableDisplayNone: overriding visibility:hidden'),a.style.setProperty('visibility','unset','important'));a=a.parentElement}catch(z){break}}setCursorPointerOnProductContainer(){this.productContainer.style.cursor='pointer'}}class D{constructor(a){this.list=[];this.finishedForced=
this.finished=!1;this.onAsset=a=>{const {Environment:e}=this.context;switch(a.kind){case 'added':this.onAssetAdded(a.message);break;case 'updated':this.onAssetUpdate(a.message);break;case 'finished':if(e.isVideo||e.isPreloadImage)this.onAssetFinished();else this.finishedForced?this.logger.log("SKIP finished because it's already finished"):(this.logger.log('Finished'),this.onAssetFinished());break;case 'finished-forced':e.isVideo||e.isPreloadImage||(this.finishedForced?this.logger.log("SKIP finished forced because it's already finished"):
(this.logger.log('Finished forced'),this.finishedForced=!0,this.onAssetFinished()))}};this.onAssetAdded=a=>{const {list:e,context:b}=this;b.messageBus.event.emit({kind:'assetLoading',url:a.asset.url});e.push(a.asset)};this.onAssetUpdate=a=>{const {event:e}=this.context.messageBus,b=a.asset.state;a=a.asset.url;'failed-preload'===b?e.emit({kind:'assetFailed',url:a}):'loaded'===b&&(e.emit({kind:'assetLoaded',url:a}),this.readyCheck())};this.onAssetFinished=()=>{const {context:a,logger:e}=this;a.messageBus.event.emit({kind:'assetAllLoaded'});
e.log('finished')};this.onEventAssetLoading=a=>{this.logger.log('start loading',{url:a.url})};this.onEventAssetLoaded=a=>{this.logger.debug('loading finished successful',{url:a.url})};this.onEventAssetFailed=a=>{this.logger.error('loading failed',{url:a.url})};this.onEventAssetAllLoaded=a=>{this.logger.log('all loaded')};this.context=a;this.logger=a.newLogger('Assets');a.messageBus.asset.on(this.onAsset)}readyCheck(){const {Environment:a}=this.context;!this.finished&&this.isAllAssetsLoaded()?this.context.messageBus.asset.emit({kind:'finished'}):
a.isVideo||a.isPreloadImage||this.context.messageBus.asset.emit({kind:'finished-forced'})}isAllAssetsLoaded(){return this.finished=this.list.every(a=>'loaded'===a.state)}}class O{constructor(a){this.startTime=+new Date;this.onLog=a=>{const {Environment:e}=this.context,b=t.e(e,'div'),c=t.e(e,'span');c.className='timestamp';c.textContent=((Date.now()-this.startTime)/1E3).toFixed(3);b.className=`row ${a.kind}`;b.append(c);b.append(e.hostDocument.createTextNode(a.message));const v=e.hostDocument.createDocumentFragment();
if(a.details){const {details:b}=a;Object.keys(a.details).forEach(a=>{const c=t.e(e,'div');c.textContent=`${a} = ${b[a]}`;c.className='property';v.append(c)})}b.append(v);this.container.prepend(b)};this.context=a;({Environment:a}=a);const e=t.e(a,'div');this.container=e;const b=t.e(a,'div');b.append(e);b.id='yoc-debug';t.g(a,'#yoc-debug {\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 200px;\n    max-height: 50vh;\n    overflow: auto;\n    background-color: rgba(255, 255, 255, 0.985);\n    position: fixed;\n    z-index: 1000000000;\n    border-top: 1px solid #cfd0cf;\n    box-sizing: border-box;\n    font-family: Arial, sans-serif;\n    box-shadow: 0 0 1px 0 rgba(207, 208, 207, 0.2);\n}\n\n#yoc-debug .row {\n    margin-bottom: 0.3em;\n}\n\n#yoc-debug .log {\n    color: black;\n}\n\n#yoc-debug .debug {\n    color: grey;\n}\n\n#yoc-debug .warn {\n    color: orange;\n}\n\n#yoc-debug .error {\n    color: red;\n}\n\n#yoc-debug .timestamp {\n    color: #558;\n    font-size: 75%;\n    width: 4em;\n    display: inline-block;\n    text-align: right;\n    padding-right: 0.3em;\n    font-variant-numeric: tabular-nums;\n}\n\n#yoc-debug .property {\n    color: #78a;\n    font-size: 75%;\n    margin-left: 4.3em;\n    white-space: nowrap;\n}\n');
a.hostDocument.body.append(b);this.context.messageBus.logger.on(this.onLog)}}a(32);a(33);var g=a(0),w=a(4);class P{constructor(a,b,c,d,f,g,F,k,h,l){l=void 0===l?{externalId:''}:l;this.configuration={externalId:''};this.title=a;this.context=b;this.metrics=c;this.adUnitId=d;this.orderId=f;this.lineItemId=g;this.creativeId=F;this.dealId=k;this.adSessionId=h;this.configuration=l;this.logger=this.context.newLogger(`Metrics - ${a}`)}init(){return!1}track(a,b,c,d){return!1}verifyEventDetails(a,b,c,d){a=
{category:a,action:b,label:void 0===c?'':c,value:void 0===d?'':d};''===a.category&&(a.category=`${this.metrics.initConfigProduct.title}_${this.metrics.initConfigProduct.release}`);if('undefined'===typeof a.action||null===a.action||'string'===typeof a.action&&0===a.action.length)a.action='';if('undefined'===typeof a.label||null===a.label||'string'===typeof a.label&&0===a.label.length)a.label='';'undefined'===typeof a.value||null===a.value||'string'===typeof a.value&&0===a.value.length||0===parseInt(a.value,
10)?a.value='1':a.value=parseInt(a.value,10).toString();return a}}class T extends P{init(){return!0}track(a,b,c,d){c=void 0===c?'':c;d=void 0===d?'':d;var e=this.verifyEventDetails(a,b,c,d);e='https://metrics.yoc.com/v1.2/'+this.metrics.normalizeInteger(this.orderId)+'/'+this.metrics.normalizeInteger(this.lineItemId)+'/'+this.metrics.normalizeInteger(this.creativeId)+'/'+this.metrics.normalizeInteger(this.adUnitId)+'/'+this.metrics.normalizeString(e.category,!0)+'/'+this.metrics.normalizeString(e.action,
!0)+'/'+this.metrics.normalizeString(e.label,!0)+'/'+this.metrics.normalizeString(e.value,!0)+'?cb='+this.metrics.normalizeInteger(this.adSessionId)+'_'+this.metrics.normalizeInteger(this.metrics.generateTimestamp())+'&d='+this.metrics.normalizeString(this.dealId,!0);this.metrics.loadTrackingImage(e);this.logger.log('Track',{orderId:this.orderId,lineItemId:this.lineItemId,creativeId:this.creativeId,adUnitId:this.adUnitId,category:a,action:b,label:c,value:d,trackingImageURL:e});return!0}}class X extends P{init(){return!0}track(a,
b,c,d){c=void 0===c?'':c;d=void 0===d?'':d;var e=this.verifyEventDetails(a,b,c,d);e='https://metrics.yoc.com/v1.0/'+this.metrics.normalizeInteger(this.orderId)+'/'+this.metrics.normalizeInteger(this.lineItemId)+'/'+this.metrics.normalizeInteger(this.creativeId)+'/'+this.metrics.normalizeInteger(this.adUnitId)+'/'+this.metrics.normalizeString(e.category,!0)+'/'+this.metrics.normalizeString(e.action,!0)+'/'+this.metrics.normalizeString(e.label,!0)+'/'+this.metrics.normalizeString(e.value,!0)+'?cb='+
this.metrics.normalizeInteger(this.adSessionId)+'_'+this.metrics.normalizeInteger(this.metrics.generateTimestamp());this.metrics.loadTrackingImage(e);this.logger.log('Track',{orderId:this.orderId,lineItemId:this.lineItemId,creativeId:this.creativeId,adUnitId:this.adUnitId,category:a,action:b,label:c,value:d,trackingImageURL:e});return!0}}class U extends P{init(){return!0}track(a,b,c,d){c=void 0===c?'':c;d=void 0===d?'':d;var e=this.verifyEventDetails(a,b,c,d);e='https://www.google-analytics.com/collect?v=1&tid='+
this.configuration.externalId+'&aip=1&cid='+this.metrics.normalizeInteger(this.adSessionId)+'&t=event&ec='+this.metrics.normalizeString(e.category,!0)+'&ea='+this.metrics.normalizeString(e.action,!0)+'&el='+this.metrics.normalizeString(e.label,!0)+'&ev='+this.metrics.normalizeInteger(e.value);this.metrics.loadTrackingImage(e);this.logger.log('Track',{category:a,action:b,label:c,value:d,trackingImageURL:e});return!0}}class Y extends P{init(){window.YOCEvents=[];return!0}track(a,b,c,d){window.YOCEvents.push(b);
return!0}}const ca={required:{sticky:1E4,'inline-to-sticky':10010,'zoom-to-sticky':10011,'sticky-to-zoom':10012,takeover:10020,'uaf-smartphone-none':11E3,'uaf-smartphone-understitial':11010,'uaf-smartphone-understitialmini':11020,'uaf-smartphone-understitialminitosticky':11030,'uaf-smartphone-sticky':11040,'uaf-smartphone-inlinetosticky':11050,'uaf-smartphone-fullscreenoverlay':11060,'uaf-smartphone-sitebar':11070,'uaf-smartphone-zoom':11080,'uaf-smartphone-zoomtosticky':11090,'uaf-smartphone-autoselect-missingadeffect':11511,
'uaf-smartphone-autoselect-nomatch':11512,'uaf-tablet-none':12E3,'uaf-tablet-understitial':12010,'uaf-tablet-understitialmini':12020,'uaf-tablet-understitialminitosticky':12030,'uaf-tablet-sticky':12040,'uaf-tablet-inlinetosticky':12050,'uaf-tablet-fullscreenoverlay':12060,'uaf-tablet-sitebar':12070,'uaf-tablet-zoom':12080,'uaf-tablet-zoomtosticky':12090,'uaf-tablet-autoselect-missingadeffect':12511,'uaf-tablet-autoselect-nomatch':12512,'uaf-desktop-none':13E3,'uaf-desktop-understitial':13010,'uaf-desktop-understitialmini':13020,
'uaf-desktop-understitialminitosticky':13030,'uaf-desktop-sticky':13040,'uaf-desktop-inlinetosticky':13050,'uaf-desktop-fullscreenoverlay':13060,'uaf-desktop-sitebar':13070,'uaf-desktop-zoom':13080,'uaf-desktop-zoomtosticky':13090,'uaf-desktop-autoselect-missingadeffect':13511,'uaf-desktop-autoselect-nomatch':13512,'uaf-unknown-none':14E3,'uaf-unknown-understitial':14010,'uaf-unknown-understitialmini':14020,'uaf-unknown-understitialminitosticky':14030,'uaf-unknown-sticky':14040,'uaf-unknown-inlinetosticky':14050,
'uaf-unknown-fullscreenoverlay':14060,'uaf-unknown-sitebar':14070,'uaf-unknown-zoom':14080,'uaf-unknown-zoomtosticky':14090,'uaf-unknown-autoselect-missingadeffect':14511,'uaf-unknown-autoselect-nomatch':14512,error:2E4,'error-html5-add':20010,'error-redirect-add':20020,'error-redirect-add-hidden':20030,'error-display-effect':20100,'error-close-button':20200,'error-event-only-once':20300,'video-error':20400,'video-subtitles-error':20410,'creative-wrapper-setup-error-ge':20510,'creative-misconfiguration-creative-code':20700,
'ad-unit-error-width-zero-detected':20621,'ad-unit-error-width-zero-auto-fix':20622,'ad-unit-error-width-zero-no-fix':20623,'tpa-portrait-timeout':22E3,'tpa-portrait-error-config':22010,'tpa-portrait-error-source':22020,'tpa-portrait-error-precheck':22030,'tpa-portrait-error-viewability':22040,'tpa-portrait-error-ad-container':22050,'tpa-portrait-error-click-container':22060,'tpa-portrait-not-found-click-container':22070,'tpa-landscape-timeout':22500,'tpa-landscape-error-config':22510,'tpa-landscape-error-source':22520,
'tpa-landscape-error-precheck':22530,'tpa-landscape-error-viewability':22540,'tpa-landscape-error-ad-container':22550,'tpa-landscape-error-click-container':22560,'tpa-landscape-not-found-click-container':22570,'tpa-sticky-timeout':23E3,'tpa-sticky-error-config':23010,'tpa-sticky-error-source':23020,'tpa-sticky-error-precheck':23030,'tpa-sticky-error-viewability':23040,'tpa-sticky-error-ad-container':23050,'tpa-sticky-error-click-container':23060,'tpa-sticky-not-found-click-container':23070,'tpa-hidden-timeout':23500,
'tpa-hidden-error-config':23510,'tpa-hidden-error-source':23520,'tpa-hidden-error-precheck':23530,'tpa-hidden-error-viewability':23540,'tpa-hidden-error-ad-container':23550,'tpa-hidden-error-click-container':23560,'tpa-hidden-not-found-click-container':23570,'tracking-miner-error':27E3,'tracking-miner-error-search':27010,'tracking-miner-error-exception':27020,'tracking-miner-warn-notfound':27110,'click-error':28010,'click-repeated':28110,'document-write-found':3E4,'heavy-ad-intervention':30100,block:30200,
'block-error':30250,'block-error-search':30251,'zoom-init-error':30351,close:36100,'close-sticky':36200,amp:32100,safeframe:32200,facebook:33100,moat:33411,'moat-error':33461,'connection-save-data':33510,'refresh-blocked':61810,'refresh-error':61910,'refresh-error-container':61950,'swiper-autoplay-start':62210,'swiper-autoplay-stop':62220,'swiper-interaction':62310,'swiper-interaction-real':62350,'swiper-interaction-real-move':62351,'swiper-interaction-real-button':62352,'swiper-slide':62410,'ad-error-size-too-small':86201,
'ad-error-size-too-big':86202,'ad-fatal-display-not-visible':87201},optional:{served:40200,init:40300,ready:40400,shown:40500,viewability:40600,impression:40700,hide:40800,click:40900,'tracking-miner':42100,'tracking-miner-released':42200,'creative-wrapper-setup-done-ge':43200,'creative-wrapper-disabled-ge':43500,'tpa-portrait-found':44110,'tpa-landscape-found':44210,'tpa-sticky-found':44310,'tpa-hidden-found':44410,'vpaid-init':48100,'video-vast-mediafile-type-unknown':48500,'video-vast-mediafile-type-vpaid':48501,
'video-vast-mediafile-type-mp4':48502,'video-vast-mediafile-type-3gpp':48503,'video-vast-mediafile-type-webm':48504,'video-vast-mediafile-type-ogg':48505,'video-vast-mediafile-type-mpeg':48506,'refresh-timeout-set':61311,'refresh-timeout-cleared':61321,'refresh-timeout-invoked':61331,'refresh-close':61510,'refresh-requested':61520}};class Z extends P{constructor(){super(...arguments);this.VISXDebug=!1;this.runtimeStatusUrl=''}init(){return!0}setVISXDebug(a){this.VISXDebug=a}setUrl(a){this.runtimeStatusUrl=
a}getUrl(a){return'string'===typeof this.runtimeStatusUrl&&0<this.runtimeStatusUrl.length?this.runtimeStatusUrl.replace('{STATUS_CODE}',String(a)):''}track(a,b,c,d){a=['required'];this.VISXDebug&&a.push('optional');a.forEach(a=>{a=ca[a];b in a&&(a=this.getUrl(a[b]))&&this.metrics.loadTrackingImage(a)});return!0}}m=a(27);var d=a.n(m),u=a(19);const p='performance'in window&&'now'in performance&&'timeOrigin'in performance;class K{constructor(a,b,c,f,g,k){this.registeredTrackerList=[];this.registeredProviderList=
[];this.eventsToTrackOnlyOnce=[];this.onTracking=a=>{const {Environment:b}=this.context;if('register'===a.kind)if(void 0!==a.tracker)this.logger.log(`Registered tracker "${a.event}"`,{event:a.tracker.event,type:a.tracker.type,content:a.tracker.content,isInvalidated:a.tracker.isInvalidated}),this.registeredTrackerList.push(a.tracker),(b.isLogMode||b.isDebugMode)&&this.context.troubleshooting.addVideoTracking(a.tracker.event,a.tracker.content);else if(void 0!==a.type&&void 0!==a.content)switch(a.type){case 'url':(b.isLogMode||
b.isDebugMode)&&this.context.troubleshooting.addVideoTracking(a.event,a.content);var e=Object(w.f)(a.event,a.content,a.meta);this.logger.log(`Registered new URL tracker "${a.event}"`,{event:e.event,type:e.type,content:e.content,meta:e.meta,isInvalidated:e.isInvalidated});this.registeredTrackerList.push(e);break;case 'script':(b.isLogMode||b.isDebugMode)&&this.context.troubleshooting.addVideoTracking(a.event,a.content);e=Object(w.e)(a.event,a.content,a.meta);this.logger.log(`Registered new script tracker "${a.event}"`,
{event:e.event,type:e.type,content:e.content,meta:e.meta,isInvalidated:e.isInvalidated});this.registeredTrackerList.push(e);break;default:this.logger.error(`Can't register "${a.event}" - unknown Tracker type ${a.type}`)}else this.logger.error(`Can't register "${a.event}"`);else if('send'===a.kind){this.logger.log(`Try to send "${a.event}"`,{details:a.details,meta:a.meta});let c=!1;this.eventsToTrackOnlyOnce.forEach(b=>{b.event===a.event&&(!0===b.sent?(c=!0,this.logger.log(`SKIP sending "${a.event}" because 'ONLY-ONCE check' FAILED`,
{details:a.details,meta:a.meta})):(this.logger.log(`CONTINUE sending "${a.event}" because 'ONLY-ONCE check' passed`,{details:a.details,meta:a.meta}),b.sent=!0))});if(c)'display-play-again'===this.adConfig.video.reminderBanner.mode&&a.event.startsWith('video-')?this.logger.log(`SKIP notify about video related repeated trackings (${a.event}) reminder banner mode is "${this.adConfig.video.reminderBanner.mode}"`,{details:a.details,meta:a.meta}):'swiper-interaction'===a.event||a.event.startsWith('swiper-interaction-')?
this.logger.log(`SKIP notify about swiper related repeated trackings (${a.event})`,{details:a.details,meta:a.meta}):this.context.messageBus.event.emit({kind:'tracker',event:'error-event-only-once',details:{source:a.event}});else{let c=!1,v=!1;this.registeredTrackerList.forEach(e=>{if(e.event===a.event&&!1===e.isInvalidated){if('undefined'!==typeof a.meta||'undefined'!==typeof e.meta)if(c=!0,d()(a.meta,e.meta))this.logger.log(`Meta: Found matched Tracker "${a.event}"`,a.meta);else return;c&&(v=!0);
this.initConfigMeta.visx&&this.initConfigMeta.io&&'click'===e.event&&Object(w.c)(e)&&0>e.content.indexOf(encodeURIComponent(l.h))&&0<e.content.indexOf('t.visx.net/click/')&&e.content.endsWith('///')&&(this.logger.log(`Extend tracking URL - BEGIN "${e.event}"`,e.content),e.content=`${e.content}${encodeURIComponent(l.h)}`,this.logger.log(`Extend tracking URL - END "${e.event}"`,e.content));let z=this.replaceMacros(e.content,a.details);z=Object(u.a)(z,this.context.initConfig);Object(w.b)(e)&&(this.loadTrackingScript(z),
(b.isLogMode||b.isDebugMode)&&this.context.troubleshooting.invalidateVideoTracking(e.event,e.content),e.isInvalidated=!0,e.lastUpdate=Date.now(),this.logger.log(`Sent script Tracker "${a.event}"`,{content:z,meta:a.meta,details:a.details}));Object(w.c)(e)&&(this.loadTrackingImage(z),(b.isLogMode||b.isDebugMode)&&this.context.troubleshooting.invalidateVideoTracking(e.event,e.content),e.isInvalidated=!0,e.lastUpdate=Date.now(),this.logger.log(`Sent URL Tracker "${a.event}"`,{content:z,meta:a.meta,details:a.details}));
Object(w.a)(e)&&(this.loadTrackingIframe(z),(b.isLogMode||b.isDebugMode)&&this.context.troubleshooting.invalidateVideoTracking(e.event,e.content),e.isInvalidated=!0,e.lastUpdate=Date.now(),this.logger.log(`Sent Iframe Tracker "${a.event}"`,{content:z,meta:a.meta,details:a.details}))}});if(c&&!v||'undefined'!==typeof a.meta&&!c&&!v)this.logger.log(`Skip sending meta event "${a.event}"`,a.meta);else switch(a.event){case 'served':case 'init':case 'sticky':case 'inline-to-sticky':case 'ready':case 'impression':case 'tpa-portrait-found':case 'tpa-landscape-found':case 'tpa-sticky-found':case 'tpa-hidden-found':case 'tpa-portrait-timeout':case 'tpa-landscape-timeout':case 'tpa-sticky-timeout':case 'tpa-hidden-timeout':case 'takeover':case 'document-write-found':this.trackOnRegisteredProviders('',
a.event,'object'===typeof a.details&&'undefined'!==typeof a.details.msSinceStart?String(a.details.msSinceStart):'');break;case 'tracking-miner':this.trackOnRegisteredProviders('',`${a.event}-${'object'===typeof a.details&&'undefined'!==typeof a.details.countOfTrackersFound?String(a.details.countOfTrackersFound):''}`);break;case 'viewability':e='object'===typeof a.details&&'undefined'!==typeof a.details.msSinceStart?String(a.details.msSinceStart):'';this.trackOnRegisteredProviders('','general-viewable_ad_impression',
e);this.trackOnRegisteredProviders('',a.event,e);break;case 'click':case 'click-repeated':this.trackOnRegisteredProviders('',a.event,'object'===typeof a.details&&'undefined'!==typeof a.details.source?String(a.details.source):'');break;case 'error-event-only-once':this.trackOnRegisteredProviders('',a.event,'object'===typeof a.details&&'undefined'!==typeof a.details.source?String(a.details.source):'');break;case 'video-progress':this.trackOnRegisteredProviders('',a.event,'object'===typeof a.meta&&'undefined'!==
typeof a.meta.offset?String(a.meta.offset):'');break;case 'video-icon-static':case 'video-icon-iframe':case 'video-icon-html':this.trackOnRegisteredProviders('',a.event,this.initConfigMeta.creativeId);break;case 'video-error':this.trackOnRegisteredProviders('',a.event,(a.details&&a.details.errorCode&&String(a.details.errorCode))+(a.details&&a.details.message?'-'+String(a.details.message):'')||'');break;case 'video-vast-version':case 'mraid-version':this.trackOnRegisteredProviders('',a.event,a.details&&
a.details.version&&String(a.details.version)||'');break;case 'video-vast-duration':case 'video-real-duration':this.trackOnRegisteredProviders('',a.event,a.details&&a.details.duration&&String(a.details.duration)||'');break;case 'video-vast-dimensions':case 'video-real-dimensions':this.trackOnRegisteredProviders('',a.event,a.details&&a.details.dimensions&&String(a.details.dimensions)||'');break;case 'video-has-audio':this.trackOnRegisteredProviders('',a.event,a.details&&a.details.hasAudio?'true':'false');
break;case 'video-vast-mediafile-type-unknown':case 'video-vast-mediafile-type-vpaid':case 'video-vast-mediafile-type-mp4':case 'video-vast-mediafile-type-3gpp':case 'video-vast-mediafile-type-webm':case 'video-vast-mediafile-type-ogg':case 'video-vast-mediafile-type-mpeg':this.trackOnRegisteredProviders('',a.event,a.details&&String(a.details.mime)||'');break;case 'video-canplay-mime':this.trackOnRegisteredProviders('',a.event,a.details&&String(a.details.canplay)||'');break;case 'video-on-play-stats':this.trackOnRegisteredProviders('',
a.event,a.details&&String(a.details.stats)||'');break;case 'video-warning-message':case 'video-subtitles-error':this.trackOnRegisteredProviders('',a.event,a.details&&String(a.details.message)||'');break;case 'video-source-type':this.trackOnRegisteredProviders('',a.event,a.details&&String(a.details.type)||'');break;case 'heavy-ad-intervention':this.trackOnRegisteredProviders('',a.event,a.details&&String(a.details.message)||'');break;case 'swiper-slide':case 'swiper-interaction':this.trackOnRegisteredProviders('',
a.event,'object'===typeof a.details&&'undefined'!==typeof a.details.activeSlide?String(a.details.activeSlide):'');break;default:this.trackOnRegisteredProviders('',a.event)}}}};this.loadTrackingScript=a=>{const {Environment:e}=this.context,b=e.hostDocument.createElement('div');b.innerHTML=a;a=b.querySelectorAll('script');for(let b=0;b<a.length;b++){const c=a[b],v=e.hostDocument.createElement('script');for(let a=0;a<c.attributes.length;a++){const e=c.attributes[a];v.setAttribute(e.name,e.value)}v.appendChild(e.hostDocument.createTextNode(a[b].innerHTML));
c.parentElement.insertBefore(v,c);c.remove()}t.f(b);this.metricsContainer.append(b);return b};this.loadTrackingImage=a=>{a=new t.b(this.context,a,!1);t.f(a.node);this.metricsContainer.append(a.node);return a};this.loadTrackingIframe=a=>{a=new t.a(this.context,a,!1);t.f(a.node);this.metricsContainer.append(a.node);return a};this.generateCachebuster=()=>this.normalizeInteger(`${this.currentTime()}${String(1E8*Math.random())}`);this.generateTimestamp=()=>this.normalizeInteger(`${this.currentTime()}`);
this.normalizeString=(a,e)=>{e=void 0===e?!1:e;let b='';'string'!==typeof a&&(a=String(a));for(let e=0;e<a.length;e++)b=-1<'_-abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'.indexOf(a.charAt(e))?b+a.charAt(e):b+'_';e&&0===b.length&&(b='undefined');return b};this.normalizeInteger=a=>{let e='';'string'!==typeof a&&(a=String(a));for(let b=0;b<a.length;b++)-1<'0123456789'.indexOf(a.charAt(b))&&(e+=a.charAt(b));0===e.length&&(e='0');return e};this.currentTime=()=>p?performance.timeOrigin+
performance.now():Date.now();this.context=a;this.adConfig=b;this.logger=this.context.newLogger('Metrics');this.initConfigMeta=f;this.initConfigProduct=g;this.initConfigTracking=k;this.eventsToTrackOnlyOnce.push({event:'init',sent:!1},{event:'ready',sent:!1},{event:'impression',sent:!1},{event:'viewability',sent:!1},{event:'video-start',sent:!1},{event:'video-firstquartile',sent:!1},{event:'video-midpoint',sent:!1},{event:'video-thirdquartile',sent:!1},{event:'video-complete',sent:!1},{event:'video-viewable_impression',
sent:!1},{event:'swiper-interaction',sent:!1},{event:'swiper-interaction-real',sent:!1},{event:'swiper-interaction-real-move',sent:!1},{event:'swiper-interaction-real-button',sent:!1});this.metricsContainer=this.context.Environment.hostDocument.createElement('div');this.metricsContainer.id=`yoc_metrics_container_${this.context.productTitlePostfix}_${this.initConfigMeta.adSessionId}`;t.f(this.metricsContainer);c.append(this.metricsContainer);this.context.messageBus.tracking.on(this.onTracking)}registerProvider(a,
b,c){c=void 0===c?{externalId:''}:c;switch(b){case 'yoc-metrics':c=new X(a,this.context,this,this.initConfigMeta.adUnitId,this.initConfigMeta.orderId,this.initConfigMeta.lineItemId,this.initConfigMeta.creativeId,this.initConfigMeta.dealId,this.initConfigMeta.adSessionId,c);c.init();this.registeredProviderList.push(c);this.logger.log(`Registered Metrics Provider "${a}" (${b})`);break;case 'yoc-metrics-visx':c=new T(a,this.context,this,this.initConfigMeta.adUnitId,this.initConfigMeta.orderId,this.initConfigMeta.lineItemId,
this.initConfigMeta.creativeId,this.initConfigMeta.dealId,this.initConfigMeta.adSessionId,c);c.init();this.registeredProviderList.push(c);this.logger.log(`Registered Metrics Provider "${a}" (${b})`);break;case 'google-analytics':c=new U(a,this.context,this,this.initConfigMeta.adUnitId,this.initConfigMeta.orderId,this.initConfigMeta.lineItemId,this.initConfigMeta.creativeId,this.initConfigMeta.dealId,this.initConfigMeta.adSessionId,c);c.init();this.registeredProviderList.push(c);this.logger.log(`Registered Metrics Provider "${a}" (${b})`);
break;case 'test':c=new Y(a,this.context,this,this.initConfigMeta.adUnitId,this.initConfigMeta.orderId,this.initConfigMeta.lineItemId,this.initConfigMeta.creativeId,this.initConfigMeta.dealId,this.initConfigMeta.adSessionId,c);c.init();this.registeredProviderList.push(c);this.logger.log(`Registered Metrics Provider "${a}" (${b})`);break;case 'visx':this.initConfigMeta.visx?(c=new Z(a,this.context,this,this.initConfigMeta.adUnitId,this.initConfigMeta.orderId,this.initConfigMeta.lineItemId,this.initConfigMeta.creativeId,
this.initConfigMeta.dealId,this.initConfigMeta.adSessionId,c),c.init(),c.setUrl(this.initConfigTracking.runtimeStatusUrl),c.setVISXDebug(this.adConfig.metrics.runtimeTroubleshootingEvents),this.registeredProviderList.push(c),this.logger.log(`Registered Metrics Provider "${a}" (${b})`)):this.logger.log(`It's not VIS.X - don't register Metrics Provider "${a}" (${b})`);break;default:return this.logger.error(`Can't register unknown Metrics Provider "${a}" (${b})`),!1}return!0}trackOnRegisteredProviders(a,
b,c,d){c=void 0===c?'':c;d=void 0===d?'':d;let e=!0;this.registeredProviderList.forEach(v=>{v.track(a,b,c,d)||(this.logger.error(`Track event failed (${v.title})`,{category:a,action:b,label:c,value:d}),e=!1)});return e}replaceMacros(a,b){let e=a;const c=this.generateTimestamp();e=e.replace(new RegExp(decodeURIComponent('%25%25CACHEBUSTER%25%25'),'g'),c);e=e.replace(new RegExp(decodeURIComponent('%25%25cachebuster%25%25'),'g'),c);e=e.replace(new RegExp(decodeURIComponent('%25%25CACHEBUSTING%25%25'),
'g'),c);e=e.replace(new RegExp(decodeURIComponent('%25%25cachebusting%25%25'),'g'),c);e=e.replace(new RegExp(decodeURIComponent('%5C%5BTIMESTAMP%5C%5D'),'g'),c);e=e.replace(new RegExp(decodeURIComponent('%5C%5Btimestamp%5C%5D'),'g'),c);e=e.replace(/([\?&]correlator=)(?:\[placeholder\])/g,(a,e)=>e+c).replace(/(\?|&)(correlator=)(&|$)/,(a,e,b,d)=>`${e}${b}${c}${d}`);e=e.replace(/@PublisherHost@/g,this.context.Environment.publisherHost.value);if(b){const a=a=>a.replace(/([.?*+^$[\]\\(){}|-])/g,'\\$1');
Object.keys(b).forEach(c=>{e=e.replace(new RegExp(a(`[${c.toLowerCase()}]`),'g'),b[c]);e=e.replace(new RegExp(a(`[${c.toUpperCase()}]`),'g'),b[c]);e=e.replace(new RegExp(a(`%%${c.toLowerCase()}%%`),'g'),b[c]);e=e.replace(new RegExp(a(`%%${c.toUpperCase()}%%`),'g'),b[c])})}try{Object.keys(this.context.adCore.externalMacroDetails).forEach(a=>{e=e.replace(new RegExp(`%%${a.toUpperCase()}%%`,'g'),this.context.adCore.externalMacroDetails[a])})}catch(J){this.logger.error(J)}try{e=e.replace(/%%ADSESSIONID%%/g,
this.initConfigMeta.adSessionId)}catch(J){this.logger.error(J)}return e}}var V=a(7);class Q{constructor(a,b){this.messageBus=a;this.prefix=void 0===b?'':b}extend(a){return new Q(this.messageBus,a)}emitLogMessage(a,b,c){const {prefix:e}=this;this.messageBus.logger.emit({kind:a,message:''!==e?`${e}: ${b}`:b,details:c})}debug(a,b){this.emitLogMessage('debug',a,b)}log(a,b){this.emitLogMessage('log',a,b)}warn(a,b){this.emitLogMessage('warn',a,b)}error(a,b){this.emitLogMessage('error',a,b)}}const I=a=>
b=>new Q(a,b);var ia=a(20),H=a(16);class la{constructor(a){this.yocAdsTag=this.deliveryContainer=this.hostElement=null;this.usedHeight=this.usedWidth=this.updatedCreativeHeight=this.updatedCreativeWidth=this.scrollLeft=this.scrollTop=this.availableWidth=this.viewportHeight=this.viewportWidth=0;this.usedScaleFactor=1;this.scaledHeight=this.scaledWidth=0;this.isZoom=this.isSitebar=this.isMysteryAd=this.isUnderstitial=this.isZoomSticky=this.isBrandedTakeoverSticky=this.isSticky=!1;this.canZoom=!0;this.initialScale=
1;this.isError=this.supportClipPath=!1;this.logger=this.context=0;this.creativeOption=this.deviceOrientationOriginal=this.deviceOrientation='portrait';this.isBrowserSafari=this.isDeviceUnknown=this.isDeviceDesktop=this.isDeviceTablet=this.isDeviceSmartphone=!1;this.isPortrait=!0;this.isLandscape=!1;this.isPricingTypeUnknown=!0;this.isVCPM=this.isPricingTypeCPCV=this.isPricingTypeVCPM=this.isPricingTypeCPM=!1;this.isPreloadImage=!0;this.MRAIDIsVisxSDK=this.isMRAID=!1;this.MRAIDMaxAvailableViewportHeight=
this.MRAIDMaxAvailableViewportWidth=null;this.isRefresh=this.isAutoResize=this.isVideo=this.MRAIDStickyEffectUsed=!1;this.bundle='';this.universalDisplayEffectContainsSticky=this.universalDisplayEnabled=this.isAdUnitWidthZeroNoFix=this.isAdUnitWidthZeroAutoFix=this.isAdUnitWidthZeroDetected=!1;this.universalDisplayEffectUsed='none';this.viewportAvailableHeight=this.viewportAvailableWidth=this.sitebarTopPosition=this.sitebarLeftPosition=0;this.videoDimensions={mediaWidth:0,mediaHeight:0,adWidth:0,
adHeight:0,adScaleFactor:0};this.isMovingUp=!1;a||(this.logger.warn('missing window ref'),a=window);this.ownWindow=a;this.ownDocument=a.document;var b=Object(H.a)();this.hostWindow=a=b.wnd;this.hostDocument=b.doc;b=Object(ia.c)(this.hostWindow);var e=!1;'undefined'!==typeof window.$sf&&(e=!0);this.delivery=e={insideAmp:b,insideSafeFrame:e,escapableToTopWindow:this.hostWindow===window.top,insideSameOriginFrame:this.hostWindow!==window,facebookInAppBrowser:/FBAN\/FBIOS|FBAN\/FB4A/.test(navigator.userAgent)};
{let d=null;b=null;if(e.insideAmp)d=Object(ia.a)(a),b=Object(ia.b)(a);else try{var c=window.top.location;d=c.host;b=c.href}catch(ea){}c={trusted:null!==d,value:null!==d?d:a.location.host};a={trusted:null!==b,value:null!==b?b:a.location.href};this.publisherHost=c;this.publisherHref=a}this.language=null;c=navigator.languages&&navigator.languages[0]||navigator.language;'string'===typeof c&&(this.language=c.toLowerCase().slice(0,2));this.isLogMode=/YOCAdLog|yoc_log/.test(a.value);this.isDebugMode=/YOCAdDebug|yoc_debug/.test(a.value);
this.isDemoMode=/YOCAdDemo|yoc_demo/.test(a.value);this.isPreviewMode=/YOCAdPreview|yoc_preview/.test(a.value);try{this.determineViewportDimension(),this.determineOrientation(this.hostWindow),this.determineBrowserDetails()}catch(J){console&&console.error(J)}}preInit(a,b,c,d){this.context=a;this.adConfig=c;this.initConfig=b;this.bundle=d;this.logger=a.newLogger('Environment');try{this.determineViewportDimension(),this.determineOrientation(this.hostWindow),this.determineBrowserDetails(),this.determineSitebarPosition(),
this.determineYOCAdsTag()}catch(J){this.isError=!0,this.logger.error(J)}}init(a,b,c){this.adConfig=b;this.initConfig=a;this.bundle=c;const {troubleshooting:e,display:{effect:d}}=b;e&&(this.isLogMode=!!e.log||this.isLogMode,this.isDemoMode=!!e.demo||this.isDemoMode,this.isDebugMode=!!e.debug||this.isDebugMode,this.isPreviewMode=!!e.preview||this.isPreviewMode);'creative-video'===this.bundle&&(this.isVideo=!0);this.isRefresh=!1;q(this.initConfig,this.adConfig)&&'18'!==this.initConfig.meta.dspId&&(this.isRefresh=
!0);this.isPricingTypeUnknown=!0;this.isPricingTypeVCPM=this.isPricingTypeCPM=!1;'cpm'===this.initConfig.meta.pricingType.toLowerCase()?(this.isPricingTypeUnknown=!1,this.isPricingTypeCPM=!0):'vcpm'===this.initConfig.meta.pricingType.toLowerCase()||'cpv'===this.initConfig.meta.pricingType.toLowerCase()?(this.isPricingTypeUnknown=!1,this.isPricingTypeVCPM=!0):'cpcv'===this.initConfig.meta.pricingType.toLowerCase()&&(this.isPricingTypeUnknown=!1,this.isPricingTypeCPCV=!0);this.isVCPM=this.adConfig.tracking.vCPMEnabled||
this.isPricingTypeVCPM||'viewability'===this.adConfig.tracking.countImpressionOn||'viewability'===this.adConfig.tracking.countVPAIDImpressionOn;this.isPreloadImage=this.adConfig.preload.image;try{this.determineBrowserDetails()}catch(ea){this.isError=!0,this.logger.error(ea)}this.supportClipPath=!1;try{const a=this.hostDocument.createElement('div');'undefined'!==typeof a.style&&'undefined'!==typeof a.style.clipPath&&''===a.style.clipPath&&(this.supportClipPath=!0);this.supportClipPath&&('creative'===
this.bundle||this.bundle.startsWith('creative-feature-'))&&(this.supportClipPath=!1,this.logger.log('CSS clip-path - detected support but disabled because of creative bundle was used'));this.supportClipPath?this.logger.log('CSS clip-path - supported'):this.logger.log('CSS clip-path - NOT supported')}catch(ea){this.isError=!0,this.logger.error(ea)}if('understitial'===this.adConfig.display.effect||'understitialMini'===this.adConfig.display.effect||'understitialMiniToSticky'===this.adConfig.display.effect||
'understitialSizeSmall'===this.adConfig.display.effect||'understitialSizeMedium'===this.adConfig.display.effect||'understitialSizeLarge'===this.adConfig.display.effect||'understitialSizeCustom'===this.adConfig.display.effect||'takeoverUnderstitialMiniAndSticky'===this.adConfig.display.effect||'takeoverUnderstitialMiniAndHidden'===this.adConfig.display.effect||'shiftDown'===this.adConfig.display.effect)this.isUnderstitial=!0;'fullscreenOverlay'===this.adConfig.display.effect&&(this.isMysteryAd=!0);
'sitebar'===d&&(this.isSitebar=!0);if('zoom'===d||'zoomToSticky'===d)this.isZoom=!0;'scale'===this.adConfig.display.responsive.mode&&('boolean'===typeof this.adConfig.display.responsive.autoResize?this.isAutoResize=this.adConfig.display.responsive.autoResize:'boolean'!==typeof this.adConfig.display.responsive.autoResize&&(this.isAutoResize=!0));try{this.determineDeliveryContainer(),this.adjustDeliveryContainers(),this.addContainers(),this.context.rootContainer=this.rootContainer,this.determineAvailableWidth(),
this.determineViewportDimension(),this.determineScrollPosition(),this.determineOrientation(this.hostWindow),this.calculateAdDimension()}catch(ea){this.isError=!0,this.logger.error(ea)}}determineYOCAdsTag(){try{'undefined'!==typeof document&&'undefined'!==typeof document.currentScript&&'undefined'!==typeof document.currentScript.parentElement&&document.currentScript.parentElement.hasAttribute('data-yoc-ads')&&'undefined'!==typeof document.currentScript&&'undefined'!==typeof document.currentScript.parentElement&&
(this.yocAdsTag=document.currentScript.parentElement)}catch(e){}}determineDeliveryContainer(){if(this.delivery.insideSameOriginFrame){var a=this.ownWindow;let b=null;for(;a!==window.top;)try{const e=a.parent,c=a.parent.document.getElementsByTagName('iframe');for(let e=0;e<c.length;e++)c[e].contentWindow===a&&(b=c[e]);a=e}catch(v){break}this.hostElement=b;if(this.adConfig.display.forceUsingDeliveryContainer)if(this.hostDocument.getElementById(this.initConfig.placement.containerId))({containerId:a}=
this.initConfig.placement),this.deliveryContainer=this.hostDocument.getElementById(a);else if(document&&document.currentScript&&'undefined'!==typeof document.currentScript&&'undefined'!==typeof document.currentScript.parentElement)this.deliveryContainer=document.currentScript.parentElement;else if(this.isRefresh&&'undefined'!==typeof this.hostWindow.__YOC.refresh[this.initConfig.meta.adUnitProductId].deliveryContainer)this.deliveryContainer=this.hostWindow.__YOC.refresh[this.initConfig.meta.adUnitProductId].deliveryContainer;
else throw Error(`UsingDeliveryContainer: Can't determine delivery container "${this.initConfig.placement.containerId}"`);else if(this.deliveryContainer=b)b.style.setProperty('width','0','important'),b.style.setProperty('height','0','important'),b.style.setProperty('opacity','0','important');else throw Error('Error during determining the iframe for the delivery');}else if(this.hostDocument.getElementById(this.initConfig.placement.containerId))({containerId:a}=this.initConfig.placement),this.hostElement=
this.deliveryContainer=this.hostDocument.getElementById(a);else if(document&&document.currentScript&&'undefined'!==typeof document.currentScript&&'undefined'!==typeof document.currentScript.parentElement)this.hostElement=this.deliveryContainer=document.currentScript.parentElement;else if(this.isRefresh&&'undefined'!==typeof this.hostWindow.__YOC.refresh[this.initConfig.meta.adUnitProductId].deliveryContainer)this.hostElement=this.deliveryContainer=this.hostWindow.__YOC.refresh[this.initConfig.meta.adUnitProductId].deliveryContainer;
else throw Error(`Can't determine delivery container "${this.initConfig.placement.containerId}"`);}resizeDeliveryContainers(a,b){let e=this.ownWindow,c=null;for(;e!==window.top;){try{const a=e.parent,b=e.parent.document.getElementsByTagName('iframe');for(let a=0;a<b.length;a++)b[a].contentWindow===e&&(c=b[a]);e=a}catch(J){break}if(c){try{this.logger.log(`Resize delivery container '${c.id?c.id:c.name?c.name:''}' from '${c.offsetWidth}x${c.offsetHeight}' to '${a}x${b}'`)}catch(J){}c.style.setProperty('width',
`${a}px`,'important');c.style.setProperty('height',`${b}px`,'important')}}}adjustDeliveryContainers(){try{this.logger.log('Style adjustments: checking');const a=this.adConfig.display.styleAdjustments,{deliveryContainer:b}=this;try{'object'===typeof a&&0<a.length&&a.forEach(a=>{if('object'===typeof a.searchFor&&'string'===typeof a.searchFor.property&&'string'===typeof a.searchFor.value&&'object'===typeof a.replaceWith&&'string'===typeof a.replaceWith.property&&'string'===typeof a.replaceWith.value){let e=
1;'number'===typeof a.level&&0<a.level&&(e=a.level);let c='';'string'===typeof a.replaceWith.priority&&0<a.replaceWith.priority.length&&(c=a.replaceWith.priority);this.logger.log('Style adjustments: found entry to check',{searchFor:a.searchFor,replaceWith:a.replaceWith,level:e,priority:c});let d=b;for(let b=0;b<e;b++){if(!d){this.logger.log('Style adjustments: INVALID container');break}let b='(unknown details)';try{'string'===typeof d.id&&0<d.id.length&&(b=`id: ${d.id}`),'string'===typeof d.name&&
0<d.name.length&&(b=`name: ${d.name}`),'string'===typeof d.className&&0<d.className.length&&(b=`className: ${d.className}`),this.logger.log(`Style adjustments: check container ${b}`)}catch(xa){}const e=getComputedStyle(d);'undefined'===typeof e||e.getPropertyValue(a.searchFor.property)!==a.searchFor.value&&''!==a.searchFor.property||(this.logger.log(`Style adjustments: UPDATE container ${b}`,{searchFor:a.searchFor,replaceWith:a.replaceWith,priority:c}),d.style.setProperty(a.replaceWith.property,a.replaceWith.value,
c));if(d.parentElement)d=d.parentElement;else{this.logger.log(`Style adjustments: reached the level limit - container ${b} has no parent anymore`);break}}}})}catch(v){this.logger.error("Can't set extra tracking URLs which are provided as string",v)}}catch(e){this.logger.error("Can't set extra tracking URLs",e)}}addContainers(){const {deliveryContainer:a,hostDocument:b,initConfig:{meta:{adSessionId:c}},adConfig:{display:{effect:d}}}=this;if(a&&a.parentElement){const {parentElement:e}=a;var f=null,
g=a;let v=a.parentElement;this.adConfig.display.forceUsingDeliveryContainer&&this.hostElement&&this.hostElement.parentElement&&(g=this.hostElement,v=this.hostElement.parentElement);let z=this.adConfig.display.applyZeroWidthAutoFix?5:1;for(let a=0;a<z;a++)try{if(f=b.createElement('div'),f.id=`yoc_environment_container_${a}_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`,f.style.setProperty('width','100%','important'),f.style.setProperty('height','0','important'),v.insertBefore(f,
g),this.environmentContainer=f,0===f.offsetWidth)this.isAdUnitWidthZeroDetected=!0,v.parentElement&&(g=v,v=v.parentElement);else{this.isAdUnitWidthZeroDetected&&(this.isAdUnitWidthZeroAutoFix=!0);break}}catch(G){this.logger.error(G)}this.isAdUnitWidthZeroDetected&&0===this.environmentContainer.offsetWidth&&(this.isAdUnitWidthZeroNoFix=!0);'fullscreenOverlay'===d&&(f=b.createElement('div'),f.id=`yoc_overlay_container_background_${this.context.productTitlePostfix}_${c}`,this.adConfig.display.forceUsingDeliveryContainer?
a.append(f):e.insertBefore(f,a),this.context.overlayContainerBackground=f);this.isZoom&&(f=b.createElement('div'),f.id=`yoc_ad_unit_container_${this.context.productTitlePostfix}_${c}`,this.adConfig.display.forceUsingDeliveryContainer?a.append(f):e.insertBefore(f,a),this.adUnitContainer=f,g=b.createElement('div'),g.id=`yoc_backface_container_${this.context.productTitlePostfix}_${c}`,f.append(g),this.backfaceContainer=g);f=b.createElement('div');f.id=`yoc_root_container_${this.context.productTitlePostfix}_${c}`;
this.isZoom?this.adUnitContainer.append(f):this.adConfig.display.forceUsingDeliveryContainer?a.append(f):e.insertBefore(f,a);this.rootContainer=f;l.o.includes(d)&&(f=b.createElement('div'),f.id=`yoc_root_sticky_container_${this.context.productTitlePostfix}_${c}`,this.adConfig.display.forceUsingDeliveryContainer?a.append(f):e.insertBefore(f,a),this.rootStickyContainer=f)}}determineBrowserDetails(){try{const a=this.hostWindow.navigator.userAgent,b='string'===typeof a&&0<a.length&&-1!==a.toLowerCase().indexOf('windows')&&
-1===a.toLowerCase().indexOf('phone'),c='string'===typeof a&&0<a.length&&-1!==a.toLowerCase().indexOf('macintosh'),d='string'===typeof a&&0<a.length&&-1!==a.toLowerCase().indexOf('linux')&&-1===a.toLowerCase().indexOf('android'),f='string'===typeof a&&0<a.length&&-1!==a.toLowerCase().indexOf('playstation'),g='string'===typeof a&&0<a.length&&-1!==a.toLowerCase().indexOf('xbox');if(this.isPreviewMode){if(this.isDeviceDesktop=b||c||d||f||g,this.isDeviceSmartphone=this.isPortrait&&420>this.viewportWidth||
this.isLandscape&&420>this.viewportHeight,this.isDeviceTablet=this.isPortrait&&!this.isDeviceSmartphone&&1024>=this.viewportWidth||this.isLandscape&&!this.isDeviceSmartphone&&1024>=this.viewportHeight,this.isDeviceSmartphone||this.isDeviceTablet)this.isDeviceDesktop=!1}else this.isDeviceDesktop=b||c||d||f||g,this.isDeviceSmartphone=this.isPortrait&&!this.isDeviceDesktop&&420>this.viewportWidth||this.isLandscape&&!this.isDeviceDesktop&&420>this.viewportHeight,this.isDeviceTablet=this.isPortrait&&!this.isDeviceDesktop&&
!this.isDeviceSmartphone&&1024>=this.viewportWidth||this.isLandscape&&!this.isDeviceDesktop&&!this.isDeviceSmartphone&&1024>=this.viewportHeight;this.isDeviceSmartphone||this.isDeviceTablet||this.isDeviceDesktop||(this.isDeviceUnknown=!0);this.isBrowserSafari=/^((?!chrome|android).)*safari/i.test(a)}catch(e){}}determineMaxMRAIDAvailableSize(){if(this.isMRAID){const a=Object(x.i)();a&&(this.MRAIDMaxAvailableViewportWidth=a.width,this.MRAIDMaxAvailableViewportHeight=a.height)}}determineAvailableWidth(a){(void 0===
a?0:a)&&this.isAdUnitWidthZeroAutoFix&&(this.environmentContainer.style.setProperty('width','100%','important'),this.environmentContainer.style.setProperty('height','0','important'));this.availableWidth=this.environmentContainer.offsetWidth;'scale'===this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.useMobileViewportWidth&&this.context.Environment.isDeviceSmartphone&&(this.availableWidth=this.rootContainer.offsetWidth);if('third-party-ad'!==this.initConfig.product.key&&0===this.availableWidth)try{let a=
this.environmentContainer.parentElement;for(;a;){if(a.offsetWidth>=this.adConfig.display.minimumAvailableWidth){this.availableWidth=a.offsetWidth;this.environmentContainer.style.width=`${this.availableWidth}px`;this.isAdUnitWidthZeroAutoFix=!0;break}a=a.parentElement}}catch(z){console&&console.error(z)}}determineViewportDimension(){if(this.isMRAID){const a=Object(x.k)();if(a){this.viewportWidth=a.width;this.viewportHeight=a.height;return}}const {innerWidth:a,innerHeight:b}=this.hostWindow,{clientWidth:c,
clientHeight:d}=this.hostDocument.documentElement;this.viewportWidth=c?Math.min(a,c):a;this.viewportHeight=d?Math.min(b,d):b}determineScrollPosition(){this.scrollTop=this.hostWindow.pageYOffset||this.hostWindow.scrollY||this.hostDocument.body.scrollTop;this.scrollLeft=this.hostWindow.pageXOffset||this.hostWindow.scrollX||this.hostDocument.body.scrollLeft}determineSitebarPosition(){if(this.isSitebar){var {sitebar:{position:a,selectors:b}={}}=this.adConfig,c=!1,d=!1;if(b&&'string'===typeof b.left){var f=
C(this.adConfig,'left',this.context.Environment);'number'===typeof f&&(this.sitebarLeftPosition=f,c=!0)}b&&'string'===typeof b.top&&(f=C(this.adConfig,'top',this.context.Environment),'number'===typeof f&&(this.sitebarTopPosition=f,d=!0));if(!d||!c)if(a&&('number'!==typeof a.left||c||(this.sitebarLeftPosition=a.left,c=!0),'number'!==typeof a.top||d||(this.sitebarTopPosition=a.top,d=!0)),!d||!c){const {left:a,top:b}=n(this,this.logger);c||(this.sitebarLeftPosition=a);d||(this.sitebarTopPosition=b)}}}getViewportDimensions(){if(this.isMRAID){var a=
Object(x.k)();if(a)return{viewportWidth:a.width,viewportHeight:a.height}}const {creative:{marginTop:b,marginBottom:c},display:{effect:d}}=this.adConfig,{innerWidth:f,innerHeight:g}=this.hostWindow,{clientWidth:k,clientHeight:h}=this.hostDocument.documentElement;a=parseInt((h?Math.min(g,h):g).toString(),10);!this.isSticky&&0<b&&(a-=b);!this.isSticky&&0<c&&(a-=c);if('fullscreenOverlay'===d){const b=this.getAdMessagesHeight();a-=b}return{viewportWidth:k?Math.min(f,k):f,viewportHeight:a}}getUsedDimensions(a,
b){a=void 0===a?0:a;b=void 0===b?0:b;const {layout:c,placement:e}=this.initConfig;if('hidden'===c)return{usedWidth:0,usedHeight:0};if(0<a||0<b)return{usedWidth:a,usedHeight:b};({display:a}=this.adConfig);return 0<a.width||0<a.height?{usedWidth:parseInt(a.width.toString(),10),usedHeight:parseInt(a.height.toString(),10)}:{usedWidth:parseInt(e.width.toString(),10),usedHeight:parseInt(e.height.toString(),10)}}getStickyScaleFactor(a,b,c,d,f){const {display:{stickyMargin:e,stickyMaxHeightPercentage:g}}=
this.adConfig;return Math.min(c/b,d*(void 0===f||f?g/100:100)/b,(c-2*e)/a)}getOrientationBasedScaleFactor(a,b,c,d){var {display:{responsive:e}}=this.adConfig;const g=this.environmentContainer.offsetWidth;c='scale'===e.mode&&e.followLayout?g:c;if(this.isPortrait){e=f(c,a);if(Math.floor(a*e)>c||Math.floor(b*e)>d)e=f(d,b);return e}e=f(d,b);if(Math.floor(a*e)>c||Math.floor(b*e)>d)e=f(c,a);return e}getDimensions(a,c,d){var e=this.adConfig.display.responsive;const f=this.isSitebar?b(this.adConfig):this.adConfig.placement.responsive,
{viewportWidth:g,viewportHeight:v}=this.getViewportDimensions(),{usedWidth:z,usedHeight:k}=this.getUsedDimensions(a,c);if(!['scale','noScale'].includes(e.mode)&&!d)return{scaleFactor:1,scaledWidth:z,scaledHeight:k,viewportWidth:g,viewportHeight:v};a=d?this.getStickyScaleFactor(z,k,g,v):this.getOrientationBasedScaleFactor(z,k,g,v);c=Math.floor(z*a);d=Math.floor(k*a);if('scale'===e.mode&&(0<e.minimumWidth||0<e.minimumHeight)){if(0<e.minimumWidth&&c<e.minimumWidth){var h=e.minimumWidth/c;c=e.minimumWidth;
d*=h;a*=h}0<e.minimumHeight&&d<e.minimumHeight&&(h=e.minimumHeight/d,d=e.minimumHeight,c*=h,a*=h)}'scale'===e.mode&&(0<f.minimumPermittedWidth||0<f.minimumPermittedHeight)&&(0<f.minimumPermittedWidth&&c<f.minimumPermittedWidth&&(h=f.minimumPermittedWidth/c,c=f.minimumPermittedWidth,d*=h,a*=h),0<f.minimumPermittedHeight&&d<f.minimumPermittedHeight&&(h=f.minimumPermittedHeight/d,d=f.minimumPermittedHeight,c*=h,a*=h));'scale'===e.mode&&(0<e.maximumWidth||0<e.maximumHeight)&&(0<e.maximumWidth&&c>e.maximumWidth&&
(h=e.maximumWidth/c,c=e.maximumWidth,d*=h,a*=h),0<e.maximumHeight&&d>e.maximumHeight&&(h=e.maximumHeight/d,d=e.maximumHeight,c*=h,a*=h));'scale'===e.mode&&(0<f.maximumPermittedWidth||0<f.maximumPermittedHeight)&&(0<f.maximumPermittedWidth&&c>f.maximumPermittedWidth&&(e=f.maximumPermittedWidth/c,c=f.maximumPermittedWidth,d*=e,a*=e),0<f.maximumPermittedHeight&&d>f.maximumPermittedHeight&&(e=f.maximumPermittedHeight/d,d=f.maximumPermittedHeight,c*=e,a*=e));return{scaleFactor:a,scaledWidth:c,scaledHeight:d,
viewportWidth:g,viewportHeight:v}}calculateAdDimension(){let {availableWidth:a,viewportWidth:c,viewportHeight:d}=this;const {effect:f}=this.adConfig.display;this.determineSitebarPosition();let g=!1;this.isMRAID&&this.MRAIDIsVisxSDK&&this.MRAIDMaxAvailableViewportWidth&&this.MRAIDMaxAvailableViewportHeight&&'none understitial understitialMini understitialSizeSmall understitialSizeMedium understitialSizeLarge understitialSizeCustom fullscreenOverlay takeoverInlineAndHidden takeoverInlineAndSticky takeoverUnderstitialMiniAndSticky takeoverUnderstitialMiniAndHidden shiftDown'.split(' ').includes(f)&&
(a=c=this.MRAIDMaxAvailableViewportWidth,d=this.MRAIDMaxAvailableViewportHeight,g=!0);let k=!1;try{this.isMRAID&&this.MRAIDIsVisxSDK&&'third-party-ad'===this.initConfig.product.key&&('celtra-interscroller'===this.adConfig.thirdParty.creativeSource.portrait||'celtra-interscroller'===this.adConfig.thirdParty.creativeSource.landscape)&&(k=!0)}catch(xa){}if('hidden'===this.initConfig.layout)this.usedHeight=this.usedWidth=0;else{let e=parseInt(c.toString(),10),g=parseInt(d.toString(),10);!this.isSticky&&
0<this.adConfig.creative.marginTop&&(g-=this.adConfig.creative.marginTop);!this.isSticky&&0<this.adConfig.creative.marginBottom&&(g-=this.adConfig.creative.marginBottom);if(this.isSitebar){const {placement:{responsive:{marginLeft:a,marginTop:b}}}=this.adConfig;g-=this.sitebarTopPosition;e-=this.sitebarLeftPosition;try{var h=window.devicePixelRatio||window.screen.availWidth/document.documentElement.clientWidth;1>e&&1<h&&(this.sitebarLeftPosition=0,e=this.availableWidth/2)}catch(Ba){}g-=b;e-=a}'fullscreenOverlay'===
f&&(h=this.getAdMessagesHeight(),g-=h);this.usedWidth=this.initConfig.placement.width;this.usedHeight=this.initConfig.placement.height;if(0<this.adConfig.display.width||0<this.adConfig.display.height)this.usedWidth=this.adConfig.display.width,this.usedHeight=this.adConfig.display.height;if(0<this.updatedCreativeWidth||0<this.updatedCreativeHeight)this.usedWidth=this.updatedCreativeWidth,this.usedHeight=this.updatedCreativeHeight;this.usedScaleFactor=1;if('scale'===this.adConfig.display.responsive.mode||
'noScale'===this.adConfig.display.responsive.mode||this.isSticky){if(this.isSticky&&this.isZoom){h=parseInt(this.usedHeight.toString(),10);var l=parseInt(this.usedWidth.toString(),10);this.usedScaleFactor=Math.min(a/h,this.adConfig.display.stickyMaxHeightPercentage/100*g/h,a/l)}else if(this.isSticky||this.universalDisplayEnabled&&this.universalDisplayEffectContainsSticky&&'none'===this.universalDisplayEffectUsed)h=parseInt(this.usedHeight.toString(),10),l=parseInt(this.usedWidth.toString(),10),this.usedScaleFactor=
Math.min(e/h,this.adConfig.display.stickyMaxHeightPercentage/100*g/h,(e-2*this.adConfig.display.stickyMargin)/l);else if('scale'===this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.followLayout){h=a;if('fullscreenOverlay'===f||'sitebar'===f||this.isSitebar)h=e;if(this.isPortrait){this.usedScaleFactor=parseInt(h.toString(10),10)/parseInt(this.usedWidth.toString(10),10);if(Math.floor(this.usedWidth*this.usedScaleFactor)>h||Math.floor(this.usedHeight*this.usedScaleFactor)>g)this.usedScaleFactor=
parseInt(g.toString(10),10)/parseInt(this.usedHeight.toString(10),10);Math.floor(this.usedWidth*this.usedScaleFactor)>h&&(this.usedScaleFactor=parseInt(h.toString(10),10)/parseInt(this.usedWidth.toString(10),10))}else if(this.usedScaleFactor=parseInt(g.toString(10),10)/parseInt(this.usedHeight.toString(10),10),Math.floor(this.usedWidth*this.usedScaleFactor)>h||Math.floor(this.usedHeight*this.usedScaleFactor)>g)this.usedScaleFactor=parseInt(h.toString(10),10)/parseInt(this.usedWidth.toString(10),10)}else if(h=
this.isSitebar?e:c,this.isPortrait){if(this.usedScaleFactor=parseInt(h.toString(10),10)/parseInt(this.usedWidth.toString(10),10),Math.floor(this.usedWidth*this.usedScaleFactor)>h||Math.floor(this.usedHeight*this.usedScaleFactor)>g)this.usedScaleFactor=parseInt(g.toString(10),10)/parseInt(this.usedHeight.toString(10),10)}else if(this.usedScaleFactor=parseInt(g.toString(10),10)/parseInt(this.usedHeight.toString(10),10),Math.floor(this.usedWidth*this.usedScaleFactor)>h||Math.floor(this.usedHeight*this.usedScaleFactor)>
g)this.usedScaleFactor=parseInt(c.toString(10),10)/parseInt(this.usedWidth.toString(10),10);this.scaledWidth=Math.floor(this.usedWidth*this.usedScaleFactor);if(isNaN(this.scaledWidth)||'number'===typeof this.scaledWidth&&0>this.scaledWidth)this.scaledWidth=0;this.scaledHeight=Math.floor(this.usedHeight*this.usedScaleFactor);if(isNaN(this.scaledHeight)||'number'===typeof this.scaledHeight&&0>this.scaledHeight)this.scaledHeight=0;l=this.adConfig.display.responsive;h=this.isSitebar?b(this.adConfig):
this.adConfig.placement.responsive;if('scale'===l.mode&&(0<l.minimumWidth||0<l.minimumHeight)){if(0<l.minimumWidth&&this.scaledWidth<l.minimumWidth){var m=l.minimumWidth/this.scaledWidth;this.scaledWidth=l.minimumWidth;this.scaledHeight*=m;this.usedScaleFactor*=m}0<l.minimumHeight&&this.scaledHeight<l.minimumHeight&&(m=l.minimumHeight/this.scaledHeight,this.scaledHeight=l.minimumHeight,this.scaledWidth*=m,this.usedScaleFactor*=m)}'scale'===l.mode&&(0<h.minimumPermittedWidth||0<h.minimumPermittedHeight)&&
(0<h.minimumPermittedWidth&&this.scaledWidth<h.minimumPermittedWidth&&(m=h.minimumPermittedWidth/this.scaledWidth,this.scaledWidth=h.minimumPermittedWidth,this.scaledHeight*=m,this.usedScaleFactor*=m),0<h.minimumPermittedHeight&&this.scaledHeight<h.minimumPermittedHeight&&(m=h.minimumPermittedHeight/this.scaledHeight,this.scaledHeight=h.minimumPermittedHeight,this.scaledWidth*=m,this.usedScaleFactor*=m));'scale'===l.mode&&(0<l.maximumWidth||0<l.maximumHeight)&&(0<l.maximumWidth&&this.scaledWidth>
l.maximumWidth&&(m=l.maximumWidth/this.scaledWidth,this.scaledWidth=l.maximumWidth,this.scaledHeight*=m,this.usedScaleFactor*=m),0<l.maximumHeight&&this.scaledHeight>l.maximumHeight&&(m=l.maximumHeight/this.scaledHeight,this.scaledHeight=l.maximumHeight,this.scaledWidth*=m,this.usedScaleFactor*=m));'scale'===l.mode&&(0<h.maximumPermittedWidth||0<h.maximumPermittedHeight)&&(0<h.maximumPermittedWidth&&this.scaledWidth>h.maximumPermittedWidth&&(l=h.maximumPermittedWidth/this.scaledWidth,this.scaledWidth=
h.maximumPermittedWidth,this.scaledHeight*=l,this.usedScaleFactor*=l),0<h.maximumPermittedHeight&&this.scaledHeight>h.maximumPermittedHeight&&(l=h.maximumPermittedHeight/this.scaledHeight,this.scaledHeight=h.maximumPermittedHeight,this.scaledWidth*=l,this.usedScaleFactor*=l));'noScale'===this.adConfig.display.responsive.mode&&(this.usedWidth=this.scaledWidth,this.usedHeight=this.scaledHeight,this.usedScaleFactor=1)}else this.scaledWidth=this.usedWidth,this.scaledHeight=this.usedHeight;this.viewportAvailableWidth=
e;this.viewportAvailableHeight=g}g&&('understitialMini'===f?Object(x.A)(this.MRAIDStickyEffectUsed?'sticky':'understitial-mini',{width:this.MRAIDMaxAvailableViewportWidth,height:this.scaledHeight}):'none'===f?Object(x.A)(this.MRAIDStickyEffectUsed?'sticky':'banner',{width:this.MRAIDMaxAvailableViewportWidth,height:this.scaledHeight}):'fullscreenOverlay'===f?Object(x.A)('fullscreen-overlay',{width:this.MRAIDMaxAvailableViewportWidth,height:this.MRAIDMaxAvailableViewportHeight}):k?Object(x.A)('understitial-mini',
{width:this.MRAIDMaxAvailableViewportWidth,height:this.scaledHeight}):'takeoverInlineAndHidden'===f||'takeoverInlineAndSticky'===f?Object(x.A)('banner',{width:this.MRAIDMaxAvailableViewportWidth,height:this.scaledHeight}):'takeoverUnderstitialMiniAndSticky'===f||'takeoverUnderstitialMiniAndHidden'===f?Object(x.A)('understitial-mini',{width:this.MRAIDMaxAvailableViewportWidth,height:this.scaledHeight}):Object(x.A)('understitial',{width:this.MRAIDMaxAvailableViewportWidth,height:this.MRAIDMaxAvailableViewportHeight}));
this.logger.debug('calculateAdDimensions',{used:`${this.usedWidth}x${this.usedHeight}`,scaled:`${this.scaledWidth}x${this.scaledHeight}`,updatedCreative:`${this.updatedCreativeWidth}x${this.updatedCreativeHeight}`})}onOrientationChange(a){this.determineOrientation(this.hostWindow);this.determineAvailableWidth(!0);this.determineViewportDimension();this.determineScrollPosition();this.isMRAID&&this.MRAIDIsVisxSDK&&this.determineMaxMRAIDAvailableSize();this.calculateAdDimension()}onResize(a){this.determineOrientation(this.hostWindow);
this.determineAvailableWidth(!0);this.determineViewportDimension();this.determineScrollPosition();this.isMRAID&&this.MRAIDIsVisxSDK&&this.determineMaxMRAIDAvailableSize();this.calculateAdDimension()}onStickyShow(a,b){b=void 0===b?!1:b;'boolean'===typeof b&&(this.isMovingUp=b);({display:{effect:b}}=this.adConfig);this.isSticky=!l.o.includes(b);this.isBrandedTakeoverSticky=l.o.includes(b);this.isZoomSticky=l.p.includes(b);a&&(this.creativeOption=a);this.determineAvailableWidth();this.determineViewportDimension();
this.determineScrollPosition();this.calculateAdDimension()}onStickyHide(a){a&&(this.creativeOption=a);this.determineAvailableWidth();this.determineViewportDimension();this.determineScrollPosition();this.calculateAdDimension()}onStickyStop(a){this.isZoomSticky=this.isBrandedTakeoverSticky=this.isSticky=!1;a&&(this.creativeOption=a);this.determineAvailableWidth();this.determineViewportDimension();this.determineScrollPosition();this.calculateAdDimension()}determineOrientation(a){const {screen:b}=a;let c;
try{if(this.isMRAID){const a=Object(x.j)();a&&(c=a.height>=a.width?0:90)}this.isPreviewMode&&(c=this.viewportHeight>=this.viewportWidth?0:90);'number'!==typeof c&&('undefined'!==typeof a.orientation?c=a.orientation:'undefined'!==typeof b&&'undefined'!==typeof b.orientation&&'undefined'!==typeof b.orientation.type&&'portrait-primary'===b.orientation.type?c=0:'undefined'!==typeof b&&'undefined'!==typeof b.orientation&&'undefined'!==typeof b.orientation.type&&'portrait-secondary'===b.orientation.type?
c=180:'undefined'!==typeof b&&'undefined'!==typeof b.orientation&&'undefined'!==typeof b.orientation.type&&'landscape-primary'===b.orientation.type?c=90:'undefined'!==typeof b&&'undefined'!==typeof b.orientation&&'undefined'!==typeof b.orientation.type&&'landscape-secondary'===b.orientation.type?c=270:'undefined'!==typeof b&&'undefined'!==typeof b.orientation&&'undefined'!==typeof b.orientation.angle&&(c=b.orientation.angle),null===c&&this.viewportWidth<this.viewportHeight&&(c=0),null===c&&this.viewportWidth>
this.viewportHeight&&(c=90),null===c&&(c=0),this.isDeviceDesktop&&this.viewportWidth<this.viewportHeight&&(c=0),this.isDeviceDesktop&&this.viewportWidth>this.viewportHeight&&(c=90),c=c?Number(c):void 0)}catch(E){c=0}this.isPortrait='undefined'===typeof c||null===c||-1===c||0===c||180===c||-180===c?!0:!1;this.isLandscape=-90===c||90===c||270===c||-270===c?!0:!1;this.deviceOrientation='portrait';this.isLandscape&&(this.deviceOrientation='landscape');this.deviceOrientationOriginal=this.deviceOrientation;
this.isSticky&&'sticky'===this.creativeOption||(this.creativeOption=this.deviceOrientation);'undefined'!==typeof this.initConfig&&'undefined'!==typeof this.initConfig.meta&&'undefined'!==typeof this.adConfig&&'undefined'!==typeof this.adConfig.creative&&(!this.isPortrait&&(!this.adConfig.troubleshooting||this.adConfig.troubleshooting&&this.adConfig.troubleshooting.useForcePortraitMode||this.adConfig.troubleshooting&&!1!==this.adConfig.troubleshooting.useForcePortraitMode)||!this.isPortrait&&'undefined'!==
typeof this.adConfig.creative.landscape&&'disabled'===this.adConfig.creative.landscape.mode)&&(this.logger.log('Force portrait mode'),this.isPortrait=!0,this.isLandscape=!1,this.deviceOrientation='portrait',this.isSticky&&'sticky'===this.creativeOption||(this.creativeOption=this.deviceOrientation));return!0}getAdMessagesHeight(){try{let a=0;if(this.context.advertisementMessageAboveContainer){const {clientHeight:b=-1}=this.context.advertisementMessageAboveContainer;0<b&&(a+=b)}if(this.context.advertisementMessageBelowContainer){const {clientHeight:b=
-1}=this.context.advertisementMessageBelowContainer;0<b&&(a+=b)}return a}catch(e){return this.logger.error('adMessagesHeight calculation failed',e),0}}getDeviceSize(){let a=this.viewportWidth,b=this.viewportHeight;a>b&&(a=b);return 400>=a?'small':750>=a?'medium':'big'}useMRAIDSticky(a){'sticky'!==a&&'inline-to-sticky'===a&&(this.logger.log('useMRAIDSticky: enabling listener to use inline-to-sticky conversion'),Object(x.l)(()=>{this.logger.log('useMRAIDSticky: conversion to sticky');this.MRAIDStickyEffectUsed=
!0;this.onResize()}))}setVideoDimensions(a,b,c,d,f){this.videoDimensions.mediaWidth=a;this.videoDimensions.mediaHeight=b;this.videoDimensions.adWidth=c;this.videoDimensions.adHeight=d;this.videoDimensions.adScaleFactor=f}getVideoDimensions(){return this.videoDimensions}}var pa=la;class qa{constructor(a){this.pageVisibilityEventListenerName=this.pageVisibilityObjectName='';this.eventListeners=[];this.Environment=a;'undefined'!==typeof a.hostDocument.hidden?(this.pageVisibilityObjectName='hidden',this.pageVisibilityEventListenerName=
'visibilitychange'):'undefined'!==typeof a.hostDocument.msHidden?(this.pageVisibilityObjectName='msHidden',this.pageVisibilityEventListenerName='msvisibilitychange'):'undefined'!==typeof a.hostDocument.webkitHidden&&(this.pageVisibilityObjectName='webkitHidden',this.pageVisibilityEventListenerName='webkitvisibilitychange')}add(a,b,c,d){c=void 0===c?100:c;d=void 0===d?!0:d;this.Environment.hostWindow.addEventListener(a,0<c?y(b,c):b,{passive:d});this.eventListeners.push({type:a,listener:b})}remove(a,
b){a&&b?this.Environment.hostWindow.removeEventListener(a,b):this.eventListeners.forEach(a=>{this.Environment.hostWindow.removeEventListener(a.type,a.listener)})}}var ja=qa;class oa{constructor(a,b,c,d){this.adCore=a;this.productTitlePostfix=c;this.initConfig=d;this.messageBus={tracking:new V.a,logger:new V.a,event:new V.a,asset:new V.a,clickOverlay:new V.a,elementsOverlay:new V.a};this.Environment=a=new pa(b);this.Listener=new ja(a);this.trackingMiner={portrait:{visibleCreative:!1,hiddenCreative:!1},
landscape:{visibleCreative:!1,hiddenCreative:!1},sticky:{visibleCreative:!1,hiddenCreative:!1},hidden:{visibleCreative:!1,hiddenCreative:!1}}}newLogger(a){return I(this.messageBus)(a)}setupClickHandler(a,b){a.addEventListener('click',b,!1)}}var R=a(14);const ha=l.e,fa=[l.q,l.r,l.b,l.c],M=/mobile/i.test(navigator.userAgent);class da{constructor(a,b,c){this.buttonsLocations=[];this.buttons=[];this.containers=[];this.onEvent=a=>{switch(a.kind){case l.a:this.isInitialized||(this.prepareButtonsLocations(),
this.createPositionContainers(),this.isInitialized=!0);this.add(a);break;case l.j:this.remove(a.element);break;case l.i:this.refresh()}};this.context=a;this.initConfig=b;this.adConfig=c;this.logger=a.newLogger('ElementsOverlay');this.context.messageBus.elementsOverlay.on(this.onEvent);this.isInitialized=!1}prepareButtonsLocations(){try{const {isSitebar:a,isVideo:b}=this.context.Environment,c=a&&!b,d=c?[l.e]:[l.e,l.g];this.buttonsLocations=fa.reduce((a,b)=>[...a,...d.map(a=>({position:b,placement:c?
l.e:a}))],[])}catch(e){this.buttonsLocations=[],this.logger.error(`prepareButtonsLocations ${e}`)}}createPositionContainers(){this.buttonsLocations.forEach(a=>{var {position:b,placement:c}=a;a=this.createGridContainer(b,c);this.getParentContainer(c).append(a);this.containers.push(a)});this.isInitialized=!0}createGridContainer(a,b){var {Environment:c}=this.context;c=t.e(c,'div');c.id=`yoc_button_container_${a}_${b}_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`;c.style.cssText=
this.setContainerStyle(a,b);return c}getButtonsByContainerLocation(a,b){return this.buttons.filter(c=>{var {placement:e=ha,preferredPosition:d}=c;return d===a&&e===b}).sort((a,b)=>(b.priority||0)-(a.priority||0))}add(a){this.logger.debug(l.a);this.buttons.push(a);this.refresh()}remove(a){this.logger.debug(l.j);this.buttons=this.buttons.filter(b=>{(b=b.element!==a)||a.remove();return b});this.refresh()}refresh(){this.logger.debug(l.i);this.addButtonsToContainer()}addButtonsToContainer(){const {Environment:a}=
this.context;this.buttonsLocations.forEach(b=>{var {position:c,placement:e}=b;this.logger.debug('addButtonsToContainer');this.getButtonsByContainerLocation(c,e).forEach(b=>{this.logger.debug(`addButtonsToContainer - button added to ${c}-${e}`);const d=a.hostDocument.getElementById(`yoc_button_container_${c}_${e}_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`)||this.createGridContainer(c,e),f=M&&!!b.type;d.style.cssText=this.setContainerStyle(c,e);f&&(b.element.style.padding=
'15px',b.element.style.position='relative',/top/.test(c)&&(b.element.style.top='-15px'),/right/.test(c)&&(b.element.style.right='-15px'),/bottom/.test(c)&&(b.element.style.bottom='-15px'),/left/.test(c)&&(b.element.style.left='-15px'));d.append(b.element)})})}getParentContainer(a){return this.context.Environment.isSitebar?a===l.e&&this.context.videoWrapper&&!this.context.Environment.isMRAID?this.context.videoWrapper:this.context.productContainer:a===l.e?this.context.videoWrapper&&!this.context.Environment.isMRAID?
this.context.videoWrapper:this.context.productContainer:this.context.rootContainer.parentElement}setContainerStyle(a,b){const c=this.context.Environment.isSitebar?2:3,e=this.context.Environment.isSitebar?2:3;var {display:{zIndex:d=2}}=this.adConfig;d=`position: ${this.context.Environment.isSitebar||this.context.Environment.isZoom?'absolute':'fixed'}; z-index:${d};`;const f=`transform: scale(${this.getScale()});`,g=this.context.Environment.isSitebar?'%':'vh',h=this.context.Environment.isSitebar?'%':
'vw';switch(`${a}-${b}`){case `${l.q}-${l.e}`:return d+f+`top: ${e}%; left: ${c}%; transform-origin: left top;`;case `${l.r}-${l.e}`:return d+f+`top: ${e}%; right: ${c}%; transform-origin: right top;`;case `${l.b}-${l.e}`:return d+f+`bottom: ${e}%; left: ${c}%; transform-origin: left bottom;`;case `${l.c}-${l.e}`:return d+f+`bottom: ${e}%; right: ${c}%; transform-origin: right bottom;`;case `${l.q}-${l.g}`:return d+`top: ${e}${g}; left: ${c}${h};`;case `${l.r}-${l.g}`:return d+`top: ${e}${g}; right: ${c}${h};`;
case `${l.b}-${l.g}`:return d+`bottom: ${e}${g}; left: ${c}${h};`;case `${l.c}-${l.g}`:return d+`bottom: ${e}${g}; right: ${c}${h};`;default:return d}}getScale(){const {scaledWidth:a}=this.context.Environment;return 400>a?a/400:1}dispose(){this.containers.forEach(a=>a.remove());this.containers=[]}}class aa{constructor(a,b,c,d){this.elements=[];this.onEvent=a=>{switch(a.kind){case 'add-element':this.add(a);break;case 'remove-element':this.remove(a.element);break;case 'refresh':this.refresh()}};this.context=
a;this.initConfig=b;this.adConfig=c;this.logger=a.newLogger('ClickOverlay');this.productContainer=d;this.context.messageBus.clickOverlay.on(this.onEvent)}add(a){this.logger.debug('add');this.elements.push(a);this.refresh()}remove(a){this.logger.debug('remove');this.elements=this.elements.filter(b=>{(b=b.element!==a)||a.remove();return b});this.refresh()}getElements(a){return this.elements.filter(b=>b.preferredPosition===a).sort((a,b)=>(b.priority||0)-(a.priority||0))}get leftTops(){return this.getElements('top-left')}get leftBottoms(){return this.getElements('bottom-left')}get rightTops(){return this.getElements('top-right')}get rightBottoms(){return this.getElements('bottom-right')}refresh(){const {Environment:a}=
this.context;let b=1;400>a.scaledWidth&&!a.isBrandedTakeoverSticky&&(b=a.scaledWidth/400);let c=0;a.isSticky||a.isBrandedTakeoverSticky||(c='scale'!==this.adConfig.display.responsive.mode||this.adConfig.display.responsive.followLayout?'scale'===this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.followLayout?(a.availableWidth-a.scaledWidth)/2:(a.availableWidth-a.usedWidth)/2:(a.viewportWidth-a.scaledWidth)/2);this.leftTops.forEach(e=>{var d=this.getPositionScaling(e.isSticky);
const {style:f}=e.element,g=M&&!!e.type;f.position='absolute';const h=(e.margin?Object(R.a)(e.margin.left)?0:e.margin.left*a.usedScaleFactor+20*b*d:20*b*d)+(e.applyLeftRightMargin?c:0);f.left=`${h+(g?-15:0)}px`;g&&(f.padding='15px');d=e.margin?Object(R.a)(e.margin.top)?0:e.margin.top*a.usedScaleFactor+20*b*d:20*b*d;f.top=`${d+(g?-15:0)}px`;f.zIndex='2';f.transformOrigin='left top';f.transform=`scale(${b})`;('undefined'!==typeof e.parent?e.parent:this.productContainer).append(e.element)});this.leftBottoms.forEach(e=>
{var d=this.getPositionScaling(e.isSticky);const {style:f}=e.element;f.position='absolute';const g=M&&!!e.type,h=e.margin?Object(R.a)(e.margin.left)?0:e.margin.left*a.usedScaleFactor+20*b*d:20*b*d;f.left=`${h+(g?-15:0)+(e.applyLeftRightMargin?c:0)}px`;g&&(f.padding='15px');d=e.margin?Object(R.a)(e.margin.bottom)?0:e.margin.bottom*a.usedScaleFactor+20*b*d:20*b*d;f.bottom=`${d+(g?-15:0)}px`;f.zIndex='2';f.transformOrigin='left bottom';f.transform=`scale(${b})`;('undefined'!==typeof e.parent?e.parent:
this.productContainer).append(e.element)});this.rightTops.forEach(e=>{var d=this.getPositionScaling(e.isSticky);const {style:f}=e.element,g=M&&!!e.type;f.position='absolute';const h=e.margin?Object(R.a)(e.margin.right)?0:e.margin.right*a.usedScaleFactor+20*b*d:20*b*d;f.right=`${h+(g?-15:0)+(e.applyLeftRightMargin?c:0)}px`;g&&(f.padding='15px');d=e.margin?Object(R.a)(e.margin.top)?0:e.margin.top*a.usedScaleFactor+20*b*d:20*b*d;f.top=`${d+(g?-15:0)}px`;f.zIndex='2';f.transformOrigin='right top';f.transform=
`scale(${b})`;('undefined'!==typeof e.parent?e.parent:this.productContainer).append(e.element)});this.rightBottoms.forEach(e=>{var d=this.getPositionScaling(e.isSticky);const {style:f}=e.element,g=M&&!!e.type;f.position='absolute';const h=(e.margin?Object(R.a)(e.margin.right)?0:e.margin.right*a.usedScaleFactor+20*b*d:20*b*d)+(e.applyLeftRightMargin?c:0);f.right=`${h+(g?-15:0)}px`;g&&(f.padding='15px');d=e.margin?Object(R.a)(e.margin.bottom)?0:e.margin.bottom*a.usedScaleFactor+20*b*d:20*b*d;f.bottom=
`${d+(g?-15:0)}px`;f.zIndex='2';f.transformOrigin='right bottom';f.transform=`scale(${b})`;('undefined'!==typeof e.parent?e.parent:this.productContainer).append(e.element)})}getPositionScaling(a){return(void 0===a?0:a)?l.n:1}}var N=a(13),ma=a(23);class ba{constructor(a,b,c){this.context=a;this.logger=this.context.newLogger('Troubleshooting');this.initConfig=b;this.adConfig=c;({Environment:a}=a);Object(ma.a)(a.hostWindow);this.space=a.hostWindow.__YOC.session[this.initConfig.meta.adSessionId].troubleshootingLog=
[];this.logList=a.hostWindow.__YOC.session[this.initConfig.meta.adSessionId].troubleshootingLog.ll=[]}check(a,b,c){this.space[a]||(this.space[a]=[]);this.space[a][b]||(this.space[a][b]=[]);'undefined'===typeof this.space[a][b][c]&&(this.space[a][b][c]=[])}add(a,b,c,d){this.check(a,b,c);this.space[a][b][c].push({i:!1,v:d})}addVideoTracking(a,b){this.add('v','vt',a,b)}invalidate(a,b,c,d){this.check(a,b,c);Object.keys(this.space[a][b][c]).forEach(e=>{this.space[a][b][c][e].v===d&&(this.space[a][b][c][e].i=
!0,this.log())})}invalidateVideoTracking(a,b){this.invalidate('v','vt',a,b)}log(a){a=void 0===a?!1:a;const {Environment:b}=this.context;this.logList=b.hostWindow.__YOC.session[this.initConfig.meta.adSessionId].troubleshootingLog=[];b.hostWindow.__YOC.session[this.initConfig.meta.adSessionId].troubleshootingLog.lls='';Object.keys(this.space).forEach(a=>{'ll'!==a&&'lls'!==a&&Object.keys(this.space[a]).forEach(c=>{Object.keys(this.space[a][c]).forEach(e=>{let d=0;Object.keys(this.space[a][c][e]).forEach(b=>
{if('v'!==a||'vt'!==c||'string'!==typeof this.space[a][c][e][b].v||0!==this.space[a][c][e][b].v.length)this.logList[`${a}.${c}.${e}.${b}`]=this.space[a][c][e][b],!0===this.space[a][c][e][b].i&&d++});0<d&&(b.hostWindow.__YOC.session[this.initConfig.meta.adSessionId].troubleshootingLog.lls+=`${0<b.hostWindow.__YOC.session[this.initConfig.meta.adSessionId].troubleshootingLog.lls.length?', ':''}${a}.${c}.${e}:${d}`)})})});a&&console.table(this.logList)}}var na=a(18),ua=a(8),va=a(9);class wa{constructor(a){this.context=
a;this.logger=a.newLogger('InterventionReporter')}init(){if('ReportingObserver'in window)try{(new ReportingObserver(a=>{a.forEach(a=>{if('intervention'===a.type){let b='';a.body&&(b=JSON.stringify(a.body));this.context.messageBus.event.emit({kind:'tracker',event:'heavy-ad-intervention',details:{message:b}})}})})).observe(),this.logger.debug('Set up Intervention Reporter')}catch(e){}}}var ka=wa,za=a(24);m=a(22);c=!1;try{c='undefined'!==typeof document&&'undefined'!==typeof document.currentScript&&
'undefined'!==typeof document.currentScript.parentElement&&document.currentScript.parentElement.hasAttribute('data-yoc-ads')}catch(e){}if(c){let a=null;try{'undefined'!==typeof document.currentScript&&'undefined'!==typeof document.currentScript.parentElement&&(a=document.currentScript.parentElement)}catch(E){console&&console.error&&console.error(E)}let b=null;c=!1;try{a&&(b=B(a))&&(c=!0)}catch(E){console&&console.error&&console.error(E)}const d=(c,e)=>{let d=void 0===e?'':e;c.forEach(c=>{try{b&&b.hasAttribute(c)?
d=b.getAttribute(c):a&&a.hasAttribute(c)&&(d=a.getAttribute(c))}catch(ra){console&&console.error&&console.error(ra)}});return d};m={DeliveredBy:d(['data-delivered-by']),handOverDetected:c,TemplateHubId:'',TemplateVISXId:'',TemplateVISXName:'',SyncUrlImages:d(['data-url-sync-all','data-url-sync-images']),SyncUrlImagesList:[''],SyncUrlIframes:d(['data-url-sync-iframes']),SyncUrlIframesList:[''],PublisherImpressionUrlUnesc:'',ImpressionUrlUnesc:d(['data-url-impression','data-visx-url-impression']),ExtraImpressionUrlsUnesc:'',
ExtraImpressionUrlsList:[''],ClickUrlUnesc:d(['data-url-click']),ViewableAdImpressionUrlUnesc:d(['data-url-viewable','data-visx-url-viewable']),RuntimeStatusUrlUnesc:d(['data-url-status']),Context:d(['data-context']),RtbDealId:'',DealPricingType:'',RtbCreativeId:'',SiteId:d(['data-id-site'],'0'),AdUnitId:d(['data-id-ad-unit'],'0'),RtbIsOpenMarket:!1,Width:0,Height:0,RtbCreativeCodeEsc:'',DealCustomOptions:m.a.decode(d(['data-options-deal','data-visx-options-deal'])),AdUnitCustomOptions:m.a.decode(d(['data-options-adunit',
'data-visx-options-adunit'])),GdprApplied:d(['data-gdpr-applied','data-visx-gdpr-applied']),GdprConsent:d(['data-gdpr-consent','data-visx-gdpr-consent']),IsVISX:!1,IsIO:!1,IsYOCAds:!0,OrderId:d(['data-id-order']),LineItemId:d(['data-id-lineitem']),AdvertiserId:d(['data-id-advertiser']),PublisherId:d(['data-id-publisher']),NomiAdDisplayEffect:d(['data-nomi-ad-display-effect']),RtbDspId:'',RtbDspName:'',PublisherDomain:'',InventoryType:d(['data-type-inventory'],'web'),DemandType:d(['data-type-demand'],
'io'),CreativeId:d(['data-id-creative']),IOLineItemPricingType:'',IOCreativeWidth:'',IOCreativeHeight:'',IOCreativeCustomOptions:m.a.decode(d(['data-options-iocreative','data-visx-options-iocreative'])),IOCreativeCodeEsc:'',ExternalCreativeID:'',YOCAdsPricingType:d(['data-pricing-type'],'CPM'),YOCAdsAdWidth:'$YOC_ADS_AD_WIDTH$',YOCAdsAdHeight:'$YOC_ADS_AD_HEIGHT$',YOCAdsCustomOptions:'$YOC_ADS_CUSTOM_OPTIONS$',YOCAdsCreativeCodeEsc:'$YOC_ADS_CREATIVE_CODE_ESC$',Language:d(['data-language'],''),GeoCountry:d(['data-geo-country'],
''),GeoRegion:d(['data-geo-region'],''),GeoCity:d(['data-geo-city'],''),GeoZIP:d(['data-geo-zip'],'')};m=(a=>Object.assign({},a,{Width:Number(a.YOCAdsAdWidth),Height:Number(a.YOCAdsAdHeight),SyncUrlImagesList:-1<a.SyncUrlImages.indexOf('|')?a.SyncUrlImages.split('|'):[a.SyncUrlImages],SyncUrlIframesList:-1<a.SyncUrlIframes.indexOf('|')?a.SyncUrlIframes.split('|'):[a.SyncUrlIframes],PricingType:a.YOCAdsPricingType,InventoryType:'app'===a.InventoryType?'app':'web',IsVISX:'string'===typeof a.Context&&
0<a.Context.length,DemandType:'string'===typeof a.Context&&0<a.Context.length?'io'===a.DemandType?'io':'rtb':'io',IsIO:'io'===a.DemandType,CreativeCodeEsc:a.YOCAdsCreativeCodeEsc,ImpressionUrlUnesc:`${a.ImpressionUrlUnesc.startsWith('//')?'https:':''}${a.ImpressionUrlUnesc}`,ExtraImpressionUrlsList:-1<a.ExtraImpressionUrlsUnesc.indexOf('|')?a.ExtraImpressionUrlsUnesc.split('|'):[a.ExtraImpressionUrlsUnesc],ClickUrlUnesc:`${a.ClickUrlUnesc.startsWith('//')?'https:':''}${a.ClickUrlUnesc}`,ViewableAdImpressionUrlUnesc:`${a.ViewableAdImpressionUrlUnesc.startsWith('//')?
'https:':''}${a.ViewableAdImpressionUrlUnesc}`,GdprApplied:'0'===a.GdprApplied?'0':'1'}))(m)}else m={DeliveredBy:'',handOverDetected:!1,TemplateHubId:'${TEMPLATE_HUB_ID}',TemplateVISXId:'${TEMPLATE_ID}',TemplateVISXName:'${TEMPLATE_NAME}',SyncUrlImages:'${IMG_SYNC_URLS_UNESC}',SyncUrlImagesList:[''],SyncUrlIframes:'${IFR_SYNC_URLS_UNESC}',SyncUrlIframesList:[''],PublisherImpressionUrlUnesc:'${PUBLISHER_IMPRESSION_URL_UNESC}',ImpressionUrlUnesc:'${IMPRESSION_URL_UNESC}',ExtraImpressionUrlsUnesc:'${IMPRESSION_TRACKING_URLS_UNESC}',
ExtraImpressionUrlsList:[''],ClickUrlUnesc:'${CLICK_URL_UNESC}',ViewableAdImpressionUrlUnesc:'${VIEWABLE_AD_IMPRESSION_URL_UNESC}',RuntimeStatusUrlUnesc:'${RUNTIME_STATUS_URL_UNESC}',Context:'${IMPRESSION_CONTEXT}',RtbDealId:'${RTB_DEAL_ID}',DealPricingType:'${DEAL_PRICING_TYPE}',RtbCreativeId:'${RTB_CREATIVE_ID}',SiteId:'${SITE_ID}',AdUnitId:'${AD_UNIT_ID}',NomiAdDisplayEffect:'${NOMI_AD_DISPLAY_EFFECT}',RtbIsOpenMarket:'${RTB_IS_OPEN_MARKET}',Width:'${WIDTH}',Height:'${HEIGHT}',RtbCreativeCodeEsc:'${RTB_CREATIVE_CODE_ESC}',
DealCustomOptions:'${DEAL_CUSTOM_OPTIONS}',AdUnitCustomOptions:'${AD_UNIT_CUSTOM_OPTIONS}',GdprApplied:'${GDPR_APPLIED}',GdprConsent:'${GDPR_CONSENT}',IsVISX:'true',IsYOCAds:!1,OrderId:'${ORDER_ID}',LineItemId:'${LINE_ITEM_ID}',AdvertiserId:'${ADVERTISER_ID}',PublisherId:'${PUBLISHER_ID}',RtbDspId:'${RTB_DSP_ID}',RtbDspName:'${RTB_DSP_NAME}',PublisherDomain:'',InventoryType:'${INVENTORY_TYPE}',DemandType:'${DEMAND_TYPE}',CreativeId:'${CREATIVE_ID}',IOLineItemPricingType:'@IO_LINEITEM_PRICING_TYPE@',
IOCreativeWidth:'@IO_CREATIVE_WIDTH@',IOCreativeHeight:'@IO_CREATIVE_HEIGHT@',IOCreativeCustomOptions:'@IO_CREATIVE_CUSTOM_OPTIONS@',IOCreativeCodeEsc:'@IO_CREATIVE_CODE_ESC@',ExternalCreativeID:'@IO_CREATIVE_SLOT_ID@',YOCAdsPricingType:'',YOCAdsAdWidth:'',YOCAdsAdHeight:'',YOCAdsCustomOptions:'',YOCAdsCreativeCodeEsc:'',Language:'${REQUEST_LANGUAGE}',GeoCountry:'${REQUEST_GEO_COUNTRY}',GeoRegion:'${REQUEST_GEO_REGION}',GeoCity:'${REQUEST_GEO_CITY}',GeoZIP:'${REQUEST_GEO_ZIP}'},m=(a=>Object.assign({},
a,{RtbIsOpenMarket:'true'===a.RtbIsOpenMarket,IsVISX:'true'===a.IsVISX,IsIO:'io'===a.DemandType,Width:Number('io'===a.DemandType?a.IOCreativeWidth:a.Width),Height:Number('io'===a.DemandType?a.IOCreativeHeight:a.Height),SyncUrlImagesList:-1<a.SyncUrlImages.indexOf('|')?a.SyncUrlImages.split('|'):[a.SyncUrlImages],SyncUrlIframesList:-1<a.SyncUrlIframes.indexOf('|')?a.SyncUrlIframes.split('|'):[a.SyncUrlIframes],PricingType:'io'===a.DemandType?a.IOLineItemPricingType:a.DealPricingType,InventoryType:'app'===
a.InventoryType?'app':'web',DemandType:'io'===a.DemandType?'io':'rtb',CreativeId:'io'===a.DemandType?a.CreativeId:a.RtbCreativeId,CreativeCodeEsc:'io'===a.DemandType?a.IOCreativeCodeEsc:a.RtbCreativeCodeEsc,ImpressionUrlUnesc:`${a.ImpressionUrlUnesc.startsWith('//')?'https:':''}${a.ImpressionUrlUnesc}`,ExtraImpressionUrlsList:-1<a.ExtraImpressionUrlsUnesc.indexOf('|')?a.ExtraImpressionUrlsUnesc.split('|'):[a.ExtraImpressionUrlsUnesc],ClickUrlUnesc:`${a.ClickUrlUnesc.startsWith('//')?'https:':''}${a.ClickUrlUnesc}`,
ViewableAdImpressionUrlUnesc:`${a.ViewableAdImpressionUrlUnesc.startsWith('//')?'https:':''}${a.ViewableAdImpressionUrlUnesc}`,GdprApplied:'0'===a.GdprApplied?'0':'1',IOCreativeCustomOptions:'io'===a.DemandType?a.IOCreativeCustomOptions:'',ExternalCreativeID:'io'===a.DemandType?a.ExternalCreativeID:'',AdvertiserId:-1<a.AdvertiserId.indexOf('$')?'':a.AdvertiserId,OrderId:-1<a.OrderId.indexOf('$')?'':a.OrderId,LineItemId:-1<a.LineItemId.indexOf('$')?'':a.LineItemId}))(m);var Aa=m,sa=a(15);class ya{constructor(a){var {bundle:b,
initConfig:c,adConfigDefault:e,adConfigSpecific:d,adAssetList:f,mraidInfo:g,ownWindow:h,execDelayedTemplateLoaderTrackingSignals:k}=a;this.adPainter=this.adConfigDefault=this.adConfig=this.initConfig=this.logger=this.context=null;this.adAssetList=[];this.isVideoComplete=this.isImage=!1;this.adNodeHidden=this.adNode=this.assets=this.rootContainer=this.containerId=null;this.trackerSync=[];this.trackerImpression=[];this.trackerViewability=[];this.trackerClick=[];this.visibilityHandlerList=[];this.visibilityHandlerDependsOnImpressionList=
[];this.visibilityHandlerViewabilityGroupList=[];this.isVPAID=!1;this.trackerRedirect=[];this.elementsOverlay=this.clickOverlay=null;this.trackerRedirectHasBeenSetUp=!1;this.adConfigSpecific='';this.snapInWasUsed=!1;this.snapInEventListenerOnTouchStart=a=>{};this.snapInEventListenerOnTouchMove=a=>{};this.snapInEventListenerOnTouchEnd=a=>{};this.snapInEventListenerOnScroll=a=>{};this.takeoverTarget=null;this.showTakeover=this.takeoverIsShown=!1;this.demoContainer=this.takeoverVisibilityHandler=null;
this.wasClicked=!1;this.outerContainerForTracking=null;this.refreshLastScrollTop=this.refreshCounter=-1;this.refreshStickyIsDisplayed=!0;this.useMRAIDInlineToStickyConversion=this.usedThirdPartyAd=!1;this.externalMacroDetails=[];this.wasSwiperFirstRealInteractionTracked=this.wasMoatTagInjected=!1;this.swiperSlideActive=0;this.zoomIsInitialized=this.wasImpressionTrackingAligned=!1;this.zoomElement=void 0;this.zoomScaleLatest=this.zoomScaleMaximum=this.zoomScaleMinimum=1;this.zoomVisibilityDetailsLatest=
null;this.zoomIsMovingUp=!1;this.visibilityDetailsLatest=null;this.isMovingUp=!1;this.zoomInitStartTimestamp=0;this.zoomInitTimeout=2E3;this.isFirstZoom=!0;this.onLog=a=>{if(!1!==this.context.Environment.isLogMode||'debug'!==a.kind&&'log'!==a.kind)this.onLogger(a)};this.onEvent=a=>{const b=this.context.newLogger('Ad.onEvent()'),{Environment:c}=this.context;switch(a.kind){case 'assetLoading':this.assets.onEventAssetLoading(a);break;case 'assetLoaded':this.assets.onEventAssetLoaded(a);break;case 'assetFailed':this.assets.onEventAssetFailed(a);
break;case 'assetAllLoaded':this.assets.onEventAssetAllLoaded(a);c.isMRAID&&'interstitial'===c.MRAIDPlacement?Object(x.B)(()=>{this.run()}):this.run();break;case 'tracker':let e=!1;'undefined'!==typeof a.details&&'boolean'===typeof a.details.wasRedirected&&a.details.wasRedirected||this.trackerRedirect.forEach(c=>{c.event===a.event&&(e=!0,b.log(`SKIP processing event "${a.event}" because of enabled event redirect`,{event:c.event,trackOn:c.trackOn}))});if(!e)switch(a.event){case 'viewability':r({kind:'viewability-triggered'});
this.context.messageBus.tracking.emit({kind:'send',event:a.event,meta:a.meta,details:a.details});break;default:this.context.messageBus.tracking.emit({kind:'send',event:a.event,meta:a.meta,details:a.details})}this.trackerRedirect.forEach(c=>{c.trackOn===a.event&&(b.log(`Process additional event "${c.event}" on event "${a.event}" because of enabled event redirect`,{event:c.event,trackOn:c.trackOn}),this.context.messageBus.event.emit({kind:'tracker',event:c.event,details:{wasRedirected:!0}}))});break;
case 'close':case 'auto-close':this.visibilityHandlerList.forEach(a=>{a.disable()});this.visibilityHandlerDependsOnImpressionList.forEach(a=>{a.disable()});this.adPainter.close();this.context.Environment.isMRAID&&Object(x.u)();this.dispose();this.adConfig.display.cleanupOnDispose&&this.remove();break;case 'close-sticky':this.adPainter.closeStickyAd();break;case 'revert-cursor':this.adPainter.revertCursorToDefault();break;case 'show-advertisment-message':this.adPainter.showAdvertisementMessage();this.adPainter.updateAdPosition(this.adVisibilityDetails);
break;case 'setup-tracker-redirect':this.setupTrackerRedirection(a.type);break;case 'shown':this.context.messageBus.event.emit({kind:'tracker',event:'shown'});try{'undefined'!==typeof this.adConfig.feature&&'undefined'!==typeof this.adConfig.feature.swiper&&'undefined'!==typeof this.adConfig.feature.swiper.mode&&'enabled'===this.adConfig.feature.swiper.mode&&this.context.messageBus.event.emit({kind:'tracker',event:'swiper-pageview',details:{activeSlide:1}})}catch(ta){this.logger.error(ta)}break;case 'assets-ready-check':this.assets.readyCheck()}};
this.processSnapIn=a=>{a=void 0===a?this.adVisibilityDetails:a;const {Environment:b}=this.context;this.adVisibilityDetails=a;'enabled'===this.adConfig.snapIn.mode&&0<this.adConfig.snapIn.threshold&&100*this.adVisibilityDetails.visibilityPercentage>this.adConfig.snapIn.threshold&&!this.snapInWasUsed&&(this.snapInWasUsed=!0,this.logger.log(`Snap in - visible for ${100*this.adVisibilityDetails.visibilityPercentage}% (Position: ${this.adVisibilityDetails.top}x${this.adVisibilityDetails.left} - Dimension: ${this.adVisibilityDetails.width}x${this.adVisibilityDetails.height})`),
b.determineScrollPosition(),b.hostWindow.scrollTo({top:b.scrollTop+(this.adVisibilityDetails.height-this.adVisibilityDetails.visibilityPercentage*this.adVisibilityDetails.height),left:b.scrollLeft,behavior:'smooth'}),0<this.adConfig.snapIn.lockTime&&this.processSnapInLock())};this.processSnapInLock=()=>{'enabled'===this.adConfig.snapIn.mode&&(this.logger.log('Snap in - LOCK'),this.snapInEventListenerOnTouchStart=a=>{a.preventDefault()},this.adPainter.rootContainer.addEventListener('touchstart',this.snapInEventListenerOnTouchStart),
this.snapInEventListenerOnTouchMove=a=>{a.preventDefault()},this.adPainter.rootContainer.addEventListener('touchmove',this.snapInEventListenerOnTouchMove),this.snapInEventListenerOnTouchEnd=a=>{a.preventDefault()},this.adPainter.rootContainer.addEventListener('touchend',this.snapInEventListenerOnTouchEnd),this.snapInLockTimeoutId=this.context.Environment.hostWindow.setTimeout(()=>{this.processSnapInUnlock()},this.adConfig.snapIn.lockTime))};this.processSnapInUnlock=()=>{'enabled'===this.adConfig.snapIn.mode&&
(this.logger.log('Snap in - UNLOCK'),this.adPainter.rootContainer.removeEventListener('touchstart',this.snapInEventListenerOnTouchStart),this.adPainter.rootContainer.removeEventListener('touchmove',this.snapInEventListenerOnTouchMove),this.adPainter.rootContainer.removeEventListener('touchend',this.snapInEventListenerOnTouchEnd),this.snapInLockTimeoutId=void 0)};a=new oa(this,h,c.product.title.replace(/ /g,''),c);const {Environment:l}=a;this.context=a;this.execDelayedTemplateLoaderTrackingSignals=
k;g&&(l.isMRAID=!0,l.MRAIDPlacement=g.placement,l.MRAIDVersion=g.version,l.MRAIDIsVisxSDK=g.isVisxSDK,l.MRAIDUseCustomClose=g.useCustomClose,this.context.messageBus.event.emit({kind:'tracker',event:'mraid-version',details:{version:g.version}}));this.logger=this.context.newLogger('AdCore');this.bundle=b;this.initConfig=c;this.adConfigDefault=this.adConfig=e;this.adConfigSpecific=d;this.adAssetList=f;this.adVisibilityDetails={visibilityPercentage:0,left:0,top:0,right:0,bottom:0,width:0,height:0,visibilityX:0,
visibilityY:0}}init(){this.context.messageBus.logger.on(this.onLog);const {Environment:a,Listener:c}=this.context;if(a.isMRAID&&'yoc-mystery-ad'===this.initConfig.product.key){var {closeButton:d}=this.adConfig;this.logger.debug(`overriding closeButton placement from ${d.placement} to inside`);d.placement=l.e}this.externalMacroDetails.InternalLanguage=this.initConfig.meta.language;this.externalMacroDetails.InternalGeoCountry=this.initConfig.meta.geoCountry;this.externalMacroDetails.InternalGeoRegion=
this.initConfig.meta.geoRegion;this.externalMacroDetails.InternalGeoCity=this.initConfig.meta.geoCity;this.externalMacroDetails.InternalGeoZIP=this.initConfig.meta.geoZIP;this.externalMacroDetails.TrackingContext=this.initConfig.tracking.context;this.adConfig=this.mergeAdConfig(this.adConfig,this.adConfigSpecific,this.initConfig.options.adUnit,this.initConfig.options.deal,this.initConfig.options.ioCreative,this.initConfig.options.yocAds);a.preInit(this.context,this.initConfig,this.adConfig,this.bundle);
if(''!==this.initConfig.meta.nomiAdDisplayEffect&&'${NOMI_AD_DISPLAY_EFFECT}'!==this.initConfig.meta.nomiAdDisplayEffect)if('fullscreenOverlay'===this.initConfig.meta.nomiAdDisplayEffect&&'celtra-interstitial'===this.adConfig.thirdParty.creativeSource.hidden&&'redirect'===this.adConfig.creative.hidden.mode)this.context.Environment.universalDisplayEffectUsed='fullscreenOverlay',this.logger.log("NOMI: fullscreenOverlay - use creative code from hidden creative'"),this.initConfig.creativeCode=this.adConfig.creative.hidden.redirectCode,
'redirect'===this.adConfig.creative.portrait.mode&&(this.adConfig.creative.portrait.useCreativeCodeInstead=!0),'redirect'===this.adConfig.creative.landscape.mode&&(this.adConfig.creative.landscape.useCreativeCodeInstead=!0),this.adConfig.thirdParty.creativeSource.portrait=this.adConfig.thirdParty.creativeSource.hidden,this.adConfig.thirdParty.creativeSource.landscape=this.adConfig.thirdParty.creativeSource.hidden,this.adConfig.display.hide=!0,this.adConfig.display.responsive.mode='noScale',this.adConfig.display.effect=
'none',this.adConfig.advertisementMessage.contentAbove='',this.adConfig.advertisementMessage.contentBelow='';else if('fullscreenOverlay'===this.initConfig.meta.nomiAdDisplayEffect){if(this.context.Environment.universalDisplayEffectUsed='fullscreenOverlay',this.logger.log(`NOMI: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),this.initConfig.layout='fullscreen-overlay',this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed,
this.adConfig.display.zIndex=6E6,this.adConfig.display.stickyMaxHeightPercentage=0,this.adConfig.display.toStickyThreshold=0,this.adConfig.display.bgColorOverlay='rgba(0,0,0,0.5)','static-image'===this.adConfig.video.muteUnmuteButton.mode&&(this.adConfig.video.muteUnmuteButton.placement=l.e),this.adConfig.closeButton.mode='enabled',this.adConfig.closeButton.placement=l.g,this.adConfig.closeButton.delayDisplay=0,this.adConfig.advertisementMessage.contentAbove='',this.adConfig.advertisementMessage.contentBelow=
'',a.isMRAID){var {closeButton:f}=this.adConfig;this.logger.debug(`overriding closeButton placement from ${f.placement} to inside`);f.placement=l.e}}else'sitebar'===this.initConfig.meta.nomiAdDisplayEffect&&this.context.Environment.isDeviceDesktop?(this.context.Environment.universalDisplayEffectUsed='sitebar',this.logger.log(`NOMI: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),this.initConfig.layout='sticky',this.adConfig.display.effect=
this.context.Environment.universalDisplayEffectUsed,this.adConfig.display.zIndex=6E6,this.adConfig.closeButton.mode='only-sticky',this.adConfig.advertisementMessage.contentAbove='',this.adConfig.advertisementMessage.contentBelow='',this.adConfig.placement.responsive=b(this.adConfig)):'sticky'===this.initConfig.meta.nomiAdDisplayEffect&&'celtra-banner-sticky'===this.adConfig.thirdParty.creativeSource.sticky&&'redirect'===this.adConfig.creative.sticky.mode?(this.context.Environment.universalDisplayEffectUsed=
'sticky',this.logger.log("NOMI: sticky - use creative code from hidden creative'"),this.initConfig.creativeCode=this.adConfig.creative.sticky.redirectCode,'redirect'===this.adConfig.creative.portrait.mode&&(this.adConfig.creative.portrait.useCreativeCodeInstead=!0),'redirect'===this.adConfig.creative.landscape.mode&&(this.adConfig.creative.landscape.useCreativeCodeInstead=!0),this.adConfig.thirdParty.creativeSource.portrait=this.adConfig.thirdParty.creativeSource.sticky,this.adConfig.thirdParty.creativeSource.landscape=
this.adConfig.thirdParty.creativeSource.sticky,this.adConfig.display.hide=!0,this.adConfig.display.responsive.mode='noScale',this.adConfig.display.effect='none',this.adConfig.advertisementMessage.contentAbove='',this.adConfig.advertisementMessage.contentBelow=''):'sticky'===this.initConfig.meta.nomiAdDisplayEffect?(this.context.Environment.universalDisplayEffectUsed='sticky',this.logger.log(`NOMI: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),
this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed):'inlineToSticky'===this.initConfig.meta.nomiAdDisplayEffect?(this.context.Environment.universalDisplayEffectUsed='inlineToSticky',this.logger.log(`NOMI: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed):'zoom'===this.initConfig.meta.nomiAdDisplayEffect?(this.context.Environment.universalDisplayEffectUsed=
'zoom',this.logger.log(`NOMI: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed,this.adConfig=this.applyDefaultAdConfigYZA(this.adConfig,this.adConfigDefault,a)):'zoomToSticky'===this.initConfig.meta.nomiAdDisplayEffect?(this.context.Environment.universalDisplayEffectUsed='zoomToSticky',this.logger.log(`NOMI: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),
this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed,this.adConfig=this.applyDefaultAdConfigYZA(this.adConfig,this.adConfigDefault,a)):'understitialMiniToSticky'===this.initConfig.meta.nomiAdDisplayEffect?(this.context.Environment.universalDisplayEffectUsed='understitialMiniToSticky',this.logger.log(`NOMI: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed):
'none'===this.initConfig.meta.nomiAdDisplayEffect?(this.context.Environment.universalDisplayEffectUsed='none',this.logger.log(`NOMI: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed,this.adConfig.advertisementMessage.contentAbove='',this.adConfig.advertisementMessage.contentBelow=''):this.logger.log('NOMI: No action');else{if('universal-ad-format'===
this.initConfig.product.key&&'enabled'===this.adConfig.universal.mode&&('string'!==typeof this.adConfig.universal.effect||0===this.adConfig.universal.effect.length)&&(this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop)){d=this.detectAllowedEffect(this.adConfig.universal);let [a,b]=[Object.keys(d)[0],Object.values(d)[0]];
for(f of Object.entries(d))if([a,b]=f,b&&!a.includes('understitial','understitialMini')){this.adConfig.universal.effect=a;break}var h='autoselect-missingadeffect';this.logger.log(`Universal effect is not detected, Applied allowed universal effect: ${this.adConfig.universal.effect}`)}this.context.Environment.universalDisplayEffectUsed=this.adConfig.display.effect;if('universal-ad-format'===this.initConfig.product.key&&'enabled'===this.adConfig.universal.mode&&'string'===typeof this.adConfig.universal.effect){this.context.Environment.universalDisplayEnabled=
!0;d=this.detectAllowedEffect(this.adConfig.universal);Object.keys(d);Object.values(d);for(var k of Object.entries(d));const c=this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.zoom||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.zoom||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.zoom,e=this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.zoomToSticky||this.context.Environment.isDeviceTablet&&
this.adConfig.universal.allowOnTablet.zoomToSticky||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.zoomToSticky;this.context.Environment.universalDisplayEffectContainsSticky=!1;'sticky'===this.adConfig.universal.effect?this.context.Environment.universalDisplayEffectContainsSticky=!0:-1<this.adConfig.universal.effect.indexOf(',')&&this.adConfig.universal.effect.split(',').includes('sticky')&&(this.context.Environment.universalDisplayEffectContainsSticky=!0);this.context.Environment.universalDisplayEffectContainsSticky&&
this.logger.log(`Universal mode: Contains sticky effect in '${this.adConfig.universal.effect}'`);-1<this.adConfig.universal.effect.indexOf(',')&&(this.logger.log(`Universal mode: Try to find the most suitable effect from '${this.adConfig.universal.effect}'`),this.adConfig.universal.effect.split(',').forEach(a=>{'enabled'===this.adConfig.universal.mode&&-1<this.adConfig.universal.effect.indexOf(',')&&('sitebar'===a&&this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.sitebar&&
(this.logger.log(`Universal mode: Found the most suitable effect '${a}'`),this.adConfig.universal.effect=a),'fullscreenOverlay'===a&&(this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.fullscreenOverlay||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.fullscreenOverlay||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.fullscreenOverlay)?(this.logger.log(`Universal mode: Found the most suitable effect '${a}'`),
this.adConfig.universal.effect=a):'sticky'===a&&(this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.sticky||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.sticky||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.sticky)?(this.logger.log(`Universal mode: Found the most suitable effect '${a}'`),this.adConfig.universal.effect=a):'inlineToSticky'===a&&(this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.inlineToSticky||
this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.inlineToSticky||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.inlineToSticky)?(this.logger.log(`Universal mode: Found the most suitable effect '${a}'`),this.adConfig.universal.effect=a):'zoom'===a&&c?(this.logger.log(`Universal mode: Found the most suitable effect '${a}'`),this.adConfig.universal.effect=a):'zoomToSticky'===a&&e?(this.logger.log(`Universal mode: Found the most suitable effect '${a}'`),
this.adConfig.universal.effect=a):'understitialMiniToSticky'===a&&(this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.understitialMiniToSticky||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.understitialMiniToSticky||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.understitialMiniToSticky)?(this.logger.log(`Universal mode: Found the most suitable effect '${a}'`),this.adConfig.universal.effect=a):'none'===
a&&(this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.none||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.none||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.none)?(this.logger.log(`Universal mode: Found the most suitable effect '${a}'`),this.adConfig.universal.effect=a):this.logger.log(`Universal mode: Invalid effect '${a}'`))}));this.logger.log(`Universal mode: Enabled (default: '${this.adConfig.display.effect}' desired: '${this.adConfig.universal.effect}')`);
this.context.Environment.universalDisplayEffectUsed=this.adConfig.display.effect;'fullscreenOverlay'===this.adConfig.universal.effect&&'celtra-interstitial'===this.adConfig.thirdParty.creativeSource.hidden&&(this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.fullscreenOverlay||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.fullscreenOverlay||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.fullscreenOverlay)&&
'redirect'===this.adConfig.creative.hidden.mode?(this.context.Environment.universalDisplayEffectUsed='fullscreenOverlay',this.logger.log("Universal mode: fullscreenOverlay - use creative code from hidden creative'"),this.initConfig.creativeCode=this.adConfig.creative.hidden.redirectCode,'redirect'===this.adConfig.creative.portrait.mode&&(this.adConfig.creative.portrait.useCreativeCodeInstead=!0),'redirect'===this.adConfig.creative.landscape.mode&&(this.adConfig.creative.landscape.useCreativeCodeInstead=
!0),this.adConfig.thirdParty.creativeSource.portrait=this.adConfig.thirdParty.creativeSource.hidden,this.adConfig.thirdParty.creativeSource.landscape=this.adConfig.thirdParty.creativeSource.hidden,this.adConfig.display.hide=!0,this.adConfig.display.responsive.mode='noScale',this.adConfig.display.effect='none',this.adConfig.advertisementMessage.contentAbove='',this.adConfig.advertisementMessage.contentBelow=''):'fullscreenOverlay'===this.adConfig.universal.effect&&(this.context.Environment.isDeviceSmartphone&&
this.adConfig.universal.allowOnSmartphone.fullscreenOverlay||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.fullscreenOverlay||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.fullscreenOverlay)?(this.context.Environment.universalDisplayEffectUsed='fullscreenOverlay',this.logger.log(`Universal mode: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),this.initConfig.layout=
'fullscreen-overlay',this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed,this.adConfig.display.zIndex=6E6,this.adConfig.display.stickyMaxHeightPercentage=0,this.adConfig.display.toStickyThreshold=0,this.adConfig.display.bgColorOverlay='rgba(0,0,0,0.5)','static-image'===this.adConfig.video.muteUnmuteButton.mode&&(this.adConfig.video.muteUnmuteButton.placement=l.e),this.adConfig.closeButton.mode='enabled',this.adConfig.closeButton.placement=l.g,this.adConfig.closeButton.delayDisplay=
0,this.adConfig.advertisementMessage.contentAbove='',this.adConfig.advertisementMessage.contentBelow='',a.isMRAID&&({closeButton:f}=this.adConfig,this.logger.debug(`overriding closeButton placement from ${f.placement} to inside`),f.placement=l.e)):'sitebar'===this.adConfig.universal.effect&&this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.sitebar?(this.context.Environment.universalDisplayEffectUsed='sitebar',this.logger.log(`Universal mode: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),
this.initConfig.layout='sticky',this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed,this.adConfig.display.zIndex=6E6,this.adConfig.closeButton.mode='only-sticky',this.adConfig.advertisementMessage.contentAbove='',this.adConfig.advertisementMessage.contentBelow='',this.adConfig.placement.responsive=b(this.adConfig)):'sticky'===this.adConfig.universal.effect&&'celtra-banner-sticky'===this.adConfig.thirdParty.creativeSource.sticky&&(this.context.Environment.isDeviceSmartphone&&
this.adConfig.universal.allowOnSmartphone.sticky||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.sticky||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.sticky)&&'redirect'===this.adConfig.creative.sticky.mode?(this.context.Environment.universalDisplayEffectUsed='sticky',this.logger.log("Universal mode: sticky - use creative code from hidden creative'"),this.initConfig.creativeCode=this.adConfig.creative.sticky.redirectCode,'redirect'===
this.adConfig.creative.portrait.mode&&(this.adConfig.creative.portrait.useCreativeCodeInstead=!0),'redirect'===this.adConfig.creative.landscape.mode&&(this.adConfig.creative.landscape.useCreativeCodeInstead=!0),this.adConfig.thirdParty.creativeSource.portrait=this.adConfig.thirdParty.creativeSource.sticky,this.adConfig.thirdParty.creativeSource.landscape=this.adConfig.thirdParty.creativeSource.sticky,this.adConfig.display.hide=!0,this.adConfig.display.responsive.mode='noScale',this.adConfig.display.effect=
'none',this.adConfig.advertisementMessage.contentAbove='',this.adConfig.advertisementMessage.contentBelow=''):'sticky'===this.adConfig.universal.effect&&(this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.sticky||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.sticky||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.sticky)?(this.context.Environment.universalDisplayEffectUsed='sticky',this.logger.log(`Universal mode: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),
this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed):'inlineToSticky'===this.adConfig.universal.effect&&(this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.inlineToSticky||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.inlineToSticky||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.inlineToSticky)?(this.context.Environment.universalDisplayEffectUsed='inlineToSticky',this.logger.log(`Universal mode: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),
this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed):'zoom'===this.adConfig.universal.effect&&c?(this.context.Environment.universalDisplayEffectUsed='zoom',this.logger.log(`Universal mode: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed,this.adConfig=this.applyDefaultAdConfigYZA(this.adConfig,this.adConfigDefault,a)):
'zoomToSticky'===this.adConfig.universal.effect&&e?(this.context.Environment.universalDisplayEffectUsed='zoomToSticky',this.logger.log(`Universal mode: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed,this.adConfig=this.applyDefaultAdConfigYZA(this.adConfig,this.adConfigDefault,a)):'understitialMiniToSticky'===this.adConfig.universal.effect&&(this.context.Environment.isDeviceSmartphone&&
this.adConfig.universal.allowOnSmartphone.understitialMiniToSticky||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.understitialMiniToSticky||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.understitialMiniToSticky)?(this.context.Environment.universalDisplayEffectUsed='understitialMiniToSticky',this.logger.log(`Universal mode: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),
this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed):'none'===this.adConfig.universal.effect&&(this.context.Environment.isDeviceSmartphone&&this.adConfig.universal.allowOnSmartphone.none||this.context.Environment.isDeviceTablet&&this.adConfig.universal.allowOnTablet.none||this.context.Environment.isDeviceDesktop&&this.adConfig.universal.allowOnDesktop.none)?(this.context.Environment.universalDisplayEffectUsed='none',this.logger.log(`Universal mode: Switch from display effect '${this.adConfig.display.effect}' to '${this.context.Environment.universalDisplayEffectUsed}'`),
this.adConfig.display.effect=this.context.Environment.universalDisplayEffectUsed,this.adConfig.advertisementMessage.contentAbove='',this.adConfig.advertisementMessage.contentBelow=''):this.logger.log('Universal mode: No action')}else'universal-ad-format'===this.initConfig.product.key&&'string'===typeof this.adConfig.universal.effect&&0<this.adConfig.universal.effect.length&&(['celtra-interscroller'].includes(this.adConfig.thirdParty.creativeSource.portrait)&&'redirect'===this.adConfig.creative.portrait.mode||
['celtra-interscroller'].includes(this.adConfig.thirdParty.creativeSource.landscape)&&'redirect'===this.adConfig.creative.landscape.mode)&&(this.logger.log("Universal mode: Reset responsive mode to 'noScale' and the effect to 'none'"),this.adConfig.display.responsive.mode='noScale',this.adConfig.display.effect='none')}('sitebar'===this.adConfig.display.effect||'fullscreenOverlay'===this.adConfig.display.effect)&&-1<this.bundle.indexOf('video')&&'disabled'===this.adConfig.creative.portrait.mode&&'undefined'!==
typeof this.adConfig.display.blurredBackground&&!0===this.adConfig.display.blurredBackground&&(this.logger.log("Enable settings for blurred background'"),this.adConfig.video.background.mode='enabled',this.adConfig.video.background.video={top:0,left:0,align:'center'},this.adConfig.creative.portrait.mode='blurred-video',this.adConfig.creative.portrait.width=0,this.adConfig.creative.portrait.height=0,this.adConfig.creative.portrait.type='sharp',this.adConfig.creative.portrait.updateInterval=0,this.adConfig.video.vpaidEnabled=
!1);['zoom','zoomToSticky'].includes(this.adConfig.display.effect)&&-1<this.bundle.indexOf('video')&&'disabled'===this.adConfig.creative.portrait.mode&&(this.logger.log("YZA - Enable settings for automatic blurred background'"),this.adConfig.video.background.mode='enabled',this.adConfig.video.background.video={top:0,left:0,align:'center'},this.adConfig.creative.portrait.mode='blurred-video',this.adConfig.creative.portrait.width=0,this.adConfig.creative.portrait.height=0,this.adConfig.creative.portrait.type=
'sharp',this.adConfig.creative.portrait.updateInterval=0,this.adConfig.video.vpaidEnabled=!1);if(l.s.includes(this.adConfig.thirdParty.creativeSource.portrait)||l.s.includes(this.adConfig.thirdParty.creativeSource.landscape))this.logger.log("Set the flag for 3rd party creative source to rely on ThirdPartyAd viewability tracking, etc.'"),this.usedThirdPartyAd=!0;({display:{effect:f}}=this.adConfig);if(q(this.initConfig,this.adConfig)&&'18'!==this.initConfig.meta.dspId){try{var m=Object(H.a)().wnd;
m&&m.__YOC&&m.__YOC.refresh&&m.__YOC.refresh[this.initConfig.meta.adUnitProductId]&&'number'===typeof m.__YOC.refresh[this.initConfig.meta.adUnitProductId].counter&&(this.refreshCounter=m.__YOC.refresh[this.initConfig.meta.adUnitProductId].counter,0>this.refreshCounter&&(this.refreshCounter=0),9<this.refreshCounter&&(this.refreshCounter=9),0<this.refreshCounter&&'sticky'===this.adConfig.display.effect&&(this.logger.log(`Refresh is used: Disable sticky effect for all (following) refreshes - actual: ${this.refreshCounter}`),
this.adConfig.display.effect='none','string'===typeof m.__YOC.refresh[this.initConfig.meta.adUnitProductId].effect&&(m.__YOC.refresh[this.initConfig.meta.adUnitProductId].effect=this.adConfig.display.effect)))}catch(G){this.logger.error(G)}this.logger.log('Refresh is used: Force cleanupOnDispose to true');this.adConfig.display.cleanupOnDispose=!0;this.logger.log('Refresh is used: Force invalidateDeliveryContainerID to true');this.adConfig.display.invalidateDeliveryContainerID=!0;'sticky'===this.adConfig.display.effect?
(this.logger.log(`Refresh is used: Set forceUsingDeliveryContainer to 'false' because of display effect '${this.adConfig.display.effect}'`),this.adConfig.display.forceUsingDeliveryContainer=!1):(this.logger.log(`Refresh is used: Set forceUsingDeliveryContainer to 'true' because of display effect '${this.adConfig.display.effect}'`),this.adConfig.display.forceUsingDeliveryContainer=!0);this.logger.log('Refresh is used: Force useFriendlyIframe to false');this.adConfig.display.useFriendlyIframe=!1;this.adConfig.display.sandboxForIframes=
'allow-same-origin allow-forms allow-scripts allow-popups';this.logger.log(`Refresh is used: Set sandboxForIframes to '${this.adConfig.display.sandboxForIframes}'`)}else q(this.initConfig,this.adConfig)&&'18'===this.initConfig.meta.dspId&&this.logger.log('Refresh is activated but BLOCKED');a.init(this.initConfig,this.adConfig,this.bundle);if(a.isLogMode||a.isDebugMode)this.context.troubleshooting=new ba(this.context,this.initConfig,this.adConfig);a.isDebugMode&&new O(this.context);this.rootContainer=
a.rootContainer;this.containerId=this.rootContainer.id;this.context.messageBus.event.on(this.onEvent);'third-party-ad'!==this.initConfig.product.key&&!0===this.adConfig.display.injectInsideIframe&&a.isMRAID&&this.isCeltraCreative()&&(this.logger.log('Celtra creative inside MRAID: overriding injectInsideIframe to false'),this.adConfig.display.injectInsideIframe=!1);if(this.adConfig.tracking.extendClickTrackingURL||this.initConfig.meta.visx&&!this.initConfig.meta.io)this.logger.log(`Adding dummy URL to click tracking URL because of${this.initConfig.meta.visx?
' isVIS.X':''}${this.initConfig.meta.io?' isIO':''}${this.adConfig.tracking.extendClickTrackingURL?' CustomOption':''}`),this.initConfig.tracking.click=`${this.initConfig.tracking.click}${encodeURIComponent(l.h)}`;this.context.messageBus.event.emit({kind:'setup-tracker-redirect',type:'normal'});this.context.metrics=new K(this.context,this.adConfig,this.rootContainer,this.initConfig.meta,this.initConfig.product,this.initConfig.tracking);this.adConfig.metrics.provider.forEach(a=>{this.context.metrics.registerProvider(a.title,
a.type,a.configuration)});try{const {deliveredBy:a}=this.context.initConfig.meta;if(['visx','gam','dv360','ttd','xandr'].includes(a.toLowerCase())){let b=`delivered-by-${a.toLowerCase()}`;'visx'===a.toLowerCase()&&(b=this.initConfig.meta.io?b+'-io':this.initConfig.meta.om?b+'-om':b+'-deal');this.context.messageBus.event.emit({kind:'tracker',event:b})}else''===a?this.context.messageBus.event.emit({kind:'tracker',event:'delivered-by-unknown'}):this.context.messageBus.event.emit({kind:'tracker',event:'delivered-by-invalid'})}catch(G){this.logger.error(G)}if('universal-ad-format'===
this.initConfig.product.key||'enabled'===this.adConfig.universal.mode)m=this.detectDeviceType(),h&&this.context.messageBus.event.emit({kind:'tracker',event:`uaf-${m}-${h}`}),this.context.messageBus.event.emit({kind:'tracker',event:`uaf-${m}-${this.context.Environment.universalDisplayEffectUsed.toLocaleLowerCase()}`});this.initConfig.tracking.syncUrlImages&&(this.trackerSync.push(...this.initConfig.tracking.syncUrlImages.map(a=>Object(w.f)('served',a))),this.trackerSync.forEach(a=>{this.context.messageBus.tracking.emit({kind:'register',
event:'served',tracker:a})}));this.initConfig.tracking.syncUrlIframes&&(this.trackerSync.push(...this.initConfig.tracking.syncUrlIframes.map(a=>Object(w.d)('served',a))),this.trackerSync.forEach(a=>{this.context.messageBus.tracking.emit({kind:'register',event:'served',tracker:a})}));try{this.context.Environment.isRefresh?(h=[],'string'===typeof this.initConfig.tracking.runtimeStatusUrl&&0<this.initConfig.tracking.runtimeStatusUrl.length&&(h.push(Object(w.f)('impression',this.initConfig.tracking.runtimeStatusUrl.replace('{STATUS_CODE}',
`6165${this.refreshCounter}`))),this.adConfig.metrics.runtimeTroubleshootingEvents&&(h.push(Object(w.f)('served',this.initConfig.tracking.runtimeStatusUrl.replace('{STATUS_CODE}',`6161${this.refreshCounter}`))),h.push(Object(w.f)('init',this.initConfig.tracking.runtimeStatusUrl.replace('{STATUS_CODE}',`6162${this.refreshCounter}`))),h.push(Object(w.f)('ready',this.initConfig.tracking.runtimeStatusUrl.replace('{STATUS_CODE}',`6163${this.refreshCounter}`))),h.push(Object(w.f)('shown',this.initConfig.tracking.runtimeStatusUrl.replace('{STATUS_CODE}',
`6164${this.refreshCounter}`))),h.push(Object(w.f)('viewability',this.initConfig.tracking.runtimeStatusUrl.replace('{STATUS_CODE}',`6166${this.refreshCounter}`))),h.push(Object(w.f)('click',this.initConfig.tracking.runtimeStatusUrl.replace('{STATUS_CODE}',`6167${this.refreshCounter}`))))),h.forEach(a=>{this.context.messageBus.tracking.emit({kind:'register',event:a.event,tracker:a})}),this.adConfig.display.stickyAutoShowHide&&'sticky'===this.adConfig.display.effect&&this.context.Environment.hostWindow.addEventListener('scroll',
a=>{try{this.refreshStickyAnimationTimeoutId&&(this.logger.log('Sticky auto-show-hide - clear timeout'),this.context.Environment.hostWindow.clearTimeout(this.refreshStickyAnimationTimeoutId)),this.logger.log(`Sticky auto-show-hide - set timeout (${this.adConfig.display.stickyAnimationDelay})`),this.refreshStickyAnimationTimeoutId=this.context.Environment.hostWindow.setTimeout(()=>{const a=this.context.Environment.hostWindow.pageYOffset||this.context.Environment.hostWindow.scrollY||this.context.Environment.hostDocument.body.scrollTop;
this.refreshStickyIsDisplayed&&this.refreshLastScrollTop<a?(this.refreshStickyIsDisplayed=!1,this.logger.log('Sticky auto-show-hide - HIDE'),this.hideTakeoverContainer(this.adPainter.rootContainer)):!this.refreshStickyIsDisplayed&&this.refreshLastScrollTop>a&&(this.refreshStickyIsDisplayed=!0,this.logger.log('Sticky auto-show-hide - SHOW'),this.showTakeoverContainer(this.adPainter.rootContainer));this.refreshLastScrollTop=a},this.adConfig.display.stickyAnimationDelay)}catch(W){this.logger.error(W)}},
za.a?{passive:!0}:!1)):q(this.initConfig,this.adConfig)&&'18'===this.initConfig.meta.dspId&&this.context.messageBus.event.emit({kind:'tracker',event:'refresh-blocked'})}catch(G){this.logger.error(G)}this.context.Environment.isAdUnitWidthZeroDetected&&(this.logger.warn('Ad unit width of 0 detected'),this.context.messageBus.event.emit({kind:'tracker',event:'ad-unit-error-width-zero-detected'}),this.context.Environment.isAdUnitWidthZeroAutoFix?(this.logger.warn('Ad unit width of 0 automatically fixed'),
this.context.messageBus.event.emit({kind:'tracker',event:'ad-unit-error-width-zero-auto-fix'})):this.context.Environment.isAdUnitWidthZeroNoFix?(this.logger.warn("Ad unit width of 0 can't be automatically fixed"),this.context.messageBus.event.emit({kind:'tracker',event:'ad-unit-error-width-zero-no-fix'})):this.logger.warn('Ad unit zero width detected with unknown status'));(new ka(this.context)).init();try{t.g(a,'@charset "UTF-8";\n\n/*!\n * animate.css -https://daneden.github.io/animate.css/\n * Version - 3.7.2\n * Licensed under the MIT license - http://opensource.org/licenses/MIT\n *\n * Copyright (c) 2019 Daniel Eden\n */\n\n@-webkit-keyframes slideInDownAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, -100%, 0);\n        transform: translate3d(0, -100%, 0);\n        visibility: visible;\n    }\n\n    to {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n}\n\n@keyframes slideInDownAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, -100%, 0);\n        transform: translate3d(0, -100%, 0);\n        visibility: visible;\n    }\n\n    to {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n}\n\n.slideInDownAD_SESSION_ID {\n    -webkit-animation-name: slideInDownAD_SESSION_ID;\n    animation-name: slideInDownAD_SESSION_ID;\n}\n\n@-webkit-keyframes slideInLeftAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(-100%, 0, 0);\n        transform: translate3d(-100%, 0, 0);\n        visibility: visible;\n    }\n\n    to {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n}\n\n@keyframes slideInLeftAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(-100%, 0, 0);\n        transform: translate3d(-100%, 0, 0);\n        visibility: visible;\n    }\n\n    to {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n}\n\n.slideInLeftAD_SESSION_ID {\n    -webkit-animation-name: slideInLeftAD_SESSION_ID;\n    animation-name: slideInLeftAD_SESSION_ID;\n}\n\n@-webkit-keyframes slideInRightAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(100%, 0, 0);\n        transform: translate3d(100%, 0, 0);\n        visibility: visible;\n    }\n\n    to {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n}\n\n@keyframes slideInRightAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(100%, 0, 0);\n        transform: translate3d(100%, 0, 0);\n        visibility: visible;\n    }\n\n    to {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n}\n\n.slideInRightAD_SESSION_ID {\n    -webkit-animation-name: slideInRightAD_SESSION_ID;\n    animation-name: slideInRightAD_SESSION_ID;\n}\n\n@-webkit-keyframes slideInUpAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, 100%, 0);\n        transform: translate3d(0, 100%, 0);\n        visibility: visible;\n    }\n\n    to {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n}\n\n@keyframes slideInUpAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, 100%, 0);\n        transform: translate3d(0, 100%, 0);\n        visibility: visible;\n    }\n\n    to {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n}\n\n.slideInUpAD_SESSION_ID {\n    -webkit-animation-name: slideInUpAD_SESSION_ID;\n    animation-name: slideInUpAD_SESSION_ID;\n}\n\n@-webkit-keyframes slideOutDownAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n\n    to {\n        visibility: hidden;\n        -webkit-transform: translate3d(0, 100%, 0);\n        transform: translate3d(0, 100%, 0);\n    }\n}\n\n@keyframes slideOutDownAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n\n    to {\n        visibility: hidden;\n        -webkit-transform: translate3d(0, 100%, 0);\n        transform: translate3d(0, 100%, 0);\n    }\n}\n\n.slideOutDownAD_SESSION_ID {\n    -webkit-animation-name: slideOutDownAD_SESSION_ID;\n    animation-name: slideOutDownAD_SESSION_ID;\n}\n\n@-webkit-keyframes slideOutLeftAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n\n    to {\n        visibility: hidden;\n        -webkit-transform: translate3d(-100%, 0, 0);\n        transform: translate3d(-100%, 0, 0);\n    }\n}\n\n@keyframes slideOutLeftAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n\n    to {\n        visibility: hidden;\n        -webkit-transform: translate3d(-100%, 0, 0);\n        transform: translate3d(-100%, 0, 0);\n    }\n}\n\n.slideOutLeftAD_SESSION_ID {\n    -webkit-animation-name: slideOutLeftAD_SESSION_ID;\n    animation-name: slideOutLeftAD_SESSION_ID;\n}\n\n@-webkit-keyframes slideOutRightAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n\n    to {\n        visibility: hidden;\n        -webkit-transform: translate3d(100%, 0, 0);\n        transform: translate3d(100%, 0, 0);\n    }\n}\n\n@keyframes slideOutRightAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n\n    to {\n        visibility: hidden;\n        -webkit-transform: translate3d(100%, 0, 0);\n        transform: translate3d(100%, 0, 0);\n    }\n}\n\n.slideOutRightAD_SESSION_ID {\n    -webkit-animation-name: slideOutRightAD_SESSION_ID;\n    animation-name: slideOutRightAD_SESSION_ID;\n}\n\n@-webkit-keyframes slideOutUpAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n\n    to {\n        visibility: hidden;\n        -webkit-transform: translate3d(0, -100%, 0);\n        transform: translate3d(0, -100%, 0);\n    }\n}\n\n@keyframes slideOutUpAD_SESSION_ID {\n    from {\n        -webkit-transform: translate3d(0, 0, 0);\n        transform: translate3d(0, 0, 0);\n    }\n\n    to {\n        visibility: hidden;\n        -webkit-transform: translate3d(0, -100%, 0);\n        transform: translate3d(0, -100%, 0);\n    }\n}\n\n.slideOutUpAD_SESSION_ID {\n    -webkit-animation-name: slideOutUpAD_SESSION_ID;\n    animation-name: slideOutUpAD_SESSION_ID;\n}\n\n.animatedAD_SESSION_ID {\n    -webkit-animation-duration: 1s;\n    animation-duration: 1s;\n    -webkit-animation-fill-mode: both;\n    animation-fill-mode: both;\n}\n\n.animatedAD_SESSION_ID.infinite {\n    -webkit-animation-iteration-count: infinite;\n    animation-iteration-count: infinite;\n}\n\n.animatedAD_SESSION_ID.delay-1s {\n    -webkit-animation-delay: 1s;\n    animation-delay: 1s;\n}\n\n.animatedAD_SESSION_ID.delay-2s {\n    -webkit-animation-delay: 2s;\n    animation-delay: 2s;\n}\n\n.animatedAD_SESSION_ID.delay-3s {\n    -webkit-animation-delay: 3s;\n    animation-delay: 3s;\n}\n\n.animatedAD_SESSION_ID.delay-4s {\n    -webkit-animation-delay: 4s;\n    animation-delay: 4s;\n}\n\n.animatedAD_SESSION_ID.delay-5s {\n    -webkit-animation-delay: 5s;\n    animation-delay: 5s;\n}\n\n.animatedAD_SESSION_ID.fast {\n    -webkit-animation-duration: 800ms;\n    animation-duration: 800ms;\n}\n\n.animatedAD_SESSION_ID.faster {\n    -webkit-animation-duration: 500ms;\n    animation-duration: 500ms;\n}\n\n.animatedAD_SESSION_ID.slow {\n    -webkit-animation-duration: 2s;\n    animation-duration: 2s;\n}\n\n.animatedAD_SESSION_ID.slower {\n    -webkit-animation-duration: 3s;\n    animation-duration: 3s;\n}\n\n@media (print), (prefers-reduced-motion: reduce) {\n    .animatedAD_SESSION_ID {\n        -webkit-animation-duration: 1ms !important;\n        animation-duration: 1ms !important;\n        -webkit-transition-duration: 1ms !important;\n        transition-duration: 1ms !important;\n        -webkit-animation-iteration-count: 1 !important;\n        animation-iteration-count: 1 !important;\n    }\n}\n\n.bounceAD_SESSION_ID {\n    animation-duration: 2s;\n    animation-iteration-count: 2;\n    transform-origin: bottom;\n    animation-name: bounceAD_SESSION_ID;\n    animation-timing-function: ease;\n}\n@keyframes bounceAD_SESSION_ID {\n    0%   { transform: scale(1,1) translateY(0); }\n    10%  { transform: scale(1,1) translateY(0); }\n    30%  { transform: scale(1,1) translateY(-10px); }\n    50%  { transform: scale(1,1) translateY(0); }\n    57%  { transform: scale(1,1) translateY(-7px); }\n    64%  { transform: scale(1,1) translateY(0); }\n    100% { transform: scale(1,1) translateY(0); }\n}\n\n.bounceInfiniteAD_SESSION_ID {\n    animation-duration: 3s;\n    animation-iteration-count: infinite;\n    transform-origin: bottom;\n    animation-name: bounceInfiniteAD_SESSION_ID;\n    animation-timing-function: ease;\n}\n@keyframes bounceInfiniteAD_SESSION_ID {\n    0%   { transform: scale(1,1) translateY(0); }\n    30%  { transform: scale(1,1) translateY(-5px); }\n    50%  { transform: scale(1,1) translateY(0); }\n    57%  { transform: scale(1,1) translateY(-3px); }\n    100% { transform: scale(1,1) translateY(0); }\n}\n'.replace(/AD_SESSION_ID/g,
`${this.initConfig.meta.adSessionId}`))}catch(G){this.logger.error("Can't inject general ad styles")}try{var p=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'served',details:{msSinceStart:p}})}catch(G){}try{a.isError&&this.context.messageBus.event.emit({kind:'tracker',event:'error'});a.delivery.insideAmp&&this.context.messageBus.event.emit({kind:'tracker',event:'amp'});a.delivery.insideSafeFrame&&this.context.messageBus.event.emit({kind:'tracker',event:'safeframe'});
a.delivery.facebookInAppBrowser&&this.context.messageBus.event.emit({kind:'tracker',event:'facebook'});try{'undefined'!==typeof navigator&&'undefined'!==typeof navigator.connection&&'boolean'===typeof navigator.connection.saveData&&navigator.connection.saveData&&this.context.messageBus.event.emit({kind:'tracker',event:'connection-save-data'})}catch(G){}}catch(G){}p=!1;switch(this.adConfig.display.effect){case 'inlineToSticky':this.useMRAIDInlineToStickyConversion='inline-to-sticky';p=!0;break;case 'sticky':this.useMRAIDInlineToStickyConversion=
'sticky';p=!0;break;case 'sitebar':p=!0;break;case 'zoom':case 'zoomToSticky':p=!0}(a.delivery.insideAmp||a.delivery.insideSafeFrame||a.isMRAID&&(Object(x.n)()||p))&&'none'!==this.adConfig.display.effect&&(this.logger.log(`${a.delivery.insideAmp?'AMP':a.delivery.insideSafeFrame?'SafeFrame':'MRAID'} detected - reset display effect from '${this.adConfig.display.effect}' to 'none'`),this.adConfig.display.effect='none',this.context.messageBus.event.emit({kind:'tracker',event:'error-display-effect'}));
(a.delivery.insideAmp||a.delivery.insideSafeFrame)&&'disabled'!==this.adConfig.closeButton.mode&&(this.logger.log(`${a.delivery.insideAmp?'AMP':a.delivery.insideSafeFrame?'SafeFrame':'MRAID'} detected - reset close button option from '${this.adConfig.closeButton.mode}' to 'disabled'`),this.adConfig.closeButton.mode='disabled',this.context.messageBus.event.emit({kind:'tracker',event:'error-close-button'}));this.initConfig.meta.om&&this.adConfig.display.hide&&(this.logger.log('Hide was enabled and open market demand is used - hide is now disabled'),
this.adConfig.display.hide=!1);this.adConfig.display.hide||-1===this.initConfig.product.templateName.toLowerCase().indexOf('3rd party')||-1===this.initConfig.product.templateName.toLowerCase().indexOf('mystery scroller')||(this.logger.log('Hide was disabled and 3rd Party Mystery Scroller is used - hide is now enabled'),this.adConfig.display.hide=!0);this.adConfig.display.hide||-1===this.initConfig.product.templateName.toLowerCase().indexOf('3rd party')||-1===this.initConfig.product.templateName.toLowerCase().indexOf('mystery ad')||
(this.logger.log('Hide was disabled and 3rd Party Mystery Ad is used - hide is now enabled'),this.adConfig.display.hide=!0);this.context.Environment.isPreviewMode&&this.adConfig.display.injectInsideIframe&&('third-party-ad'===this.initConfig.product.key||'takeoverInlineAndHidden'===this.adConfig.display.effect||'takeoverUnderstitialMiniAndHidden'===this.adConfig.display.effect||'universal-ad-format'===this.initConfig.product.key&&(['celtra-banner','celtra-banner-sticky','celtra-interscroller','celtra-interstitial'].includes(this.adConfig.thirdParty.creativeSource.portrait)||
['celtra-banner','celtra-banner-sticky','celtra-interscroller','celtra-interstitial'].includes(this.adConfig.thirdParty.creativeSource.landscape)||['celtra-banner','celtra-banner-sticky','celtra-interscroller','celtra-interstitial'].includes(this.adConfig.thirdParty.creativeSource.sticky)||['celtra-banner','celtra-banner-sticky','celtra-interscroller','celtra-interstitial'].includes(this.adConfig.thirdParty.creativeSource.hidden)))&&(this.logger.log('InjectInsideIframe was enabled and preview mode is enabled - injectInsideIframe is now disabled'),
this.adConfig.display.injectInsideIframe=!1);this.adPainter=new L(this.context,this.rootContainer,this.initConfig,this.adConfig,this.adVisibilityDetails);({productContainer:p}=this.adPainter);this.outerContainerForTracking=p;this.adConfig.display.forceUsingDeliveryContainer&&this.context.Environment.delivery.insideSameOriginFrame&&this.context.Environment.hostElement&&(this.outerContainerForTracking=this.context.Environment.hostElement);this.adAssetList.forEach(a=>{a.init(this,this.context,this.adPainter,
this.initConfig,this.adConfig,this.adAssetList);a.isImage&&(this.isImage=!0)});h='['+('app'===this.initConfig.meta.inventoryType?' APP':'');h+='web'===this.initConfig.meta.inventoryType?' WEB':'';h+='rtb'===this.initConfig.meta.demandType?' RTB':'';h+='io'===this.initConfig.meta.demandType?' IO':'';h+='cpm'===this.initConfig.meta.pricingType.toLowerCase()?' CPM':'';h+='vcpm'===this.initConfig.meta.pricingType.toLowerCase()||'cpv'===this.initConfig.meta.pricingType.toLowerCase()?' vCPM':'';h+='cpcv'===
this.initConfig.meta.pricingType.toLowerCase()?' CPCV':'';this.logger.log(`Welcome to ${this.initConfig.product.title} v${this.initConfig.product.release} ${h+' ]'}`,{InitConfig:JSON.stringify(this.initConfig,null,2),AdConfig:JSON.stringify(this.adConfig,null,2)});this.logger.log('Delivery type',a.delivery);this.logger.log('Viewport dimension',{viewportWidth:a.viewportWidth,viewportHeight:a.viewportHeight,availableWidth:a.availableWidth});this.logger.log(`Use creative dimension: ${a.usedWidth}px x ${a.usedHeight}px (scaled to: ${a.scaledWidth}px x ${a.scaledHeight}px)`);
this.logger.log(`Scroll position at start - top:${a.scrollTop} left:${a.scrollLeft}`);this.assets=new D(this.context);'fullscreenOverlay'===f||this.context.Environment.isSitebar||'zoom'===f||'zoomToSticky'===f?this.createElementsOverlay():this.clickOverlay=new aa(this.context,this.initConfig,this.adConfig,p);this.adNode=a.hostDocument.createDocumentFragment();this.adNodeHidden=a.hostDocument.createDocumentFragment();this.visibilityHandlerList=this.constructVisibilityHandler(this.visibilityHandlerList);
this.adAssetList.forEach(a=>{const {adNode:b,adNodeHidden:c}=a.constructAdNodes(this.adNode,this.adNodeHidden);this.adNode=b;this.adNodeHidden=c;this.visibilityHandlerList=a.constructVisibilityHandler(this.visibilityHandlerList)});if(this.adConfig.tracking.handOver&&!Aa.handOverDetected)this.logger.log('SKIP registering impression, viewability, click and extra tracking URLs because of enabled hand over');else{this.adConfig.tracking.alignImpression&&0>this.bundle.indexOf('video')&&this.initConfig.meta.visx&&
this.initConfig.meta.om&&!['36','39','41'].includes(this.initConfig.meta.dspId)?(this.wasImpressionTrackingAligned=!0,this.logger.log(`SKIP registering impression because of enabled alignImpression for bundle '${this.bundle}' and DSP '${this.initConfig.meta.dspId}'`)):this.trackerImpression.push(Object(w.f)('impression',this.initConfig.tracking.impression));this.initConfig.tracking.extraImpressionUrls&&this.trackerImpression.push(...this.initConfig.tracking.extraImpressionUrls.map(a=>Object(w.f)('impression',
a)));this.trackerImpression.forEach(a=>{this.context.messageBus.tracking.emit({kind:'register',event:'impression',tracker:a})});this.trackerViewability.push(Object(w.f)('viewability',this.initConfig.tracking.viewability));this.trackerViewability.forEach(a=>{this.context.messageBus.tracking.emit({kind:'register',event:'viewability',tracker:a})});this.trackerClick.push(Object(w.f)('click',this.initConfig.tracking.click));this.trackerClick.forEach(a=>{this.context.messageBus.tracking.emit({kind:'register',
event:'click',tracker:a})});try{this.logger.log('Checking for extra tracking URLs to set');var n=this.adConfig.tracking.trackingUrlList;try{if('string'===typeof n&&0<n.length){const a=JSON.parse(decodeURIComponent(n));Object.keys(a).forEach(b=>{'string'===typeof a[b]&&a[b].split('|').forEach(a=>{this.logger.log(`Adding extra tracking URL from STRING: ${b}`,a);a=Object(w.f)(b,a);this.context.messageBus.tracking.emit({kind:'register',event:b,tracker:a})})})}}catch(G){this.logger.error("Can't set extra tracking URLs which are provided as string",
G)}try{'object'===typeof n&&0<n.length&&n.forEach(a=>{const b=a.urls;'object'===typeof b&&0<b.length&&b.forEach(b=>{this.logger.log(`Adding extra tracking URL from array/JSON: ${a.event}`,b);b=Object(w.f)(a.event,b);this.context.messageBus.tracking.emit({kind:'register',event:a.event,tracker:b})})})}catch(G){this.logger.error("Can't set extra tracking URLs which are provided as string",G)}}catch(G){this.logger.error("Can't set extra tracking URLs",G)}}this.initConfig.meta.io&&'creative-video'===this.bundle&&
'disabled'===this.adConfig.externalCreative.mode&&(n=[],'string'===typeof this.initConfig.tracking.context&&0<this.initConfig.tracking.context.length?(this.logger.log('Video IO creative w/o Slot ID: Adding video tracking URLs'),h=`https://t.visx.net/vast_event/${this.initConfig.tracking.context}/`,n.push(Object(w.f)('video-creativeview',`${h}creativeView`)),n.push(Object(w.f)('video-start',`${h}start`)),n.push(Object(w.f)('video-firstquartile',`${h}firstQuartile`)),n.push(Object(w.f)('video-midpoint',
`${h}midpoint`)),n.push(Object(w.f)('video-thirdquartile',`${h}thirdQuartile`)),n.push(Object(w.f)('video-complete',`${h}complete`)),n.push(Object(w.f)('video-mute',`${h}mute`)),n.push(Object(w.f)('video-unmute',`${h}unmute`)),n.push(Object(w.f)('video-resume',`${h}resume`)),n.push(Object(w.f)('video-pause',`${h}pause`)),n.push(Object(w.f)('video-skip',`${h}skip`)),n.push(Object(w.f)('video-error',`https://t.visx.net/vast_error/${this.initConfig.tracking.context}?err_code=[ERRORCODE]`))):this.logger.log("Video IO creative w/o Slot ID: Don't add video tracking URLs because the context isn't available"),
n.forEach(a=>{this.context.messageBus.tracking.emit({kind:'register',event:a.event,tracker:a})}));if('understitialMini'===this.adConfig.display.effect||'understitialMiniToSticky'===this.adConfig.display.effect||'takeoverUnderstitialMiniAndSticky'===this.adConfig.display.effect||'takeoverUnderstitialMiniAndHidden'===this.adConfig.display.effect)n=new g.c('Mini effect tracking (AdCore)',this.context,this.adConfig,p,!1,0,0,'scroll',[],!1,()=>{},()=>{},!1,()=>{},()=>{},(a,b)=>{this.adVisibilityDetails=
a;this.updateStyles({updateAdPosition:!0,reset:!1});this.adPainter.updateAdPosition(this.adVisibilityDetails)}),n.init(),this.visibilityHandlerList.push(n);if('shiftDown'===this.adConfig.display.effect){const a=()=>document.getElementById(`yoc_content_wrapper_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`);n=new g.c('ShiftDown effect tracking (AdCore)',this.context,this.adConfig,p,!1,0,0,'scroll',[],!1,()=>{},()=>{},!1,()=>{const b=a();b&&(b.style.transform='translate3d(0,0,0)')},
()=>{const b=a();b&&(b.style.transform='none')},()=>{});n.init();this.visibilityHandlerList.push(n)}'enabled'===this.adConfig.snapIn.mode&&0<this.adConfig.snapIn.threshold&&(n=new g.c('Snap in tracking (AdCore)',this.context,this.adConfig,this.outerContainerForTracking,!1,0,0,'scroll',[],!1,()=>{},()=>{},!1,()=>{},()=>{},(a,b)=>{this.adVisibilityDetails=a;this.processSnapIn(this.adVisibilityDetails)}),n.init(),this.visibilityHandlerList.push(n));if('yoc-inline-video-ad'===this.initConfig.product.key||
'yoc-understitial-ad'===this.initConfig.product.key||'universal-ad-format'===this.initConfig.product.key&&!this.usedThirdPartyAd||'yoc-banner-classic'===this.initConfig.product.key||'yoc-zoom-ad'===this.initConfig.product.key||['fullscreenOverlay','sitebar'].includes(f)){a.isDemoMode&&(this.demoContainer=a.hostDocument.createElement('div'),this.demoContainer.id=`yoc_demo_container_${this.context.productTitlePostfix}_${this.initConfig.meta.adSessionId}`,this.demoContainer.style.cssText='position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; z-index: 2147483647; background-color: rgba(127, 0, 0, 0.3);',
this.demoContainer.style.backgroundColor='rgba(255, 255, 0, 0.3)',this.outerContainerForTracking.append(this.demoContainer));this.outerContainerForTracking.setAttribute(g.a.AD_SESSION_ID,this.initConfig.meta.adSessionId);this.outerContainerForTracking.setAttribute(g.a.CONTAINER_TYPE,'ad');this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY,g.b.ENABLED);this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY_STATUS,g.b.WAITING);this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY_GOAL,
`viewability ${this.adConfig.tracking.viewabilityPercent}/${this.adConfig.tracking.viewabilityTime/1E3}`);let b=null;b=new g.c('Viewability Tracking (AdCore)',this.context,this.adConfig,this.outerContainerForTracking,!1,this.adConfig.tracking.viewabilityPercent,this.adConfig.tracking.viewabilityTime,this.adConfig.tracking.visibilityHandlerType,this.visibilityHandlerViewabilityGroupList,!0,()=>{try{const c=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'viewability',
details:{msSinceStart:c}});a.isVCPM&&(a.isPortrait?(this.context.trackingMiner.portrait.visibleCreative&&this.context.trackingMiner.portrait.visibleCreative.release(),this.context.trackingMiner.portrait.hiddenCreative&&this.context.trackingMiner.portrait.hiddenCreative.release()):(this.context.trackingMiner.landscape.visibleCreative&&this.context.trackingMiner.landscape.visibleCreative.release(),this.context.trackingMiner.landscape.hiddenCreative&&this.context.trackingMiner.landscape.hiddenCreative.release()));
this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY_STATUS,g.b.FINISHED);this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY_SUCCESS,`viewability ${this.adConfig.tracking.viewabilityPercent}/${this.adConfig.tracking.viewabilityTime/1E3}`);this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY_TIME,`${b.visibilityHandler.viewedTime}`);a.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(0, 255, 0, 0.3)')}catch(W){}try{const {closeButton:{mode:a}}=this.adConfig;
'on-viewability'===a&&(this.logger.log('Viewability Tracking (AdCore) - show close button!'),ua.a.show())}catch(W){this.logger.error('Viewability Tracking (AdCore) - failed to show close button')}},()=>{},!1,()=>{b.visibilityHandler.disabled||(this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY_STATUS,g.b.STARTED),this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY_TIME,`${b.visibilityHandler.viewedTime} +`),a.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor=
'rgba(255, 165, 0, 0.3)'))},()=>{b.visibilityHandler.disabled||(this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY_STATUS,g.b.PAUSED),this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY_TIME,`${b.visibilityHandler.viewedTime}`),a.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(255, 255, 0, 0.3)'))});b.init();this.visibilityHandlerDependsOnImpressionList.push(b);this.adConfig.tracking.viewabilityTrackingOverAll&&this.visibilityHandlerViewabilityGroupList.push(b);
a.isVideo||this.isImage||!this.adConfig.tracking.enableClickTrackingWorkaround?this.isImage&&this.adConfig.tracking.enableClickTrackingWorkaround&&(this.logger.log(`SKIP setup of click tracking on ad container (AdCore) because (isVideo:${a.isVideo?'YES':'NO'} / isImage:${this.isImage?'YES':'NO'})`),this.outerContainerForTracking.setAttribute(g.a.CLICK,g.b.SKIPPED),this.outerContainerForTracking.setAttribute(g.a.CLICK_STATUS,g.b.SKIPPED)):(this.logger.log('Setup click tracking on ad container (AdCore)'),
this.outerContainerForTracking.setAttribute(g.a.CLICK,g.b.ENABLED),this.outerContainerForTracking.setAttribute(g.a.CLICK_STATUS,g.b.WAITING),this.outerContainerForTracking.setAttribute(g.a.CLICK_GOAL,'click'),this.outerContainerForTracking.onclick=b=>{this.wasClicked?(this.logger.log('SKIP repeated CLICK on ad container (AdCore)'),this.outerContainerForTracking.setAttribute(g.a.CLICK_SUCCESS,'click-repeated'),a.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(128, 128, 128, 0.3)'),
this.context.messageBus.event.emit({kind:'tracker',event:'click-repeated',details:{source:'adcore'}})):(this.logger.log('Handle CLICK on ad container (AdCore)'),this.wasClicked=!0,this.outerContainerForTracking.setAttribute(g.a.CLICK_STATUS,g.b.FINISHED),this.outerContainerForTracking.setAttribute(g.a.CLICK_SUCCESS,'click'),a.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(0, 0, 0, 0.3)'),this.context.messageBus.event.emit({kind:'tracker',event:'click',details:{source:'adcore'}}))})}else this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY,
g.b.SKIPPED),this.outerContainerForTracking.setAttribute(g.a.VIEWABILITY_STATUS,g.b.SKIPPED),this.outerContainerForTracking.setAttribute(g.a.CLICK,g.b.SKIPPED),this.outerContainerForTracking.setAttribute(g.a.CLICK_STATUS,g.b.SKIPPED);this.adAssetList.find(a=>a instanceof na.a);!1!==a.isMRAID||'inlineToSticky'!==this.adConfig.display.effect&&'takeoverInlineAndSticky'!==this.adConfig.display.effect&&'understitialMiniToSticky'!==this.adConfig.display.effect&&'takeoverUnderstitialMiniAndSticky'!==this.adConfig.display.effect?
this.useMRAIDInlineToStickyConversion&&a.useMRAIDSticky(this.useMRAIDInlineToStickyConversion):(n=new g.c('InlineToStickyVisibilityHandler',this.context,this.adConfig,p,!1,this.adConfig.display.toStickyThreshold,0,this.adConfig.tracking.visibilityHandlerType,[],!1,()=>{if('takeoverInlineAndSticky'===this.adConfig.display.effect||'takeoverUnderstitialMiniAndSticky'===this.adConfig.display.effect)a.onStickyHide(this.context.Environment.isPortrait?'portrait':'landscape'),this.context.messageBus.clickOverlay.emit({kind:l.i})},
()=>{this.logger.log('InlineToStickyVisibilityHandler - Convert ad from inline to sticky');'takeoverInlineAndSticky'!==this.adConfig.display.effect&&'takeoverUnderstitialMiniAndSticky'!==this.adConfig.display.effect&&(this.logger.log('InlineToStickyVisibilityHandler - hide advertisement message'),this.adPainter.hideAdvertisementMessage());this.applyOnStickyShow();this.adAssetList.forEach(a=>{a.onSticky()});this.updateStyles({updateAdPosition:!0,reset:!1});this.context.messageBus.event.emit({kind:'sticky'});
try{const a=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'inline-to-sticky',details:{msSinceStart:a}});r({kind:'inline-to-sticky-triggered'})}catch(G){}},!1),n.init(),this.visibilityHandlerList.push(n));this.isCeltraCreative()&&(-1!==this.initConfig.product.templateName.toLowerCase().indexOf('mystery scroller')||this.adConfig.mraid.forceReactiveScrolling)&&a.MRAIDIsVisxSDK&&Object(x.e)()&&(Object(x.d)(a),Object(x.c)());'takeoverInlineAndHidden'!==this.adConfig.display.effect&&
'takeoverUnderstitialMiniAndHidden'!==this.adConfig.display.effect||'disabled'===this.adConfig.creative.hidden.mode||(this.takeoverTarget='hidden');'takeoverInlineAndSticky'!==this.adConfig.display.effect&&'takeoverUnderstitialMiniAndSticky'!==this.adConfig.display.effect||'disabled'===this.adConfig.creative.sticky.mode||(this.takeoverTarget='sticky');if(this.takeoverTarget){const {productStickyContainer:a}=this.context;this.takeoverVisibilityHandler=new g.c('TakeoverVisibilityHandler',this.context,
this.adConfig,this.outerContainerForTracking,!1,this.adConfig.display.toStickyThreshold,0,this.adConfig.tracking.visibilityHandlerType,[],!1,()=>{'app'===this.initConfig.meta.inventoryType?(this.logger.log('TakeoverVisibilityHandler - IN-APP - Ad is visible - perform takeover logic'),this.adAssetList.forEach(a=>{a.onTakeoverDisable(this.takeoverTarget)})):'sticky'===this.takeoverTarget&&this.takeoverIsShown&&this.isStickyBrandedTakeover()?(this.logger.log('TakeoverVisibilityHandler - Ad is visible - hide sticky ad'),
this.hideTakeoverContainer(a)):(this.logger.log('TakeoverVisibilityHandler - Ad is visible - perform takeover logic'),this.adAssetList.forEach(a=>{a.onTakeoverDisable(this.takeoverTarget)}))},()=>{this.takeoverIsShown=!0;'app'===this.initConfig.meta.inventoryType?(this.logger.log('TakeoverVisibilityHandler - IN-APP - Ad is not visible (enough) anymore - enable takeover'),this.adAssetList.forEach(a=>{a.onTakeoverEnable(this.takeoverTarget)})):'sticky'===this.takeoverTarget&&this.takeoverIsShown&&this.isStickyBrandedTakeover()?
(this.logger.log('TakeoverVisibilityHandler - Ad is not visible (enough) anymore - show sticky'),this.showTakeoverContainer(a)):(this.logger.log('TakeoverVisibilityHandler - Ad is not visible (enough) anymore - enable takeover'),this.adAssetList.forEach(a=>{a.onTakeoverEnable(this.takeoverTarget)}));try{const a=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'takeover',details:{msSinceStart:a}})}catch(W){}},!1);'celtra-banner'!==this.adConfig.thirdParty.creativeSource.portrait&&
'celtra-banner'!==this.adConfig.thirdParty.creativeSource.landscape&&'celtra-interscroller'!==this.adConfig.thirdParty.creativeSource.portrait&&'celtra-interscroller'!==this.adConfig.thirdParty.creativeSource.landscape?(this.logger.log('TakeoverVisibilityHandler - Will start initializing and adding to visibility handler list - will be enabled later on'),this.takeoverVisibilityHandler.init(),this.visibilityHandlerList.push(this.takeoverVisibilityHandler)):this.logger.log('TakeoverVisibilityHandler - Wait for detecting the inline Celtra Banner/Interscroller to start initializing, enabling and adding to visibility handler list');
this.isStickyBrandedTakeover()&&'sticky'===this.takeoverTarget&&(this.enableStickyViewabilityTracking(a),this.enableClickTracking(a))}if(this.context.Environment.isRefresh){try{this.context.Environment.deliveryContainer&&(this.adConfig.display.forceUsingDeliveryContainer?(this.context.Environment.deliveryContainer.setAttribute(g.a.REFRESH_STATUS,g.b.ENABLED),this.context.Environment.deliveryContainer.style.width=`${this.context.Environment.scaledWidth}px`,this.context.Environment.deliveryContainer.style.height=
`${this.context.Environment.scaledHeight}px`,this.context.Environment.isDemoMode&&(this.context.Environment.deliveryContainer.style.background='repeating-linear-gradient(45deg, white, white 10px, yellow 10px, yellow 20px)')):this.context.Environment.deliveryContainer.parentElement&&(this.context.Environment.deliveryContainer.parentElement.setAttribute(g.a.REFRESH_STATUS,g.b.ENABLED),this.context.Environment.deliveryContainer.parentElement.style.width=`${this.context.Environment.scaledWidth}px`,this.context.Environment.deliveryContainer.parentElement.style.height=
`${this.context.Environment.scaledHeight}px`,this.context.Environment.isDemoMode&&(this.context.Environment.deliveryContainer.parentElement.style.background='repeating-linear-gradient(45deg, white, white 10px, yellow 10px, yellow 20px)')))}catch(W){this.logger.error(W)}const a=()=>{try{this.logger.log('Refresh - perform logic');this.context.messageBus.event.emit({kind:'tracker',event:'refresh-timeout-invoked'});const a=Object(H.a)().wnd;if(a&&a.__YOC&&a.__YOC.refresh&&a.__YOC.refresh[this.initConfig.meta.adUnitProductId]&&
a.__YOC.refresh[this.initConfig.meta.adUnitProductId].active){let b=a.__YOC.refresh[this.initConfig.meta.adUnitProductId].counter;if('sticky'===this.adConfig.display.effect&&0===b)this.context.Environment.isPortrait&&this.adAssetList.forEach(b=>{if('undefined'!==typeof b.creative){let e=void 0;this.context.Environment.isPortrait?({creativeDetails:b}=this.getCreativeOptionDetails(b.creative,'portrait'),e=b.iframe):this.context.Environment.isLandscape?({creativeDetails:b}=this.getCreativeOptionDetails(b.creative,
'landscape'),e=b.iframe):this.logger.error('Unknown device orientation');if(e&&e.contentDocument){var c=e.contentDocument;b=e.contentDocument.body;this.context.messageBus.event.emit({kind:'tracker',event:'refresh-close'});this.logger.log('Refresh - reset delivery container');b.innerHTML='';e.setAttribute(g.a.REFRESH_STATUS,g.b.ENABLED);e.setAttribute('data-refreshed','true');e.setAttribute('data-refresh-counter',a.__YOC.refresh[this.initConfig.meta.adUnitProductId].counter.toString());const d=c.createElement('div');
d.setAttribute('data-visx','');d.setAttribute('data-ad-unit',this.initConfig.meta.adUnitId);d.setAttribute('data-is-mobile',this.context.Environment.isDeviceDesktop?'0':'1');b.append(d);a.__YOC.refresh[this.initConfig.meta.adUnitProductId].deliveryContainer=d;a.__YOC.refresh[this.initConfig.meta.adUnitProductId].counter++;c=c.createElement('script');c.async=!0;c.onload=a=>{this.context.messageBus.event.emit({kind:'tracker',event:'refresh-requested'});e.setAttribute(g.a.REFRESH_STATUS,g.b.FINISHED);
this.context.Environment.isDemoMode&&(e.style.background='repeating-linear-gradient(45deg, white, white 10px, orange 10px, orange 20px)')};c.src='https://s.visx.net/build/5.0.4/tag.js';b.append(c)}}});else if(this.context.Environment.deliveryContainer){this.context.messageBus.event.emit({kind:'tracker',event:'refresh-close'});this.logger.log('Refresh - close ad');this.context.messageBus.event.emit({kind:'close',interactive:!1});this.logger.log('Refresh - reset delivery container');this.context.Environment.deliveryContainer.id=
'';this.context.Environment.deliveryContainer.setAttribute('data-fetched','refresh');a.__YOC.refresh[this.initConfig.meta.adUnitProductId].deliveryContainer=this.context.Environment.deliveryContainer;a.__YOC.refresh[this.initConfig.meta.adUnitProductId].counter++;this.context.Environment.deliveryContainer.setAttribute('data-visx','');this.context.Environment.deliveryContainer.setAttribute('data-ad-unit',this.initConfig.meta.adUnitId);this.context.Environment.deliveryContainer.setAttribute('data-refreshed',
'true');this.context.Environment.deliveryContainer.setAttribute('data-refresh-counter',a.__YOC.refresh[this.initConfig.meta.adUnitProductId].counter.toString());this.logger.log('Refresh - calling VIS.X Tag');const b=this.context.Environment.hostDocument.createElement('script');b.async=!0;b.onload=a=>{this.context.messageBus.event.emit({kind:'tracker',event:'refresh-requested'});this.context.Environment.deliveryContainer&&(this.adConfig.display.forceUsingDeliveryContainer?(this.context.Environment.deliveryContainer.setAttribute(g.a.REFRESH_STATUS,
g.b.FINISHED),this.context.Environment.isDemoMode&&(this.context.Environment.deliveryContainer.style.background='repeating-linear-gradient(45deg, white, white 10px, orange 10px, orange 20px)')):this.context.Environment.deliveryContainer.parentElement&&(this.context.Environment.deliveryContainer.parentElement.setAttribute(g.a.REFRESH_STATUS,g.b.FINISHED),this.context.Environment.isDemoMode&&(this.context.Environment.deliveryContainer.parentElement.style.background='repeating-linear-gradient(45deg, white, white 10px, orange 10px, orange 20px)')))};
b.src='https://s.visx.net/build/5.0.4/tag.js';this.context.Environment.deliveryContainer.after(b);try{document&&document.currentScript&&document.currentScript.parentElement&&document.currentScript.remove()}catch(ta){this.logger.error(`Refresh - error during cleanup: ${ta}`)}}else this.logger.error("Refresh - error: delivery container isn't available"),this.context.messageBus.event.emit({kind:'tracker',event:'refresh-error-container'})}}catch(W){this.logger.error(`Refresh - error: ${W}`),this.context.messageBus.event.emit({kind:'tracker',
event:'refresh-error'})}};n=new g.c('RefreshVisibilityHandler',this.context,this.adConfig,this.outerContainerForTracking,!1,this.adConfig.refresh.threshold,this.adConfig.refresh.delay,this.adConfig.tracking.visibilityHandlerType,[],!1,()=>{this.logger.log('RefreshVisibilityHandler - Ad is visible');this.adConfig.display.forceUsingDeliveryContainer&&this.context.Environment.deliveryContainer?(this.context.Environment.deliveryContainer.setAttribute(g.a.REFRESH_STATUS,g.b.WAITING),this.context.Environment.isDemoMode&&
(this.context.Environment.deliveryContainer.style.background='repeating-linear-gradient(45deg, white, white 10px, lightblue 10px, lightblue 20px)')):this.context.Environment.deliveryContainer&&this.context.Environment.deliveryContainer.parentElement&&(this.context.Environment.deliveryContainer.parentElement.setAttribute(g.a.REFRESH_STATUS,g.b.WAITING),this.context.Environment.isDemoMode&&(this.context.Environment.deliveryContainer.parentElement.style.background='repeating-linear-gradient(45deg, white, white 10px, lightblue 10px, lightblue 20px)'));
this.logger.log('RefreshVisibilityHandler - Add timeout');this.refreshTimeoutId=this.context.Environment.hostWindow.setTimeout(a,this.adConfig.refresh.timeout);this.context.messageBus.event.emit({kind:'tracker',event:'refresh-timeout-set'})},()=>{this.logger.log('RefreshVisibilityHandler - Ad is not visible (enough) anymore');this.adConfig.display.forceUsingDeliveryContainer&&this.context.Environment.deliveryContainer?this.context.Environment.deliveryContainer.setAttribute(g.a.REFRESH_STATUS,g.b.PAUSED):
this.context.Environment.deliveryContainer&&this.context.Environment.deliveryContainer.parentElement&&this.context.Environment.deliveryContainer.parentElement.setAttribute(g.a.REFRESH_STATUS,g.b.PAUSED);this.refreshTimeoutId?(this.logger.log('RefreshVisibilityHandler - Ad is not visible (enough) anymore - remove timeout'),this.context.Environment.hostWindow.clearTimeout(this.refreshTimeoutId),this.refreshTimeoutId=0,this.context.messageBus.event.emit({kind:'tracker',event:'refresh-timeout-cleared'})):
this.logger.log("RefreshVisibilityHandler - Ad is not visible (enough) anymore - timeout doesn't exist")},!1);n.init();this.visibilityHandlerList.push(n)}a.isAutoResize&&(c.add('orientationchange',y(this.onOrientationChange.bind(this),100),0,!0),c.add('resize',y(this.onResize.bind(this),100),0,!0));try{const a=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'init',details:{msSinceStart:a}})}catch(G){}let u=!1;this.adAssetList.forEach(a=>{a.waitForAssetReadyCheck||
(u=!0)});u&&Promise.resolve().then(()=>{this.context.messageBus.event.emit({kind:'assets-ready-check'})});return!0}initZoom(a){if(!this.zoomIsInitialized){0===this.zoomInitStartTimestamp&&(this.zoomInitStartTimestamp=Date.now());var b=a.getBoundingClientRect();if(Date.now()>this.zoomInitStartTimestamp+this.zoomInitTimeout){this.logger.error('initZoom() init timeout');try{var c=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'zoom-init-error',details:{msSinceStart:c}})}catch(F){}}else if(0===
b.width||0===b.height)this.logger.log("initZomm() Can't determine the position of the visibility target - wait and try again"),this.context.Environment.hostWindow.setTimeout(()=>{this.initZoom(a)},100);else{this.zoomIsInitialized=!0;b=this.context.Environment.getVideoDimensions();this.zoomScaleMaximum=this.adConfig.placement.responsive.maximumPermittedWidth||this.adConfig.placement.responsive.maximumPermittedHeight||'scale'===this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.maximumWidth||
'scale'===this.adConfig.display.responsive.mode&&this.adConfig.display.responsive.maximumHeight?this.context.Environment.scaledWidth/(b.mediaWidth*b.adScaleFactor):this.context.Environment.availableWidth/(b.mediaWidth*b.adScaleFactor);this.onResize();this.updateZoom(this.zoomScaleMaximum);b=a.getBoundingClientRect();c=b.top;var e=c<this.context.Environment.viewportHeight?c:this.context.Environment.viewportHeight*this.adConfig.display.animation.start-b.height*this.adConfig.display.animation.creativeHeightStart,
d=b.height*this.adConfig.display.animation.stop-b.height*this.adConfig.display.animation.creativeHeightStop,f=e-d;b=new g.c('zoomVisibilityHandler',this.context,this.adConfig,a,!1,0,0,'scroll',[],!1,()=>{},()=>{},!1,()=>{},()=>{},(a,b)=>{this.zoomIsMovingUp=this.zoomVisibilityDetailsLatest&&this.zoomVisibilityDetailsLatest.top>a.top?!0:!1;this.zoomVisibilityDetailsLatest=a;this.context.Environment.isZoomSticky?this.updateZoom(this.zoomScaleMinimum):this.isVideoComplete?this.resetZoom(!1):a.top<=e&&
a.top>=d?(a=(a.top-d)/f*this.zoomScaleMaximum,a>this.zoomScaleMinimum&&a<this.zoomScaleMaximum?this.updateZoom(a):a<=this.zoomScaleMinimum?this.updateZoom(this.zoomScaleMinimum):a>=this.zoomScaleMaximum&&this.updateZoom(this.zoomScaleMaximum)):a.top<=d?this.updateZoom(this.zoomScaleMinimum):a.top>=e&&this.updateZoom(this.zoomScaleMaximum)});b.init();this.visibilityHandlerList.push(b);b.enable();'zoomToSticky'===this.adConfig.display.effect&&(b=new g.c('zoomToStickyVisibilityHandler',this.context,
this.adConfig,this.context.Environment.adUnitContainer,!1,this.adConfig.display.toStickyThreshold,0,'auto',[],!1,()=>{if(this.isFirstZoom&&!this.isVideoComplete)this.isFirstZoom=!1;else if(!this.isFirstZoom&&this.context.Environment.isZoomSticky){this.context.Environment.onStickyStop();this.updateStyles({updateAdPosition:!0,reset:!1});try{const a=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'sticky-to-zoom',details:{msSinceStart:a}})}catch(F){}this.adPainter.showAdvertisementMessage()}},
()=>{if(!this.isFirstZoom&&!this.context.Environment.isZoomSticky&&('auto'===this.adConfig.display.stickyPosition||'top'===this.adConfig.display.stickyPosition&&this.zoomIsMovingUp||'bottom'===this.adConfig.display.stickyPosition&&!this.zoomIsMovingUp)){this.applyOnStickyShow(this.zoomIsMovingUp);this.updateButtonScale(this.zoomElement,this.zoomScaleMinimum);this.updateStyles({updateAdPosition:!0,reset:!1});this.context.messageBus.event.emit({kind:'sticky'});try{const a=Date.now()-this.initConfig.timestamp;
this.context.messageBus.event.emit({kind:'tracker',event:'zoom-to-sticky',details:{msSinceStart:a}})}catch(F){}this.adPainter.hideAdvertisementMessage()}},!1,()=>{},()=>{},(a,b)=>{}),b.init(),this.visibilityHandlerList.push(b),b.enable())}}}alignZoomContainer(a,b){b=void 0===b?!1:b;if('undefined'!==typeof this.adConfig.display.features&&'undefined'!==typeof this.adConfig.display.features.overlap&&!1===this.adConfig.display.features.overlap){const c=this.zoomElement.getBoundingClientRect().height;
a<=this.zoomScaleMinimum?this.context.Environment.adUnitContainer.style.paddingTop='0px':(a=this.adPainter.rootContainer.getBoundingClientRect().height,this.context.Environment.adUnitContainer.style.paddingTop=`${(c-a)/2}px`);this.context.Environment.adUnitContainer.style.height=`${c}px`;b&&(this.context.Environment.adUnitContainer.style.height='auto')}}updateZoom(a,b,c){c=void 0===c?!1:c;const e=this.zoomScaleLatest>this.zoomScaleMinimum;this.zoomScaleLatest=a;(void 0===b?0:b)&&e&&(this.zoomElement.style.transition=
'ease 0.2s');this.zoomElement.style.transform=`scale(${a})`;this.updateButtonScale(this.zoomElement,a);this.alignZoomContainer(a,c)}resetZoom(a){this.zoomScaleMaximum=this.zoomScaleMinimum;this.updateZoom(this.zoomScaleMinimum,void 0===a?!1:a,!0)}updateButtonScale(a,b){a.firstChild&&Array.from(a.firstChild.childNodes).filter(a=>a.id.startsWith('yoc_button_container')).forEach(a=>{a.style.transform=`scale(${1/b})`})}replaceMacros(a,b){let c=a;c=Object(u.a)(c,this.initConfig);c=this.context.metrics.replaceMacros(c);
if(b){const a=a=>a.replace(/([.?*+^$[\]\\(){}|-])/g,'\\$1');Object.keys(b).forEach(e=>{c=c.replace(new RegExp(a(`[${e.toLowerCase()}]`),'g'),b[e]);c=c.replace(new RegExp(a(`[${e.toUpperCase()}]`),'g'),b[e]);c=c.replace(new RegExp(a(`%%${e.toLowerCase()}%%`),'g'),b[e]);c=c.replace(new RegExp(a(`%%${e.toUpperCase()}%%`),'g'),b[e])})}return c}pingRuntimeStatus(a,b){this.initConfig.tracking.runtimeStatusUrl&&(!1===(void 0===b?!0:b)||this.adConfig.metrics.runtimeTroubleshootingEvents)&&this.context.metrics.loadTrackingImage(this.initConfig.tracking.runtimeStatusUrl.replace('{STATUS_CODE}',
`${a}`))}constructVisibilityHandler(a){const b=new g.c('Shown',this.context,this.adConfig,this.outerContainerForTracking,!1,0,0,this.adConfig.tracking.visibilityHandlerType,[],!0,()=>{this.context.messageBus.event.emit({kind:'shown'})},()=>{});b.init();a.push(b);return a}getCreativeOptionDetails(a,b){let c=this.adConfig.creative.portrait,e=a.portrait,d=this.context.trackingMiner.portrait;'landscape'===b&&(c=this.adConfig.creative.landscape,e=a.landscape,d=this.context.trackingMiner.landscape);'sticky'===
b&&(c=this.adConfig.creative.sticky,e=a.sticky,d=this.context.trackingMiner.sticky);'hidden'===b&&(c=this.adConfig.creative.hidden,e=a.hidden,d=this.context.trackingMiner.hidden);return{configCreative:c,creativeDetails:e,trackingMiner:d}}mergeAdConfig(a,b,c,d,f,g){const e=JSON.parse(JSON.stringify(a));try{const a=this.context.newLogger('mergeAdConfig'),h='creative-video'===this.bundle;Object(N.a)(this.initConfig,a,e,b,h,'ad config specific');Object(N.a)(this.initConfig,a,e,c,h,'ad unit custom options');
Object(N.a)(this.initConfig,a,e,d,h,'deal custom options');Object(N.a)(this.initConfig,a,e,f,h,'IO creative custom options');Object(N.a)(this.initConfig,a,e,g,h,'YOC Ads custom options')}catch(ra){this.logger.error('Error during merging ad configuration',{adConfig:JSON.stringify(a,null,2),adConfigSpecific:b,adUnitOptions:c,dealOptions:d,ioCreativeOptions:f,error:ra.message})}return e}run(){this.execDelayedTemplateLoaderTrackingSignals&&this.execDelayedTemplateLoaderTrackingSignals();this.logger.log('run()');
this.paintAd();this.context.messageBus.event.emit({kind:'impression'});if(!this.context.Environment.isError)if(this.visibilityHandlerList.forEach(a=>{a.enable()}),this.isVPAID)this.context.messageBus.event.onceEvent('vpaid-impression',()=>{this.trackImpression()});else this.trackImpression()}trackImpression(){try{const a=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'impression',details:{msSinceStart:a}});r({kind:'impression'})}catch(e){}this.visibilityHandlerDependsOnImpressionList.forEach(a=>
{a.enable()})}paintAd(){var {height:a}=this.initConfig.placement;const {Environment:b}=this.context;this.logger.log('paintAd()');if(b.isError)this.logger.log('paintAd() - SKIP due to an error');else{this.adPainter.insertAd(a,this.adNode,this.adNodeHidden);this.postProcessAfterInsertAd();if('sticky'===this.adConfig.display.effect){this.logger.log('Display ad sticky');this.adPainter.hideAdvertisementMessage();this.applyOnStickyShow();this.adAssetList.forEach(a=>{a.onSticky()});this.updateStyles({updateAdPosition:!0,
reset:!1});this.context.messageBus.event.emit({kind:'sticky'});try{const a=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'sticky',details:{msSinceStart:a}})}catch(v){}r({kind:'sticky-triggered'})}else this.isVPAID||this.adPainter.showAdvertisementMessage();this.adPainter.updateAdPosition(this.adVisibilityDetails);this.onResize();try{if(this.adConfig.tracking.moat&&['ya-tag','delivery-container','root-container'].includes(this.adConfig.tracking.injectTagMode)&&
!this.wasMoatTagInjected)if(this.context.Environment.yocAdsTag&&'ya-tag'===this.adConfig.tracking.injectTagMode){this.wasMoatTagInjected=!0;const a=Object(sa.a)(this.context,this.logger);this.context.Environment.yocAdsTag.after(a)}else if('delivery-container'===this.adConfig.tracking.injectTagMode){this.wasMoatTagInjected=!0;const a=Object(sa.a)(this.context,this.logger);this.adPainter.rootContainer.after(a)}else if(this.context.Environment.deliveryContainer&&'root-container'===this.adConfig.tracking.injectTagMode){this.wasMoatTagInjected=
!0;const a=Object(sa.a)(this.context,this.logger);this.context.Environment.deliveryContainer.after(a)}else this.logger.warn(`Adding Moat tag FAILED - injectTagMode: '${this.adConfig.tracking.injectTagMode}'`),this.context.messageBus.event.emit({kind:'tracker',event:'moat-error'})}catch(v){this.logger.error(v),this.context.messageBus.event.emit({kind:'tracker',event:'moat-error'})}try{const a=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'ready',details:{msSinceStart:a}})}catch(v){}({display:{autoClose:a=
0}}=this.adConfig);if(0<a)this.onAutoClose(a);if(this.adConfig.takeover.activateImmediately&&this.takeoverTarget){this.logger.log('Takeover - Activate immediately because of custom setting');this.adAssetList.forEach(a=>{a.onTakeoverEnable(this.takeoverTarget)});try{const a=Date.now()-this.initConfig.timestamp;this.context.messageBus.event.emit({kind:'tracker',event:'takeover',details:{msSinceStart:a}})}catch(v){}}this.adConfig.tracking.adDisplay&&'enabled'===this.adConfig.tracking.adDisplay.mode&&
this.trackAdDisplay()}}onLogger(a){var b={error:'font-weight: 600; color: #cc2208',warn:'font-weight: 500; color: #abb014',log:'font-weight: 500; color: #555',debug:'font-weight: 500; color: #888'};const c=[],e=`${decodeURIComponent('%25c')}${a.kind[0].toUpperCase()}${decodeURIComponent('%25c')} `,d={error:'color: white; font-weight: 700; background-color: #f22; border-radius: 2px; padding: 0 4px 0',warn:'color: white; font-weight: 700; background-color: #f2ea5c; border-radius: 2px; padding: 0 4px 0',
log:'color: white; font-weight: 700; background-color: #d0d4e0; border-radius: 2px; padding: 0 4px 0',debug:'color: white; font-weight: 700; background-color: #e8ecf7; border-radius: 2px; padding: 0 4px 0'};if(a.details){const {details:b}=a;let e=0;'string'!==typeof a.details&&Object.keys(a.details).forEach(a=>{'object'===typeof b[a]&&null!==b[a]?Object.keys(b[a]).forEach(d=>{e++;c.push(`${a}.${d}=${b[a][d]}`)}):(e++,c.push(`${a}=${b[a]}`))});0===e&&c.push(a.details)}if(0===c.length)switch(b=[`${e}${decodeURIComponent('%25c')}${a.message}`,
d[a.kind],'',b[a.kind]],a.kind){case 'error':console.error(...b);break;case 'warn':console.warn(...b);break;case 'log':console.log(...b);break;case 'debug':console.debug(...b)}else{console.groupCollapsed(`${e}${decodeURIComponent('%25c')}${a.message}`,d[a.kind],'',b[a.kind]);b=c.join('\n');switch(a.kind){case 'error':console.error(b);break;case 'warn':console.warn(b);break;case 'log':console.log(b);break;case 'debug':console.debug(b)}console.groupEnd()}}onOrientationChange(a){this.updateStyles({updateAdPosition:!0,
reset:!0});this.context.Environment.onOrientationChange(a);this.adAssetList.forEach(b=>{b.onOrientationChange(a)});this.updateStyles({updateAdPosition:!0,reset:!1})}onResize(a){this.updateStyles({updateAdPosition:!0,reset:!0});this.context.Environment.onResize(a);this.adAssetList.forEach(b=>{b.onResize(a)});this.updateStyles({updateAdPosition:!0,reset:!1});const {display:{effect:b}}=this.adConfig;'fullscreenOverlay'===b||this.context.Environment.isSitebar||'zoom'===b?this.context.messageBus.elementsOverlay.emit({kind:l.i}):
this.context.messageBus.clickOverlay.emit({kind:l.i});this.context.messageBus.event.emit({kind:'resize-buttons'})}postProcessAfterInsertAd(){this.adAssetList.forEach(a=>{a.postProcessAfterInsertAd(void 0)})}dispose(){const {Environment:a}=this.context;this.adAssetList.forEach(a=>{a.dispose()});this.context.Environment.isZoom&&this.backfaceCanvas&&this.backfaceCanvas.remove();this.autoCloseTimeoutId&&a.hostWindow.clearTimeout(this.autoCloseTimeoutId);this.handleTakeoverEnableAnimationEndTimeoutId&&
a.hostWindow.clearTimeout(this.handleTakeoverEnableAnimationEndTimeoutId);this.handleTakeoverDisableAnimationEndTimeoutId&&a.hostWindow.clearTimeout(this.handleTakeoverDisableAnimationEndTimeoutId);this.snapInLockTimeoutId&&a.hostWindow.clearTimeout(this.snapInLockTimeoutId);this.refreshTimeoutId&&(this.context.Environment.hostWindow.clearTimeout(this.refreshTimeoutId),this.refreshTimeoutId=0);this.refreshStickyAnimationTimeoutId&&(this.context.Environment.hostWindow.clearTimeout(this.refreshStickyAnimationTimeoutId),
this.refreshStickyAnimationTimeoutId=0);this.elementsOverlay&&this.elementsOverlay.dispose();a.isMRAID&&Object(x.h)()}remove(){try{this.context.Environment.environmentContainer.remove(),this.context.rootContainer.remove(),this.context.Environment.deliveryContainer&&this.context.Environment.deliveryContainer.childNodes.forEach(a=>{a.remove()}),this.context.navigationContainer&&this.context.navigationContainer.remove()}catch(e){this.logger.error(e)}}getCreative(){let a=null;this.adAssetList.forEach(b=>
{b instanceof na.a&&(a=b)});return a}updateStyles(a){var {updateAdPosition:b,reset:c}=void 0===a?{updateAdPosition:!1,reset:!1}:a;this.adAssetList.forEach(a=>{a.updateStyles({updateAdPosition:b,reset:c})});b&&this.adPainter.updateAdPosition(this.adVisibilityDetails);const {Environment:d,overlayContainerBackground:e}=this.context;e&&(e.style.width=`${d.viewportWidth}px`,e.style.height=`${d.viewportHeight}px`);this.adConfig.display.forceUsingDeliveryContainer&&this.context.Environment.delivery.insideSameOriginFrame&&
this.context.Environment.resizeDeliveryContainers(d.scaledWidth,d.scaledHeight)}setupTrackerRedirection(a){if(this.trackerRedirectHasBeenSetUp)this.logger.error('setupTrackerRedirection called second time',{type:a});else{var {isVCPM:b,isPricingTypeUnknown:c}=this.context.Environment;this.trackerRedirectHasBeenSetUp=!0;this.logger.debug('setupTrackerRedirection',{type:a});b&&c&&(this.trackerRedirect.push({event:'impression',trackOn:'viewability'}),this.logger.log('Enabled tracker redirect because vCPM is used"',
{event:'impression',trackOn:'viewability'}));var d=this.adConfig.tracking.countImpressionOn,e=this.adConfig.tracking.countVideoCreativeviewOn;'vpaid'===a&&(d=this.adConfig.tracking.countVPAIDImpressionOn,e=this.adConfig.tracking.countVPAIDVideoCreativeviewOn);b&&!c?this.context.Environment.isVideo?(this.logger.log("Enable impression tracker redirect to 'video-start' because vCPM is used (video)",{event:'impression',trackOn:'video-start'}),this.trackerRedirect.push({event:'impression',trackOn:'video-start'})):
this.logger.log('SKIP impression tracker redirect because vCPM is used (no video)',{event:'impression',trackOn:d}):b||'impression'===d||(this.logger.log(`Enable impression tracker redirect to '${d}' because of ad configuration "tracking.countImpressionOn"`,{event:'impression',trackOn:d}),this.trackerRedirect.push({event:'impression',trackOn:d}));'video-creativeview'!==this.adConfig.tracking.countVideoCreativeviewOn&&(this.trackerRedirect.push({event:'video-creativeview',trackOn:e}),this.logger.log('Enabled tracker redirect because of ad configuration "tracking.countVideoCreativeviewOn"',
{event:'video-creativeview',trackOn:e}))}}createElementsOverlay(){this.elementsOverlay=new da(this.context,this.initConfig,this.adConfig)}onAutoClose(a){const {Environment:b}=this.context;this.autoCloseTimeoutId=b.hostWindow.setTimeout(()=>{this.context.messageBus.event.emit({kind:'auto-close'})},a)}enableStickyViewabilityTracking(a){const {adConfig:{tracking:{viewabilityPercent:b,viewabilityTime:c,visibilityHandlerType:d,viewabilityTrackingOverAll:e}},initConfig:{meta:{adSessionId:f},timestamp:h}}=
this,{Environment:k,trackingMiner:l}=this.context;a.setAttribute(g.a.AD_SESSION_ID,f);a.setAttribute(g.a.CONTAINER_TYPE,'ad');a.setAttribute(g.a.VIEWABILITY,g.b.ENABLED);a.setAttribute(g.a.VIEWABILITY_STATUS,g.b.WAITING);a.setAttribute(g.a.VIEWABILITY_GOAL,`viewability ${b}/${c/1E3}`);let m=null;m=new g.c('Viewability Tracking Separate Sticky (AdCore)',this.context,this.adConfig,a,!1,b,c,d,this.visibilityHandlerViewabilityGroupList,!0,()=>{try{const d=Date.now()-h;this.context.messageBus.event.emit({kind:'tracker',
event:'viewability',details:{msSinceStart:d}});k.isVCPM&&(k.isPortrait?(l.portrait.visibleCreative&&l.portrait.visibleCreative.release(),l.portrait.hiddenCreative&&l.portrait.hiddenCreative.release()):(l.landscape.visibleCreative&&l.landscape.visibleCreative.release(),l.landscape.hiddenCreative&&l.landscape.hiddenCreative.release()));a.setAttribute(g.a.VIEWABILITY_STATUS,g.b.FINISHED);a.setAttribute(g.a.VIEWABILITY_SUCCESS,`viewability ${b}/${c/1E3}`);a.setAttribute(g.a.VIEWABILITY_TIME,`${m.visibilityHandler.viewedTime}`)}catch(G){this.logger.error(G)}},
()=>{},!1,()=>{!m.visibilityHandler.disabled&&this.takeoverIsShown&&(a.setAttribute(g.a.VIEWABILITY_STATUS,g.b.STARTED),a.setAttribute(g.a.VIEWABILITY_TIME,`${m.visibilityHandler.viewedTime} +`),k.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(255, 165, 0, 0.3)'))},()=>{m.visibilityHandler.disabled||(a.setAttribute(g.a.VIEWABILITY_STATUS,g.b.PAUSED),a.setAttribute(g.a.VIEWABILITY_TIME,`${m.visibilityHandler.viewedTime}`),k.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor=
'rgba(255, 255, 0, 0.3)'))});m.init();this.visibilityHandlerDependsOnImpressionList.push(m);e&&this.visibilityHandlerViewabilityGroupList.push(m)}enableClickTracking(a){const {tracking:{enableClickTrackingWorkaround:b}}=this.adConfig,{Environment:c}=this.context;c.isVideo||this.isImage||!b?this.isImage&&this.adConfig.tracking.enableClickTrackingWorkaround&&(this.logger.log(`SKIP setup of click tracking on product Sticky container (AdCore) because (isVideo:${c.isVideo?'YES':'NO'} / isImage:${this.isImage?
'YES':'NO'})`),a.setAttribute(g.a.CLICK,g.b.SKIPPED),a.setAttribute(g.a.CLICK_STATUS,g.b.SKIPPED)):(this.logger.log('Setup click tracking on product container (AdCore)'),a.setAttribute(g.a.CLICK,g.b.ENABLED),a.setAttribute(g.a.CLICK_STATUS,g.b.WAITING),a.setAttribute(g.a.CLICK_GOAL,'click'),a.onclick=b=>{this.wasClicked?(this.logger.log('SKIP repeated CLICK on product container (AdCore)'),a.setAttribute(g.a.CLICK_SUCCESS,'click-repeated'),c.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor=
'rgba(128, 128, 128, 0.3)'),this.context.messageBus.event.emit({kind:'tracker',event:'click-repeated',details:{source:'adcore'}})):(this.logger.log('Handle CLICK on product container (AdCore)'),this.wasClicked=!0,a.setAttribute(g.a.CLICK_STATUS,g.b.FINISHED),a.setAttribute(g.a.CLICK_SUCCESS,'click'),c.isDemoMode&&this.demoContainer&&(this.demoContainer.style.backgroundColor='rgba(0, 0, 0, 0.3)'),this.context.messageBus.event.emit({kind:'tracker',event:'click',details:{source:'adcore'}}))})}showTakeoverContainer(a){const {meta:{adSessionId:b}}=
this.initConfig;this.showTakeover=!0;t.h(a);a.style.display='block';const c=`animated${b}`,d=`slideInUp${b}`;a.classList.add(c,d);let e=!0;const f=()=>{e&&this.showTakeover&&(a.classList.remove(c,d),a.removeEventListener('animationend',f));e=!1};a.addEventListener('animationend',f);this.handleTakeoverEnableAnimationEndTimeoutId=this.context.Environment.hostWindow.setTimeout(f,2E3)}hideTakeoverContainer(a){const {meta:{adSessionId:b}}=this.initConfig;this.showTakeover=!1;let c=!0;const d=`animated${b}`,
e=`slideOutDown${b}`;a.classList.add(d,e);const f=()=>{c&&!this.showTakeover&&(t.f(a),a.style.display='none',a.classList.remove(d,e),a.removeEventListener('animationend',f),c=!1)};a.addEventListener('animationend',f);this.handleTakeoverDisableAnimationEndTimeoutId=this.context.Environment.hostWindow.setTimeout(f,2E3)}isStickyBrandedTakeover(){const {display:{effect:a}}=this.adConfig;return l.o.includes(a)}isCeltraCreative(){let a=this.initConfig.creativeCode;try{a=decodeURIComponent(this.initConfig.creativeCode)}catch(z){}return Object(va.a)(a)}applyOnStickyShow(a){a=
void 0===a?!1:a;if('disabled'!==this.adConfig.creative.sticky.mode)this.context.Environment.onStickyShow('sticky',a);else this.context.Environment.onStickyShow(void 0,a)}adjustButtonSizes(a){}applyDefaultAdConfigYZA(a,b,c){a.display.zIndex===b.display.zIndex&&(a.display.zIndex=1);a.display.stickyPosition===b.display.stickyPosition&&(a.display.stickyPosition='top');a.display.toStickyThreshold===b.display.toStickyThreshold&&(a.display.toStickyThreshold=99);a.display.animation.start===b.display.animation.start&&
a.display.animation.stop===b.display.animation.stop&&a.display.animation.creativeHeightStart===b.display.animation.creativeHeightStart&&a.display.animation.creativeHeightStop===b.display.animation.creativeHeightStop&&(a.display.animation={start:c.isDeviceSmartphone?.8:1,stop:.05,creativeHeightStart:1,creativeHeightStop:0});a.video.reminderBanner.mode===b.video.reminderBanner.mode&&(a.video.reminderBanner.mode='return-to-original-position');'return-to-original-position'!==a.video.reminderBanner.mode&&
'display-paused-frame'!==a.video.reminderBanner.mode||'undefined'!==typeof a.video.reminderBanner.timeOffset||(a.video.reminderBanner.timeOffset=-.1);'static-image'===a.video.muteUnmuteButton.mode&&(a.video.muteUnmuteButton.width=20,a.video.muteUnmuteButton.height=20);a.closeButton.mode='enabled';a.closeButton.image.width=20;a.closeButton.image.height=20;a.closeButton.placement=l.e;'undefined'===typeof a.display.features&&(a.display.features={overlap:!1});'undefined'===typeof a.icon&&(a.icon={scrollDown:{url:'//a.yoc.com/assets/icons/arrows/bright-01.svg',
width:0,height:0}});a.advertisementMessage.contentBelow===b.advertisementMessage.contentBelow&&(a.advertisementMessage.contentBelow='');return a}detectAllowedEffect(a){return this.context.Environment.isDeviceTablet?a.allowOnTablet:this.context.Environment.isDeviceDesktop?a.allowOnDesktop:a.allowOnSmartphone}detectDeviceType(){return this.context.Environment.isDeviceSmartphone?'smartphone':this.context.Environment.isDeviceTablet?'tablet':this.context.Environment.isDeviceDesktop?'desktop':'unknown'}trackAdDisplay(){const {Environment:a}=
this.context,b=a.hostDocument.getElementById(this.containerId),{minimumPermittedWidth:c,minimumPermittedHeight:d}=this.adConfig.tracking.adDisplay;(b.clientWidth<c||b.clientHeight<d)&&this.context.messageBus.event.emit({kind:'tracker',event:'ad-error-size-too-small'});b.clientWidth>a.viewportAvailableWidth&&this.context.messageBus.event.emit({kind:'tracker',event:'ad-error-size-too-big'});let f=!1;(new IntersectionObserver(a=>{f||a.forEach(a=>{a.isIntersecting&&0===a.intersectionRatio&&(this.context.messageBus.event.emit({kind:'tracker',
event:'ad-fatal-display-not-visible'}),f=!0)})},{})).observe(b)}initScrollVideoAd(a){let b=0,c=!0,d,e,f=this.adConfig.video.scrollPlay?this.adConfig.video.scrollPlay.startTime:0,h=this.adConfig.video.scrollPlay?this.adConfig.video.scrollPlay.endTime:0,k=0,l;const m=new g.c('scrollVideoAdVisibilityHandler',this.context,this.adConfig,a,!1,0,0,'scroll',[],!1,()=>{},()=>{},!1,()=>{},()=>{},(g,m)=>{l=this.adConfig.video.scrollPlay?a.duration-f-(a.duration-h):a.duration;this.visibilityDetailsLatest=g;100*
g.visibilityPercentage>this.adConfig.video.autoStartStopOn&&(c&&(b=this.context.Environment.hostWindow.scrollY,c=!1),d=this.context.Environment.hostWindow.scrollY-b,e=l/(window.innerHeight-a.height),k=0>d?a.duration-f+e*d:e*d+f,a.currentTime>h&&(k=h),a.currentTime=k)});m.init();this.visibilityHandlerList.push(m);m.enable()}}},function(m,c,a){},function(m,c){(function(a){a.forEach(function(a){a.hasOwnProperty('append')||Object.defineProperty(a,'append',{configurable:!0,enumerable:!0,writable:!0,value:function(){var a=
Array.prototype.slice.call(arguments),c=document.createDocumentFragment();a.forEach(function(a){c.appendChild(a instanceof Node?a:document.createTextNode(String(a)))});this.appendChild(c)}})})})([Element.prototype,Document.prototype,DocumentFragment.prototype])},function(m,c){(function(a){a.forEach(function(a){a.hasOwnProperty('prepend')||Object.defineProperty(a,'prepend',{configurable:!0,enumerable:!0,writable:!0,value:function(){var a=Array.prototype.slice.call(arguments),c=document.createDocumentFragment();
a.forEach(function(a){c.appendChild(a instanceof Node?a:document.createTextNode(String(a)))});this.insertBefore(c,this.firstChild)}})})})([Element.prototype,Document.prototype,DocumentFragment.prototype])},function(m,c){},function(m,c){},,,,,,function(m,c,a){a.r(c);var h=a(28),k=a(18),r=a(3);c=a(16);m=a(23);a=a(17);c=Object(c.a)().wnd;Object(m.a)(c);c.__YOC.bundle[`${a.a}_${a.b}_${'creative'}`]=(a,c,m,b)=>{Object.keys(a.__YOC.session).forEach(f=>{const n=a.__YOC.session[f],{initConfig:q,adConfigDefault:B,
adConfigSpecific:t,ownWindow:l}=n;n.processed||n.buildTag!==c||n.buildTime!==m||n.bundle!==b||'undefined'!==typeof n.adSessionType&&'unknown'!==n.adSessionType&&'refresh-main'!==n.adSessionType&&'refresh-following'!==n.adSessionType&&'ad'!==n.adSessionType||(n.processed=!0,Object(r.a)(q,B,a=>{const c=[];c.push(new k.a);a=new h.a({bundle:b,initConfig:q,adConfigDefault:B,adConfigSpecific:JSON.stringify(t),adAssetList:c,mraidInfo:a,ownWindow:l,execDelayedTemplateLoaderTrackingSignals:n.execDelayedTemplateLoaderTrackingSignals});
n.adCore=a;a.init()}))})};c.__YOC.bundle[`${a.a}_${a.b}_${'creative'}`](c,a.a,a.b,'creative')}]);}).call(this || window)
